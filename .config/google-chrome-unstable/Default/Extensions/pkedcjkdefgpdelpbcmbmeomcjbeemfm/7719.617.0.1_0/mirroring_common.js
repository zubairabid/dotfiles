'use strict';var fi;var gi=chrome.i18n.getMessage("545449835455981095");w("mr.IssueSeverity",{ov:"fatal",oA:"warning",xx:"notification"});w("mr.IssueAction",{dv:"dismiss",Dw:"learn_more"});
var hi=function(a,c){this.sinkId=this.routeId=null;this.severity=c;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction="dismiss";this.helpPageId=this.secondaryActions=null},ji=function(){var a=new hi(ii,"notification");a.helpPageId=6320939;a.defaultAction="learn_more";a.secondaryActions=["dismiss"];return a},ki=function(a){a.isBlocking=!0;return a},li=function(a,c){a.routeId=c;return a},mi=function(a,c){a.sinkId=c;return a};var ni=function(a,c){var b=this;this.f=void 0===c?null:c;this.b=new Promise(function(d,e){var f=function(g){b.f=null;e(g)};b.g=f;a(function(g){b.f=null;d(g)},f)})};ni.prototype.cancel=function(a){this.g(a);if(this.f){var c=this.f;this.f=null;setTimeout(function(){return c(a)},0)}};var oi=function(a,c,b){b=void 0===b?null:b;return new ni(function(d,e){a.b.then(function(f){if(c)try{d(c(f))}catch(g){e(g)}else d(f)},function(f){if(b)try{d(b(f))}catch(g){e(g)}else e(f)})},function(d){a.cancel(d)})};
ni.prototype.then=function(a,c){return oi(this,a,void 0===c?null:c)};ni.prototype.catch=function(a){return oi(this,null,a)};var pi=function(a){return new ni(function(c){c(a)})},qi=function(a){return new ni(function(c,b){b(a)})},ri=function(a){return new ni(function(c,b){a.then(c,b)})},si=function(a,c){var b=!1,d=null;return new ni(function(e,f){a.then(function(g){b||(d=c(g),d.b.then(e,f))},f)},function(e){d?d.cancel(e):b=!0})};var ti={pu:0,nu:1,ru:2,ou:3,Pt:4,qu:5,Vv:6,Oz:7,Yu:8,qp:9},ui=function(a,c){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=c&&9>=c?c:9};q(ui,Error);var vi=function(){var a=l(navigator.userAgent.match(/Windows NT (\d+.\d+)/)||[]);a.next();a=a.next().value;return 6.2<=parseFloat(a)},wi=function(){var a=navigator.userAgent;return a.includes("CrOS")?"ChromeOS":a.includes("Windows")?"Windows":a.includes("Macintosh")?"Mac":a.includes("Linux")?"Linux":"Other"};var xi=!("undefined"==typeof chrome||!chrome.networkingPrivate||!chrome.networkingPrivate.setWifiTDLSEnabledState||"ChromeOS"!=wi()),yi=["ChromeOS","Windows"].includes(wi());var zi=function(a,c,b,d){this.f=a;this.b=c;this.g=b||null;this.presentationId=d||null},Ci=function(a,c){if("tab"==a.f)a=Ai(a);else if("offscreen_tab"==a.f)c=Ai(a),c.presentationId=a.presentationId,a=c;else{var b={audio:!1,video:!1};a.b.shouldCaptureVideo?(b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c}},Bi(a,b.video.mandatory),yi&&a.b.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"system",chromeMediaSourceId:c}})):a.b.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"system"}});
a=b}return a},Ai=function(a){var c={audio:a.b.shouldCaptureAudio,video:a.b.shouldCaptureVideo};a.b.shouldCaptureVideo&&(c.videoConstraints={mandatory:{enableAutoThrottling:!0}},Bi(a,c.videoConstraints.mandatory));return c},Bi=function(a,c){var b=a.b.minWidth,d=a.b.minHeight;if(a.b.senderSideLetterboxing){b=a.b;if(0==b.minHeight||0==b.maxHeight?0:Math.floor(100*b.minWidth/b.minHeight)==Math.floor(100*b.maxWidth/b.maxHeight))b={width:b.minWidth,height:b.minHeight};else{d=b.maxWidth;for(var e=b.maxHeight;0!=
e;){var f=d%e;d=e;e=f}e=b.maxWidth/d;d=b.maxHeight/d;if(e<b.minWidth||d<b.minHeight)if(f=Math.max(b.minWidth/e,b.minHeight/d),e*=f,d*=f,e>b.maxWidth||d>b.maxHeight)e=b.maxWidth,d=b.maxHeight;e=Math.round(e);d=Math.round(d);b={width:e,height:d}}d=b;b=d.width;d=d.height}Object.assign(c,{minWidth:b,minHeight:d,maxWidth:a.b.maxWidth,maxHeight:a.b.maxHeight,minFrameRate:a.b.minFrameRate,maxFrameRate:a.b.maxFrameRate})};var Di=function(a){this.b=a;this.f=this.Zf=null;this.m=hb("mr.mirror.MirrorMediaStream")};Di.prototype.start=function(){return"tab"==this.b.f?Ei(this):"offscreen_tab"==this.b.f?Fi(this):Hi(this)};var Ei=function(a){var c=Ci(a.b);a.m.info("Starting tab capture with constraints "+JSON.stringify(c));return new Promise(function(b,d){chrome.tabCapture.capture(c,function(e){e?(Ii(a,e),b(a)):d(Ji())});window.setTimeout(function(){d(new ui("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};
Di.prototype.g=function(a){a&&this.m.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
var Ji=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new ui(chrome.runtime.lastError.message,7):new ui("empty_stream",0)},Ki=function(){return new Promise(function(a,c){var b=["screen","audio"];"Linux"==wi()&&b.push("window");var d=window.setTimeout(function(){e&&chrome.desktopCapture.cancelChooseDesktopMedia(e);c(new ui("timeout",1))},6E4);var e=chrome.desktopCapture.chooseDesktopMedia(b,null,function(f){window.clearTimeout(d);f?a(f):c(new ui("User cancelled capture dialog",
3))})})},Li=function(a,c){return new Promise(function(b,d){a.m.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(c)});navigator.mediaDevices.getUserMedia(c).then(function(e){e||d(new ui("empty_stream",8));Ii(a,e);b(e)},function(e){var f=8;"NotAllowedError"==e.name&&(f=3);d(new ui(e.name+" "+e.constraintName+": "+e.message,f))})})},Hi=function(a){return yi&&a.b.b.shouldCaptureAudio&&!a.b.b.shouldCaptureVideo?Li(a,Ci(a.b)).then(function(){return a}):Ki().then(function(c){c=
Ci(a.b,c);return Li(a,c).then(function(){return a})})},Fi=function(a){var c=Ci(a.b);a.m.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(c)});return new Promise(function(b,d){chrome.tabCapture.captureOffscreenTab(a.b.g.toString(),c,function(e){e?(Ii(a,e),b(a)):d(Ji())})})},Ii=function(a,c){a.f=c;c.getAudioTracks().length||c.getVideoTracks();c.getTracks().forEach(function(b){b.onended=a.g.bind(a)})};
Di.prototype.stop=function(){this.f&&(this.f.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.f=null,this.Zf&&this.Zf())};var Mi=function(){},Qi=function(a){var c=Ni.get(a)||null;if(c)return Promise.resolve(c);c=Oi.get(a);c||(c=new Db,Oi.set(a,c),Pi(a,c));return c.b},Pi=function(a,c){var b=Ri.get(a)||null;if(!b)c.reject(Error("No corresponding bundle for "+a));else if(!Si.has(b)){var d=Ti.get(b);d||(Ui.info("Loading bundle "+b+" for module "+a),d=Vi(b),Ti.set(b,d));d.catch(function(e){c.reject(e)})}},Vi=function(a){var c=new Db;c.b.then(function(){Ui.info("Bundle "+a+" loaded")},function(d){Ui.error("Failed to load bundle "+
a);throw d;});var b=document.createElement("script");b.src=chrome.extension.getURL(a);b.setAttribute("type","text/javascript");b.async=!0;b.onload=function(){return c.resolve(void 0)};b.onerror=function(){return c.reject(Error("Failed to load bundle "+a))};document.head.appendChild(b);return c.b},Wi=function(a,c){if(Ni.has(a))throw Error("Duplicate module "+a);Ni.set(a,c);(a=Oi.get(a))&&a.resolve(c)};
Mi.prototype.handleEvent=function(a,c){for(var b=1;b<arguments.length;++b);throw Error("Not implemented");};
var Ri=new Map([["mr.cast.ChannelService","background_script.js"],["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.slarti.SinkDiscoveryService","background_script.js"],["mr.cloud.discovery.WeaveSinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService",
"mirroring_webrtc.js"]]),Si=new Set(["background_script.js"]),Ui=hb("mr.Module"),Ni=new Map,Oi=new Map,Ti=new Map;var Xi,Yi={Mw:0,su:1,tu:2,Zu:3,av:4,Av:5,Xv:6,Kw:7,nx:8,ox:9,wy:10,hz:11,iz:12,yz:13,Nz:14},Zi=function(a){void 0==Xi&&(Cb("MediaRouter.Provider.WakeEvent",a,Yi),Xi=a)};var bj=function(a){return $i(a)||aj(a)},cj=function(a){try{var c=new URL(a);return"http:"!=c.protocol&&"https:"!=c.protocol?!1:-1==c.hash.indexOf("__castAppId__")}catch(b){return!1}},dj=["https://docs.google.com"],$i=function(a){return a.startsWith("urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},aj=function(a){return"urn:x-org.chromium.media:source:desktop"==a},ej=function(a){var c=a.search("urn:x-org.chromium.media:source:tab:");return-1==c?null:parseInt(a.substr(c+36),10)||null};var fj=function(a,c){this.ua=a;this.g=c||null;this.f=this.b=null;this.R=hb("mr.mirror.Service."+a);this.ha=this.pa.bind(this);this.D=!1};q(fj,Mi);h=fj.prototype;h.initialize=function(a,c){this.D||(this.g=a,this.D=!0,this.Cg(c))};h.Cg=function(){};h.getName=function(){return this.ua};
h.Hj=function(a,c,b,d,e){var f=this;this.R.info("Start mirroring on route "+a.id);if(!this.D)return qi(Error("Not initialized"));var g=new Promise(function(k,m){f.l().then(function(){var p=gj(c,b,d);return(new Di(p)).start()}).then(function(p){if(f.f)throw p.stop(),new ui("Cannot start multiple streams");f.f=p;p=f.C.bind(f);f.f.Zf=p;return e?e(a).b:a}).then(function(p){if(f.b)throw new ui("Cannot start multiple sessions");if(!f.f)throw new ui("Media stream ended before session could start.");f.b=
f.xh(b,p);p.pb.vc=f.b.vc;p=f.g.Si.bind(f.g);f.b.H=p;hj(f.b);return f.b.start(f.f.f)}).then(function(){$i(c)&&!chrome.tabs.onUpdated.hasListener(f.ha)&&chrome.tabs.onUpdated.addListener(f.ha);return f.Pc(a,c,b)}).then(function(){k(a)}).catch(function(p){ij(f,p);return f.C().then(function(){m(p)})})});return ri(g)};h.Ij=function(a,c,b,d,e,f){this.R.info("Update mirroring on route "+a.id);return this.D?ri(jj(this,a,c,b,d,f)):qi(Error("Not initialized"))};
var jj=function(a,c,b,d,e,f){if(!a.b)return Promise.reject(new ui("No session to update streams on",7));if(!a.b.Cn())return Promise.reject(new ui("Session does not support updating stream",7));var g=!1;return new Promise(function(k,m){var p=gj(b,d,e);(new Di(p)).start().then(function(v){a.f&&(a.f.Zf=null,a.f.stop(),a.dh());a.f=v;v=a.C.bind(a);a.f.Zf=v;g=!0;return f?f(c).b:c}).then(function(){if(!a.b)throw new ui("Session ended while updating stream");if(!a.f)throw new ui("Media stream ended before session could be updated.");
return a.b.In(a.f.f)}).then(a.Pc.bind(a,c,b,d)).then(function(){return k(c)}).catch(function(v){ij(a,v);if(g)return a.C().then(function(){m(v)});m(v)})})};
fj.prototype.Pc=function(a,c,b){var d=this;return new Promise(function(e,f){if(d.b){$i(c)?(kj(d.b,a.pb.tabId),d.eh()):cj(c)?(kj(d.b,a.pb.tabId),d.Xh()):d.Zg();f=d.f;var g=a.sinkId;b.shouldCaptureAudio&&f.f&&!f.f.getAudioTracks().length&&d.g.cf(mi(new hi(gi,"notification"),g));hj(d.b);e()}else f(new ui("Session gone before executing post-startup steps",7))})};
var ij=function(a,c){c.reason=null!=c.reason?c.reason:9;a.R.error("Failed to start mirroring: "+c.message+(",  reason = "+c.reason+": "+c.stack));a.bh(c.reason)};fj.prototype.l=function(){var a=this;return this.D?this.C().then(function(c){c&&a.ah();return c}):Promise.reject("Not initialized")};
fj.prototype.C=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.ha);var c=this.f;this.f=null;c&&(c.Zf=null);var b=this.b;this.b=null;var d;b?d=this.ui(b).catch(function(e){return a.R.error("Error in before-cleanup steps",e)}).then(function(){return b.stop()}).catch(function(e){return a.R.error("Error stopping session",e)}).then(function(){a.g.Uh(b.f.id)}).catch(function(e){return a.R.error("Error in ended callbacks",e)}).then(function(){return!0}):d=Promise.resolve(!1);c&&(d=d.then(function(e){c.stop();
a.dh();return e}));return d};fj.prototype.ui=function(){return Promise.resolve()};fj.prototype.pa=function(a,c,b){Zi(14);this.b&&lj(this.b,a,c,b)};var gj=function(a,c,b){if($i(a))return new zi("tab",c);if(aj(a))return new zi("desktop",c);if(cj(a)){if(!b)throw new ui("Missing offscreen tab presentation id");return new zi("offscreen_tab",c,a,b)}throw new ui("Source URN does not suggest a known capture type.");};h=fj.prototype;h.xh=function(){};h.eh=function(){};h.Zg=function(){};h.Xh=function(){};
h.ah=function(){};h.bh=function(){};h.dh=function(){};h.Gj=function(){return eb()};h.createMediaRouteController=function(){return eb()};var mj=function(a,c,b){this.f=a;this.h=c;this.b=void 0===b?null:b;this.g=null},nj=function(a){switch(a.f){case "mirror_tab":return a.b?"Casting tab ("+a.b+")":"Casting tab";case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return a.b?"Casting media ("+a.b+")":"Casting media";case "presentation":return"Casting "+(a.b||"site");default:return""}},oj=function(a){if(a.h)return"Casting active";switch(a.f){case "mirror_tab":return"Casting tab";
case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return"Casting media";case "presentation":return"Casting site";default:return""}};var pj=function(a){return(new Promise(function(c){chrome.tabs.get(a,c)})).then(function(c){if(!c)throw Error("No such tab "+a);return c})};var qj=function(a,c){this.f=a;this.H=void 0===c?null:c;c=null;var b=a.mediaSource;if(cj(b)){var d="presentation";c=(new URL(b)).origin}else $i(b)?d="mirror_tab":aj(b)&&(d="mirror_desktop");this.vc=new mj(d,a.offTheRecord,c);this.j=this.tabId=null;this.F=!1},kj=function(a,c){a.tabId!=c?(a.tabId=c,pj(c).then(function(b){a.j=b;hj(a)})):Promise.resolve()},lj=function(a,c,b,d){c==a.tabId&&("complete"==b.status||b.favIconUrl&&"complete"==d.status)&&(a.j=d,hj(a))},hj=function(a){if(a.j){a.vc.g=a.j.title;
a.vc.h=a.j.incognito;var c=new URL(a.j.url);"file:"==c.protocol?(a.vc.f="mirror_file",a.vc.b=null):(a.vc.f=a.F?"media_remoting":"mirror_tab",a.vc.b="https:"==c.protocol?c.origin.substr(8):c.origin)}a.f.description=nj(a.vc);a.H&&a.H(a.f,a.vc);a.ln()};h=qj.prototype;h.start=function(){};h.Cn=function(){return!1};h.In=function(){};h.stop=function(){return Promise.resolve()};h.ln=function(){};var uj=function(){var a=this;this.f=1920;this.b=1080;this.maxWidth=this.f;this.maxHeight=this.b;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.minFrameRate=0;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.animatedLatencyMillis=this.minLatencyMillis=this.maxLatencyMillis=400;this.dscpEnabled=["Mac","Linux","ChromeOS"].includes(wi())||vi();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var c=
window.localStorage?window.localStorage.getItem(rj):null;if(c)try{var b=JSON.parse(String(c));if(b instanceof Object)sj(this,b),hb("mr.mirror.Settings").G(function(){return"Initial mr.mirror.Settings overridden to: "+tj(a)});else throw Error("localStorage["+rj+"] "+("does not parse as an Object: "+c));}catch(d){throw hb("mr.mirror.Settings").error(rj+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',d),Error("Overrides not parseable.  See ERROR log for details.");}};
uj.prototype.clone=function(){var a=new uj;sj(a,this);return a};
var tj=function(a){return JSON.stringify(a,function(c,b){if(0==c.length||!c.endsWith("_"))return b})},sj=function(a,c){for(var b=l(Object.keys(c)),d=b.next();!d.done;d=b.next())d=d.value,d.endsWith("_")||typeof c[d]!==typeof a[d]||(a[d]=c[d])},vj=function(a){var c=Math.round(screen.width*window.devicePixelRatio),b=Math.round(screen.height*window.devicePixelRatio);b>c&&(b=l([b,c]),c=b.next().value,b=b.next().value);a.maxHeight*c<a.maxWidth*b?(c=Math.min(a.maxWidth,c),c-=c%160,b=90*c/160):(b=Math.min(a.maxHeight,
b),b-=b%90,c=160*b/90);if(c<Math.max(160,a.minWidth)||b<Math.max(90,a.minHeight))c=Math.max(160,a.minWidth),b=Math.max(90,a.minHeight);a.maxWidth=c;a.maxHeight=b},rj="mr.mirror.Settings.Overrides";var wj=function(a,c){this.type=a;this.data=c},xj=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new wj(a.type,a.data)},yj=function(a,c,b,d,e){this.description=a;this.settings=c||null;this.mediaConstraints=b||null;this.presentationUrl=d||null;this.presentationId=e||null};var Bj=function(a,c){this.m=hb("cv2.PeerConnection");this.H=zj;this.ja=Aj(this,c);this.h=this.ja.createDataChannel(a,{reliable:!1});this.F=new Db;this.l=!1;this.g=0;this.f=null;this.o=this.j=0;this.b=!1;this.C=function(){};this.w=function(){};this.D=function(){};this.s=function(){}},Cj=function(a,c){a.w=c},Dj=function(a,c){a.D=c},Ej=function(a,c){a.s=c},Fj=function(a,c){a.C=c},Gj=function(a,c){a.h.onmessage=function(b){c(b.data)}},Hj=function(a){var c={};c.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);
return c},Aj=function(a,c){var b=Hj(c);c=new webkitRTCPeerConnection(b);c.onicecandidate=a.J.bind(a);c.onicegatheringstatechange=a.T.bind(a);c.oniceconnectionstatechange=a.O.bind(a);a.m.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(b)});return c};Bj.prototype.start=function(){this.b||(this.b=!0,Ij(this))};Bj.prototype.stop=function(){this.m.info("Stopping peer connection...");this.b&&(this.b=!1,"closed"!=this.ja.signalingState&&this.ja.close());this.ja=null};
var Ij=function(a){a.m.info("Sending offer to peer.");a.j=Date.now();a.ja.createOffer(a.L.bind(a),function(c){a.m.G("Error creating offer.",c)},a.H);a.F.b.then(function(c){a.C(c)})};Bj.prototype.L=function(a){var c=this;this.m.info(function(){return"Setting local description: "+JSON.stringify(a)});this.ja.setLocalDescription(a,function(){c.m.info("Local description set successfully")},function(b){c.m.G("Error setting local description.",b)})};
var Jj=function(a,c){ob(a.m,function(){return"<===: "+JSON.stringify(c)});var b=new RTCSessionDescription(c);a.m.info(function(){return"Setting remote description: "+JSON.stringify(b)});a.ja.setRemoteDescription(b,function(){a.m.info("Remote description set successfully.")},function(d){a.m.G("Error setting remote description.",d)})};
Bj.prototype.J=function(a){var c=this;a.candidate?(this.g++,this.o=Date.now(),1==this.g?this.f=setTimeout(function(){c.m.info("ICE candidate gathering timed out.");c.f=null;Kj(c)},5E3):this.l&&this.m.G("Received ICE candidate after resolving session description.")):(this.m.info("End of ICE candidates."),ub("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.j),Kj(this),0<this.g&&ub("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.o-this.j))};
Bj.prototype.T=function(){"completed"==this.ja.iceGatheringState&&Kj(this)};var Kj=function(a){clearTimeout(a.f);a.f=null;if(!a.l){a.m.info("Resolving sesion description after gathering "+a.g+" ICE candidates.");var c=a.ja.localDescription;a.F.resolve({type:c.type,sdp:c.sdp});a.l=!0}};
Bj.prototype.O=function(a){var c=this;if(this.ja){var b=this.ja.iceConnectionState;this.m.info("New ICE connection state: "+b+".");"connected"==b?this.w("iceconnected"):"completed"==b?this.w("icecompleted"):"failed"==b?(this.m.G(function(){return"Ice connection failed: "+JSON.stringify(a)}),this.D("icefailed")):"closed"==b?this.s("iceclosed"):"disconnected"==b&&(this.m.G("Ice connection state is bad."),this.b&&(this.m.info("Restarting ICE."),this.ja.createOffer(this.L.bind(this),function(d){c.m.G("Error creating new offer.",
d)},Lj)))}};var zj={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Lj={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};var Mj=function(){var a=window.crypto.getRandomValues(new Uint8Array(16));return Nb(a,function(c){c=c.toString(16);return 1<c.length?c:"0"+c}).join("")},Nj=function(a){for(var c=[],b=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?c[b++]=e:(2048>e?c[b++]=e>>6|192:(55296==(e&64512)&&d+1<a.length&&56320==(a.charCodeAt(d+1)&64512)?(e=65536+((e&1023)<<10)+(a.charCodeAt(++d)&1023),c[b++]=e>>18|240,c[b++]=e>>12&63|128):c[b++]=e>>12|224,c[b++]=e>>6&63|128),c[b++]=e&63|128)}return c},Oj=function(a){for(var c=
[],b=0,d=0;b<a.length;){var e=a[b++];if(128>e)c[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[b++];c[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){f=a[b++];var g=a[b++],k=a[b++];e=((e&7)<<18|(f&63)<<12|(g&63)<<6|k&63)-65536;c[d++]=String.fromCharCode(55296+(e>>10));c[d++]=String.fromCharCode(56320+(e&1023))}else f=a[b++],g=a[b++],c[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|g&63)}return c.join("")};var Pj=null,Qj=null,Sj=function(a){Rj();for(var c=Pj,b=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,g=f?a[d+1]:0,k=d+2<a.length,m=k?a[d+2]:0,p=e>>2;e=(e&3)<<4|g>>4;g=(g&15)<<2|m>>6;m&=63;k||(m=64,f||(g=64));b.push(c[p],c[e],c[g],c[m])}return b.join("")},Uj=function(a){var c=a.length,b=3*c/4;b%3?b=Math.floor(b):"="===a[c-1]&&(b="="===a[c-2]?b-2:b-1);var d=new Uint8Array(b),e=0;Tj(a,function(f){d[e++]=f});return d.subarray(0,e)},Tj=function(a,c){function b(m){for(;d<a.length;){var p=a.charAt(d++),
v=Qj[p];if(null!=v)return v;if(!kd(p))throw Error("Unknown base64 encoding at char: "+p);}return m}Rj();for(var d=0;;){var e=b(-1),f=b(0),g=b(64),k=b(64);if(64===k&&-1===e)break;c(e<<2|f>>4);64!=g&&(c(f<<4&240|g>>2),64!=k&&c(g<<6&192|k))}},Rj=function(){if(!Pj){Pj={};Qj={};for(var a=0;65>a;a++)Pj[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),Qj[Pj[a]]=a,62<=a&&(Qj["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}};var Vj=0,Wj=0,Xj=function(a){var c=0>a;a=Math.abs(a);var b=a>>>0;a=Math.floor((a-b)/4294967296);a>>>=0;c&&(a=~a>>>0,b=(~b>>>0)+1,4294967295<b&&(b=0,a++,4294967295<a&&(a=0)));Vj=b;Wj=a},Yj=function(a){var c=0>a?1:0;a=c?-a:a;if(0===a)0<1/a?Vj=Wj=0:(Wj=0,Vj=2147483648);else if(isNaN(a))Wj=0,Vj=2147483647;else if(3.4028234663852886E38<a)Wj=0,Vj=(c<<31|2139095040)>>>0;else if(1.1754943508222875E-38>a)a=Math.round(a/Math.pow(2,-149)),Wj=0,Vj=(c<<31|a)>>>0;else{var b=Math.floor(Math.log(a)/Math.LN2);a*=
Math.pow(2,-b);a=Math.round(8388608*a)&8388607;Wj=0;Vj=(c<<31|b+127<<23|a)>>>0}},Zj="0123456789abcdef".split(""),ak=function(a,c){function b(k){for(var m=1E7,p=0;7>p;p++){m/=10;var v=k/m%10>>>0;if(0!=v||f)f=!0,g+=e[v]}}if(2097151>=c)return""+(4294967296*c+a);var d=(a>>>24|c<<8)>>>0&16777215;c=c>>16&65535;a=(a&16777215)+6777216*d+6710656*c;d+=8147497*c;c*=2;1E7<=a&&(d+=Math.floor(a/1E7),a%=1E7);1E7<=d&&(c+=Math.floor(d/1E7),d%=1E7);var e=Zj,f=!1,g="";(c||f)&&b(c);(d||f)&&b(d);(a||f)&&b(a);return g},
bk=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===Array)return new Uint8Array(a);if(a.constructor===String)return Uj(a);Hb("Type not convertible to Uint8Array.");return new Uint8Array(0)};var dk=function(a,c,b){this.f=null;this.l=this.o=this.b=this.g=this.j=0;this.s=!1;a&&ck(this,a,c,b)},ek=[],fk=function(a,c,b){if(ek.length){var d=ek.pop();a&&ck(d,a,c,b);return d}return new dk(a,c,b)};dk.prototype.clone=function(){return fk(this.f,this.j,this.g-this.j)};dk.prototype.clear=function(){this.f=null;this.b=this.g=this.j=0;this.s=!1};var ck=function(a,c,b,d){a.f=bk(c);a.j=Ia(b)?b:0;a.g=Ia(d)?a.j+d:a.f.length;a.b=a.j};dk.prototype.reset=function(){this.b=this.j};
var gk=function(a){for(var c,b=0,d,e=0;4>e;e++)if(c=a.f[a.b++],b|=(c&127)<<7*e,128>c){a.o=b>>>0;a.l=0;return}c=a.f[a.b++];b|=(c&127)<<28;d=0|(c&127)>>4;if(128>c)a.o=b>>>0,a.l=d>>>0;else{for(e=0;5>e;e++)if(c=a.f[a.b++],d|=(c&127)<<7*e+3,128>c){a.o=b>>>0;a.l=d>>>0;return}Hb("Failed to read varint, encoding is invalid.");a.s=!0}};
dk.prototype.h=function(){var a=this.f;var c=a[this.b+0];var b=c&127;if(128>c)return this.b+=1,b;c=a[this.b+1];b|=(c&127)<<7;if(128>c)return this.b+=2,b;c=a[this.b+2];b|=(c&127)<<14;if(128>c)return this.b+=3,b;c=a[this.b+3];b|=(c&127)<<21;if(128>c)return this.b+=4,b;c=a[this.b+4];b|=(c&15)<<28;if(128>c)return this.b+=5,b>>>0;this.b+=5;128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&this.b++;return b};dk.prototype.w=dk.prototype.h;
var hk=function(a){gk(a);return 4294967296*a.l+a.o},ik=function(a){gk(a);var c=a.o,b=a.l;if(a=b&2147483648)c=~c+1>>>0,b=~b>>>0,0==c&&(b=b+1>>>0);c=4294967296*b+c;return a?-c:c},jk=function(a){var c=a.f[a.b+0];var b=a.f[a.b+1];var d=a.f[a.b+2],e=a.f[a.b+3];a.b+=4;b=(c<<0|b<<8|d<<16|e<<24)>>>0;a=2*(b>>31)+1;c=b>>>23&255;b&=8388607;return 255==c?b?NaN:Infinity*a:0==c?a*Math.pow(2,-149)*b:a*Math.pow(2,c-150)*(b+Math.pow(2,23))};dk.prototype.D=function(){return this.w()};var kk=function(a){this.b=fk(a,void 0,void 0);this.w=this.b.b;this.h=this.f=-1;this.j=!1},lk=function(a){return 4==a.h};kk.prototype.reset=function(){this.b.reset();this.h=this.f=-1};
var mk=function(a){var c=a.b;if(c.b==c.g)return!1;(c=a.j)||(c=a.b,c=c.s||0>c.b||c.b>c.g);if(c)return Hb("Decoder hit an error"),!1;a.w=a.b.b;var b=a.b.h();c=b>>>3;b&=7;if(0!=b&&5!=b&&1!=b&&2!=b&&3!=b&&4!=b)return Hb("Invalid wire type: %s (at position %s)",b,a.w),a.j=!0,!1;a.f=c;a.h=b;return!0},nk=function(a){switch(a.h){case 0:if(0!=a.h)Hb("Invalid wire type for skipVarintField"),nk(a);else{for(a=a.b;a.f[a.b]&128;)a.b++;a.b++}break;case 1:1!=a.h?(Hb("Invalid wire type for skipFixed64Field"),nk(a)):
(a=a.b,a.b+=8);break;case 2:if(2!=a.h)Hb("Invalid wire type for skipDelimitedField"),nk(a);else{var c=a.b.h();a=a.b;a.b+=c}break;case 5:5!=a.h?(Hb("Invalid wire type for skipFixed32Field"),nk(a)):(a=a.b,a.b+=4);break;case 3:c=a.f;do{if(!mk(a)){Hb("Unmatched start-group tag: stream EOF");a.j=!0;break}if(4==a.h){a.f!=c&&(Hb("Unmatched end-group tag"),a.j=!0);break}nk(a)}while(1);break;default:Hb("Invalid wire encoding for field.")}};
kk.prototype.g=function(a,c){var b=this.b.g,d=this.b.h();d=this.b.b+d;this.b.g=d;c(a,this);this.b.b=d;this.b.g=b};
var ok=function(a){return!!a.b.h()},pk=function(a){return ik(a.b)},qk=function(a){var c=a.b.h();a=a.b;var b=a.f,d=a.b,e=d+c,f=[];for(c="";d<e;){var g=b[d++];if(128>g)f.push(g);else if(192>g)continue;else if(224>g){var k=b[d++];f.push((g&31)<<6|k&63)}else if(240>g){k=b[d++];var m=b[d++];f.push((g&15)<<12|(k&63)<<6|m&63)}else if(248>g){k=b[d++];m=b[d++];var p=b[d++];g=(g&7)<<18|(k&63)<<12|(m&63)<<6|p&63;g-=65536;f.push((g>>10&1023)+55296,(g&1023)+56320)}8192<=f.length&&(c+=String.fromCharCode.apply(null,
f),f.length=0)}if(8192>=f.length)f=String.fromCharCode.apply(null,f);else{b="";for(e=0;e<f.length;e+=8192)b+=String.fromCharCode.apply(null,gc(f,e,e+8192));f=b}a.b=d;return c+f},rk=function(a,c){var b=a.b.h();b=a.b.b+b;for(var d=[];a.b.b<b;)d.push(c.call(a.b));return d};var sk=function(a,c){this.b=a;this.f=c},tk=function(a){return new sk((a.b>>>1|(a.f&1)<<31)>>>0,a.f>>>1>>>0)},uk=function(a){return new sk(a.b<<1>>>0,(a.f<<1|a.b>>>31)>>>0)};sk.prototype.add=function(a){return new sk((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};sk.prototype.sub=function(a){return new sk((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};
var vk=function(a){var c=a&65535,b=a>>>16;a=10*c+65536*(0*c&65535)+65536*(10*b&65535);for(c=0*b+(0*c>>>16)+(10*b>>>16);4294967296<=a;)a-=4294967296,c+=1;return new sk(a>>>0,c>>>0)};
sk.prototype.toString=function(){for(var a="",c=this;0!=c.b||0!=c.f;){var b=new sk(0,0);c=new sk(c.b,c.f);for(var d=new sk(10,0),e=new sk(1,0);!(d.f&2147483648);)d=uk(d),e=uk(e);for(;0!=e.b||0!=e.f;)0>=(d.f<c.f||d.f==c.f&&d.b<c.b?-1:d.f==c.f&&d.b==c.b?0:1)&&(b=b.add(e),c=c.sub(d)),d=tk(d),e=tk(e);b=[b,c];c=b[0];a=b[1].b+a}""==a&&(a="0");return a};
var wk=function(a){for(var c=new sk(0,0),b=new sk(0,0),d=0;d<a.length;d++){if("0">a[d]||"9"<a[d])return null;b.b=parseInt(a[d],10);var e=vk(c.b);c=vk(c.f);c.f=c.b;c.b=0;c=e.add(c).add(b)}return c};sk.prototype.clone=function(){return new sk(this.b,this.f)};var xk=function(a,c){this.b=a;this.f=c};xk.prototype.add=function(a){return new xk((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};
xk.prototype.sub=function(a){return new xk((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};xk.prototype.clone=function(){return new xk(this.b,this.f)};xk.prototype.toString=function(){var a=0!=(this.f&2147483648),c=new sk(this.b,this.f);a&&(c=(new sk(0,0)).sub(c));return(a?"-":"")+c.toString()};var yk=function(){this.b=[]};yk.prototype.length=function(){return this.b.length};yk.prototype.end=function(){var a=this.b;this.b=[];return a};
var zk=function(a,c,b){for(;0<b||127<c;)a.b.push(c&127|128),c=(c>>>7|b<<25)>>>0,b>>>=7;a.b.push(c)},Ak=function(a,c){for(;127<c;)a.b.push(c&127|128),c>>>=7;a.b.push(c)},Bk=function(a,c){if(0<=c)Ak(a,c);else{for(var b=0;9>b;b++)a.b.push(c&127|128),c>>=7;a.b.push(1)}},Ck=function(a,c){a.b.push(c>>>0&255);a.b.push(c>>>8&255);a.b.push(c>>>16&255);a.b.push(c>>>24&255)};var D=function(){this.w=[];this.j=0;this.g=new yk;this.l=[]},Ek=function(a,c){Dk(a,c,2);c=a.g.end();a.w.push(c);a.j+=c.length;c.push(a.j);return c},Fk=function(a,c){var b=c.pop();for(b=a.j+a.g.length()-b;127<b;)c.push(b&127|128),b>>>=7,a.j++;c.push(b);a.j++};D.prototype.reset=function(){this.w=[];this.g.end();this.j=0;this.l=[]};
var E=function(a){for(var c=new Uint8Array(a.j+a.g.length()),b=a.w,d=b.length,e=0,f=0;f<d;f++){var g=b[f];c.set(g,e);e+=g.length}b=a.g.end();c.set(b,e);a.w=[c];return c},Dk=function(a,c,b){Ak(a.g,8*c+b)};D.prototype.f=function(a,c){null!=c&&null!=c&&(Dk(this,a,0),Bk(this.g,c))};
var H=function(a,c,b){null!=b&&null!=b&&(Dk(a,c,0),a=a.g,Xj(b),zk(a,Vj,Wj))},Gk=function(a,c,b){if(null!=b){var d=b;(b=0<d.length&&"-"==d[0])&&(d=d.substring(1));d=wk(d);null===d?b=null:(b&&(d=(new sk(0,0)).sub(d)),b=new xk(d.b,d.f));Dk(a,c,0);zk(a.g,b.b,b.f)}};D.prototype.h=function(a,c){null!=c&&null!=c&&(Dk(this,a,0),Ak(this.g,c))};
var Hk=function(a,c,b){null!=b&&null!=b&&(Dk(a,c,0),a=a.g,Xj(b),zk(a,Vj,Wj))},Ik=function(a,c,b){null!=b&&(b=wk(b),Dk(a,c,0),zk(a.g,b.b,b.f))},Jk=function(a,c,b){null!=b&&(Dk(a,c,5),Ck(a.g,b))},Kk=function(a,c,b){null!=b&&(Dk(a,c,5),a=a.g,Yj(b),Ck(a,Vj))},Lk=function(a,c,b){if(null!=b){Dk(a,c,1);a=a.g;var d=b;d=(b=0>d?1:0)?-d:d;0===d?(Wj=0<1/d?0:2147483648,Vj=0):isNaN(d)?(Wj=2147483647,Vj=4294967295):1.7976931348623157E308<d?(Wj=(b<<31|2146435072)>>>0,Vj=0):2.2250738585072014E-308>d?(d/=Math.pow(2,
-1074),Wj=(b<<31|d/4294967296)>>>0,Vj=d>>>0):(c=Math.floor(Math.log(d)/Math.LN2),1024==c&&(c=1023),d*=Math.pow(2,-c),Wj=(b<<31|c+1023<<20|1048576*d&1048575)>>>0,Vj=4503599627370496*d>>>0);Ck(a,Vj);Ck(a,Wj)}},I=function(a,c,b){null!=b&&(Dk(a,c,0),a.g.b.push(b?1:0))},J=function(a,c,b){null!=b&&(Dk(a,c,0),Bk(a.g,b))},K=function(a,c,b){if(null!=b){c=Ek(a,c);for(var d=a.g,e=0;e<b.length;e++){var f=b.charCodeAt(e);if(128>f)d.b.push(f);else if(2048>f)d.b.push(f>>6|192),d.b.push(f&63|128);else if(65536>f)if(55296<=
f&&56319>=f&&e+1<b.length){var g=b.charCodeAt(e+1);56320<=g&&57343>=g&&(f=1024*(f-55296)+g-56320+65536,d.b.push(f>>18|240),d.b.push(f>>12&63|128),d.b.push(f>>6&63|128),d.b.push(f&63|128),e++)}else d.b.push(f>>12|224),d.b.push(f>>6&63|128),d.b.push(f&63|128)}Fk(a,c)}},Mk=function(a,c,b){null!=b&&(b=bk(b),Dk(a,c,2),Ak(a.g,b.length),c=a.g.end(),a.w.push(c),a.w.push(b),a.j+=c.length+b.length)};D.prototype.b=function(a,c,b){null!=c&&(a=Ek(this,a),b(c,this),Fk(this,a))};
var Nk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Dk(e,c,0),Bk(e.g,f))}},Ok=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Dk(e,c,0),e=e.g,Xj(f),zk(e,Vj,Wj))}},Pk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Dk(e,c,0),Ak(e.g,f))}},Qk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)Jk(a,c,b[d])},Rk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)J(a,c,b[d])},Sk=function(a,c,b){if(null!=
b)for(var d=0;d<b.length;d++)K(a,c,b[d])},Tk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)Mk(a,c,b[d])},L=function(a,c,b,d){if(null!=b)for(var e=0;e<b.length;e++){var f=Ek(a,c);d(b[e],a);Fk(a,f)}},Uk=function(a,c,b,d){if(null!=b)for(var e=0;e<b.length;e++)Dk(a,c,3),d(b[e],a),Dk(a,c,4)},Vk=function(a,c,b){if(null!=b&&b.length){c=Ek(a,c);for(var d=0;d<b.length;d++)Bk(a.g,b[d]);Fk(a,c)}},Wk=function(a,c,b){if(null!=b&&b.length){c=Ek(a,c);for(var d=0;d<b.length;d++)Bk(a.g,b[d]);Fk(a,c)}};var Yk=function(a){this.f=a;this.b={};this.g=!0;if(0<this.f.length){for(a=0;a<this.f.length;a++){var c=this.f[a],b=c[0];this.b[b.toString()]=new Xk(b,c[1])}this.g=!0}};Yk.prototype.oc=function(){var a;if(!this.g){this.f.length=0;var c=Zk(this);c.sort();for(var b=0;b<c.length;b++){var d=this.b[c[b]];(a=d.b)&&a.oc();this.f.push([d.key,d.value])}this.g=!0}return this.f};var $k=function(a){this.b=0;this.f=a};
$k.prototype.next=function(){return this.b<this.f.length?{done:!1,value:this.f[this.b++]}:{done:!0,value:void 0}};"undefined"!=typeof Symbol&&($k.prototype[Symbol.iterator]=function(){return this});h=Yk.prototype;h.clear=function(){this.b={};this.g=!1};h.entries=function(){var a=[],c=Zk(this);c.sort();for(var b=0;b<c.length;b++){var d=this.b[c[b]];a.push([d.key,d.value])}return new $k(a)};h.keys=function(){var a=[],c=Zk(this);c.sort();for(var b=0;b<c.length;b++)a.push(this.b[c[b]].key);return new $k(a)};
h.values=function(){var a=[],c=Zk(this);c.sort();for(var b=0;b<c.length;b++)a.push(this.b[c[b]].value);return new $k(a)};h.forEach=function(a,c){var b=Zk(this);b.sort();for(var d=0;d<b.length;d++){var e=this.b[b[d]];a.call(c,e.value,e.key,this)}};h.set=function(a,c){var b=new Xk(a);b.value=c;this.b[a.toString()]=b;this.g=!1;return this};h.get=function(a){if(a=this.b[a.toString()])return a.value};h.has=function(a){return a.toString()in this.b};
h.u=function(a,c,b,d){var e=Zk(this);e.sort();for(var f=0;f<e.length;f++){var g=this.b[e[f]];c.l.push(Ek(c,a));b.call(c,1,g.key);d.call(c,2,g.value);Fk(c,c.l.pop())}};var Zk=function(a){a=a.b;var c=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c},Xk=function(a,c){this.key=a;this.value=c;this.b=void 0};var M=function(){},al="function"==typeof Uint8Array,N=function(a,c,b,d,e,f){a.b=null;c||(c=b?[b]:[]);a.og=b?String(b):void 0;a.j=0===b?-1:0;a.f=c;a:{b=a.f.length;c=-1;if(b&&(c=b-1,b=a.f[c],!(null===b||"object"!=typeof b||Ua(b)||al&&b instanceof Uint8Array))){a.l=c-a.j;a.g=b;break a}-1<d?(a.l=Math.max(d,c+1-a.j),a.g=null):a.l=Number.MAX_VALUE}a.o={};if(e)for(d=0;d<e.length;d++)c=e[d],c<a.l?(c+=a.j,a.f[c]=a.f[c]||bl):(cl(a),a.g[c]=a.g[c]||bl);if(f&&f.length)for(d=0;d<f.length;d++)dl(a,f[d])},bl=Object.freeze?
Object.freeze([]):[],cl=function(a){var c=a.l+a.j;a.f[c]||(a.g=a.f[c]={})},el=function(a,c,b,d){for(var e in b){var f=b[e],g=f.qq;if(!f.wi)throw Error("Message extension present that was generated without binary serialization support");var k=d.call(a,g);if(null!=k)if(g.Xd)if(f.sl)f.wi.call(c,g.Cl,k,f.sl);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else f.wi.call(c,g.Cl,k)}},O=function(a,c){if(c<a.l){c+=
a.j;var b=a.f[c];return b===bl?a.f[c]=[]:b}if(a.g)return b=a.g[c],b===bl?a.g[c]=[]:b},fl=function(a,c){a=O(a,c);return null==a?a:+a},gl=function(a,c){a=O(a,c);return null==a?a:!!a},hl=function(a,c){var b=O(a,c);a.o||(a.o={});if(!a.o[c]){for(var d=0;d<b.length;d++)b[d]=+b[d];a.o[c]=!0}return b},il=function(a){if(null==a||a instanceof Uint8Array)return a;if(Ja(a))return Uj(a);Hb("Cannot coerce to Uint8Array: "+Sa(a));return null},kl=function(a){jl(a);return!a.length||a[0]instanceof Uint8Array?a:Nb(a,
il)},jl=function(a){if(a&&1<a.length){var c=Sa(a[0]);y(a,function(b){Sa(b)!=c&&Hb("Inconsistent type in JSPB repeated field array. Got "+Sa(b)+" expected "+c)})}},R=function(a,c,b){a=O(a,c);return null==a?b:a},ll=function(a,c,b){a=gl(a,c);return null==a?b:a},ml=function(a,c){a=fl(a,c);return null==a?0:a},S=function(a,c,b){c<a.l?a.f[c+a.j]=b:(cl(a),a.g[c]=b)},ol=function(a,c,b){nl(a,c,b,"")},pl=function(a,c,b){nl(a,c,b,0)},nl=function(a,c,b,d){b!==d?S(a,c,b):a.f[c+a.j]=null},ql=function(a,c,b,d){(b=
dl(a,b))&&b!==c&&void 0!==d&&(a.b&&b in a.b&&(a.b[b]=void 0),S(a,b,void 0));S(a,c,d)},dl=function(a,c){for(var b,d,e=0;e<c.length;e++){var f=c[e],g=O(a,f);null!=g&&(b=f,d=g,S(a,f,void 0))}return b?(S(a,b,d),b):0},T=function(a,c,b,d){a.b||(a.b={});if(!a.b[b]){var e=O(a,b);if(d||e)a.b[b]=new c(e)}return a.b[b]},U=function(a,c,b){rl(a,c,b);c=a.b[b];c==bl&&(c=a.b[b]=[]);return c},rl=function(a,c,b){a.b||(a.b={});if(!a.b[b]){for(var d=O(a,b),e=[],f=0;f<d.length;f++)e[f]=new c(d[f]);a.b[b]=e}},V=function(a,
c,b){a.b||(a.b={});var d=b?b.oc():b;a.b[c]=b;S(a,c,d)},tl=function(a,c,b){var d=sl[0];a.b||(a.b={});var e=b?b.oc():b;a.b[c]=b;ql(a,c,d,e)},ul=function(a,c,b){a.b||(a.b={});b=b||[];for(var d=[],e=0;e<b.length;e++)d[e]=b[e].oc();a.b[c]=b;S(a,c,d)},vl=function(a,c,b,d,e){rl(a,d,c);var f=a.b[c];f||(f=a.b[c]=[]);b=b?b:new d;a=O(a,c);void 0!=e?(f.splice(e,0,b),a.splice(e,0,b.oc())):(f.push(b),a.push(b.oc()));return b},wl=function(a){if(a.b)for(var c in a.b){var b=a.b[c];if(Ua(b))for(var d=0;d<b.length;d++)b[d]&&
b[d].oc();else b&&b.oc()}};M.prototype.oc=function(){wl(this);return this.f};M.prototype.Ba=al?function(){var a=Uint8Array.prototype.toJSON;Uint8Array.prototype.toJSON=function(){return Sj(this)};try{return JSON.stringify(this.f&&this.oc(),xl)}finally{Uint8Array.prototype.toJSON=a}}:function(){return JSON.stringify(this.f&&this.oc(),xl)};var xl=function(a,c){return r(c)&&(isNaN(c)||Infinity===c||-Infinity===c)?String(c):c};M.prototype.toString=function(){wl(this);return this.f.toString()};
M.prototype.w=function(a){if(this.g)return this.b||(this.b={}),a.Xd?(!this.b[175237375]&&this.g[175237375]&&(this.b[175237375]=new a.Xd(this.g[175237375])),this.b[175237375]):this.g[175237375]};
var zl=function(a,c){a=a||{};c=c||{};var b={},d;for(d in a)b[d]=0;for(d in c)b[d]=0;for(d in b)if(!yl(a[d],c[d]))return!1;return!0},yl=function(a,c){if(a==c)return!0;if(!Ya(a)||!Ya(c))return r(a)&&isNaN(a)||r(c)&&isNaN(c)?String(a)==String(c):!1;if(a.constructor!=c.constructor)return!1;if(al&&a.constructor===Uint8Array){if(a.length!=c.length)return!1;for(var b=0;b<a.length;b++)if(a[b]!=c[b])return!1;return!0}if(a.constructor===Array){var d=void 0,e=void 0,f=Math.max(a.length,c.length);for(b=0;b<f;b++){var g=
a[b],k=c[b];g&&g.constructor==Object&&(d=g,g=void 0);k&&k.constructor==Object&&(e=k,k=void 0);if(!yl(g,k))return!1}return d||e?(d=d||{},e=e||{},zl(d,e)):!0}if(a.constructor===Object)return zl(a,c);throw Error("Invalid type in JSPB array");};M.prototype.clone=function(){return Al(this)};
var Al=function(a){return new a.constructor(Bl(a.oc()))},Bl=function(a){if(Ua(a)){for(var c=Array(a.length),b=0;b<a.length;b++){var d=a[b];null!=d&&(c[b]="object"==typeof d?Bl(d):d)}return c}if(al&&a instanceof Uint8Array)return new Uint8Array(a);c={};for(b in a)d=a[b],null!=d&&(c[b]="object"==typeof d?Bl(d):d);return c},Dl=function(a,c){Cl[a]=c;c.messageId=a},Cl={};var El=function(a){N(this,a,0,-1,null,null)};x(El,M);var Fl=function(a){N(this,a,0,-1,null,null)};x(Fl,M);var Hl=function(a,c){for(;mk(c)&&!lk(c);)switch(c.f){case 1:var b=ik(c.b);S(a,1,b);break;case 2:b=qk(c);S(a,2,b);break;case 3:b=new Fl;c.g(b,Gl);V(a,3,b);break;default:nk(c)}return a};El.prototype.u=function(){var a=new D;Il(this,a);return E(a)};
var Il=function(a,c){var b=O(a,1);null!=b&&H(c,1,b);b=O(a,2);null!=b&&K(c,2,b);b=T(a,Fl,3);null!=b&&c.b(3,b,Jl)},Gl=function(a,c){for(;mk(c)&&!lk(c);)switch(c.f){case 1:var b=qk(c);S(a,1,b);break;case 2:b=ik(c.b);S(a,2,b);break;default:nk(c)}return a};Fl.prototype.u=function(){var a=new D;Jl(this,a);return E(a)};var Jl=function(a,c){var b=O(a,1);null!=b&&K(c,1,b);b=O(a,2);null!=b&&H(c,2,b)};El.prototype.Ob=function(){return O(this,1)};var Kl=function(a,c){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=c;this.logRecord=this.deviceJustSetUp=void 0};w("castApp.eventPage.Message",Kl);var Ll=function(a,c,b){this.ipAddress=a;this.appId=c;this.sessionId=b};Kl.DeviceData=Ll;Kl.DeviceJustSetUp=function(a,c,b,d){this.ipAddress=a;this.name=c;this.udn=b;this.modelName=d};Kl.DeviceCapabilities=function(){};
Kl.LogRecord=function(a,c,b,d){this.levelValue=a;this.msg=c;this.loggerName=b;this.time=d};var Ml=function(a,c){this.type=a;this.entryPoint=c};w("castApp.frontEnd.ExtensionMessage",Ml);var Nl=function(a){return"urn:x-cast:com.google.cast."+a},Ol=Nl("tp.connection"),Pl=Nl("receiver"),Ql=Nl("remoting"),Rl=Nl("media"),Sl=Nl("webrtc"),Tl=Nl("broadcast"),Ul=Nc({Tz:Ol,Uz:Nl("tp.heartbeat"),Dy:Pl,Iy:Ql,Lw:Rl,Ow:Nl("media.universalRemote.optIn"),qA:Sl,bu:Tl});var Vl=function(a){return"available"==a||"available_rescan"==a};var Wl=function(a,c,b,d,e){this.id=a;this.friendlyName=c;this.iconType=b||"generic";this.description=void 0===d?null:d;this.domain=void 0===e?null:e};var Xl=window.localStorage,Yl=0,$l=function(a){return(a=window.localStorage.getItem(Zl(a,!1)))?JSON.parse(a):null},am=function(a){return(a=window.localStorage.getItem(Zl(a,!0)))?JSON.parse(a):null},cm=function(a){if(bm.has(a.Ea()))throw Error("Duplicate instance name "+a.Ea());bm.set(a.Ea(),a);a.jb()},im=function(a){for(var c=0,b=l(Object.keys(Xl)),d=b.next();!d.done;d=b.next()){d=d.value;var e=d.length+window.localStorage.getItem(d).length;d.startsWith("mr.")?Yl+=e:c+=e}dm=a;(window.localStorage.getItem("version")&&
window.localStorage.getItem("version")!==chrome.runtime.getManifest().version||em(a))&&fm();gm.info("initialize: "+Yl+" chars used, "+c+" other chars");chrome.runtime.onSuspend.addListener(hm)},dm=null,gm=hb("mr.PersistentDataManager"),bm=new Map,Zl=function(a,c){return"mr."+(c?"persistent.":"temp.")+a.Ea()},em=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},hm=function(){gm.info("onSuspend");jm("version",chrome.runtime.getManifest().version);
dm&&jm("mrInstanceId",dm);for(var a=bm.get("LogManager"),c=l(bm),b=c.next();!b.done;b=c.next())b=l(b.value),b.next(),b=b.next().value,b!=a&&km(b);a&&km(a)},km=function(a){try{var c=a.kb();c&&void 0!=c[0]&&jm(Zl(a,!1),JSON.stringify(c[0]));c&&void 0!=c[1]&&jm(Zl(a,!0),JSON.stringify(c[1]))}catch(b){gm.error("Error while saving data for "+a.Ea()+": "+b.message)}},jm=function(a,c){var b=window.localStorage.getItem(a);b=null!=b?c.length-b.length:a.length+c.length;52E5<Yl+b&&(gm.G("Unable to write "+b+
" chars"),fm());if(52E5<Yl+b)throw gm.error("Unable to write "+b+" chars after clearing temporary"),Error("Setting the value of '"+a+"' would exceed the quota, according to accounting.");try{window.localStorage.setItem(a,c)}catch(d){throw Error("Setting the value of '"+a+"' would exceed the quota, according to the browser.");}Yl+=b},lm=function(a){a=0==a.size%2?new Blob([a,new Uint8Array([0,0])]):new Blob([a,new Uint8Array([1])]);return new Promise(function(c,b){var d=new FileReader;d.onloadend=function(){if(d.error)b(d.error);
else try{for(var e=d.result,f=[],g=0,k=e.byteLength;g<k;g+=8192)f.push(String.fromCharCode.apply(null,new Uint16Array(e,g,Math.min(k-g,8192)/2)));jm("mr.temp.mirror.cast.Service.eventsBlob",f.join(""));c()}catch(m){b(m)}};d.readAsArrayBuffer(a)})},fm=function(){for(var a=l(Object.keys(Xl)),c=a.next();!c.done;c=a.next())c=c.value,c.startsWith("mr.temp.")&&(Yl-=c.length+window.localStorage.getItem(c).length,delete window.localStorage[c]);gm.info("removeTemporary_: "+Yl+" chars used")};var mm=(new Map).set("+","-").set("/","_").set("=","."),nm=(new Map).set("-","+").set("_","/").set(".","="),om=function(a){return atob(a.replace(/[-_.]/g,function(c){return nm.get(c)}))},pm=function(a){return btoa(String.fromCharCode.apply(String,n(a))).replace(/[+/=]/g,function(c){return mm.get(c)})};var qm=function(){this.b=[];this.j=[];this.w=[];this.g=[];this.g[0]=128;for(var a=1;64>a;++a)this.g[a]=0;this.h=this.f=0;this.reset()};qm.prototype.reset=function(){this.b[0]=1732584193;this.b[1]=4023233417;this.b[2]=2562383102;this.b[3]=271733878;this.b[4]=3285377520;this.h=this.f=0};
var rm=function(a,c,b){b=void 0===b?0:b;var d=a.w;if("string"===typeof c)for(var e=0;16>e;e++)d[e]=c.charCodeAt(b)<<24|c.charCodeAt(b+1)<<16|c.charCodeAt(b+2)<<8|c.charCodeAt(b+3),b+=4;else for(e=0;16>e;e++)d[e]=c[b]<<24|c[b+1]<<16|c[b+2]<<8|c[b+3],b+=4;for(c=16;80>c;c++)b=d[c-3]^d[c-8]^d[c-14]^d[c-16],d[c]=(b<<1|b>>>31)&4294967295;c=a.b[0];b=a.b[1];e=a.b[2];for(var f=a.b[3],g=a.b[4],k,m,p=0;80>p;p++)40>p?20>p?(k=f^b&(e^f),m=1518500249):(k=b^e^f,m=1859775393):60>p?(k=b&e|f&(b|e),m=2400959708):(k=
b^e^f,m=3395469782),k=(c<<5|c>>>27)+k+g+m+d[p]&4294967295,g=f,f=e,e=(b<<30|b>>>2)&4294967295,b=c,c=k;a.b[0]=a.b[0]+c&4294967295;a.b[1]=a.b[1]+b&4294967295;a.b[2]=a.b[2]+e&4294967295;a.b[3]=a.b[3]+f&4294967295;a.b[4]=a.b[4]+g&4294967295};
qm.prototype.update=function(a,c){c=void 0===c?a.length:c;for(var b=c-64,d=0,e=this.j,f=this.f;d<c;){if(0==f)for(;d<=b;)rm(this,a,d),d+=64;if("string"===typeof a)for(;d<c;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){rm(this,e);f=0;break}}else for(;d<c;)if(e[f]=a[d],++f,++d,64==f){rm(this,e);f=0;break}}this.f=f;this.h+=c};
qm.prototype.digest=function(){var a=[],c=8*this.h;56>this.f?this.update(this.g,56-this.f):this.update(this.g,64-(this.f-56));for(var b=63;56<=b;b--)this.j[b]=c&255,c/=256;rm(this,this.j);for(b=c=0;5>b;b++)for(var d=24;0<=d;d-=8)a[c]=this.b[b]>>d&255,++c;return a};var sm=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var um=function(){this.j=sm();this.f=new tm(null,null);this.b=new tm(null,null);this.w=[];this.g=this.h=0;cm(this)},wm=function(){vm||(vm=new um);return vm},xm=function(a,c){c=c.toLowerCase();var b=new qm;b.update(c);b.update(a.j);return"r"+pm(b.digest())},ym=function(){var a=wm();return a.f.model?a.f:a.b.model?a.b:new tm(null,null)};um.prototype.Ea=function(){return"SinkUtils"};
um.prototype.kb=function(){return[{recentLaunchedDevice:this.f,recentDiscoveredDevice:this.b},{receiverIdToken:this.j,fixedIpList:this.w.join(","),castControlPort:this.h,lastCloudSinkCheckTimeMillis:this.g}]};
um.prototype.jb=function(){var a=$l(this);a&&(this.f=a.recentLaunchedDevice||new tm(null,null),this.b=a.recentDiscoveredDevice||new tm(null,null));if(a=am(this))this.j=a.receiverIdToken||sm(),this.w=a.fixedIpList&&a.fixedIpList.split(",")||[],this.h=a.castControlPort||0,this.g=a.lastCloudSinkCheckTimeMillis||0};var vm=null,tm=function(a,c){this.model=a;this.ip=c};var zm=function(a,c){this.Cc=this.Bf=this.Vd=this.Ka=this.pc=null;this.Dc=new Wl(c,a);this.kc={};this.Kh={};this.He=!1};zm.prototype.getId=function(){return this.Dc.id};zm.prototype.update=function(a){if(this.getId()!=a.getId())return!1;var c=!1;this.Dc.friendlyName!=a.Dc.friendlyName&&(this.Dc.friendlyName=a.Dc.friendlyName,c=!0);this.Vd!=a.Vd&&(this.Vd=a.Vd,c=!0);this.Bf!=a.Bf&&(this.Bf=a.Bf,c=!0);this.pc!=a.pc&&(this.pc=a.pc,c=!0);this.Ka!=a.Ka&&(this.Ka=a.Ka,c=!0);return c};zm.prototype.Zb=function(){return this.pc};
zm.prototype.Bb=function(){return this.Ka};var Am=function(a,c){return a.kc[c]||"unknown"},Bm=function(a){var c=new zm(a.Dc.friendlyName,"");c.Dc.id=a.Dc.id;c.pc=a.pc;c.Ka=a.Ka;c.Vd=a.Vd;c.Bf=a.Bf;c.Cc=a.Cc;c.kc=a.kc;c.Kh=a.Kh;c.He=a.He;return c};var Cm=function(a,c,b,d,e,f){this.f=new Wl(a,c,d&1?"cast":d&32?"cast_audio_group":"cast_audio");this.Cc=b||null;this.b=d||null;this.pc=e||null;this.Ka=f||null;this.kc={};this.Ci=!1};Cm.prototype.update=function(a,c,b,d){var e=!1;this.f.friendlyName!=a&&(this.f.friendlyName=a,e=!0);null!=c&&this.pc!=c&&(this.pc=c,e=!0);null!=b&&this.Ka!=b&&(this.Ka=b,e=!0);null!=d&&this.b!=d&&(this.b=d,e=!0);return e};Cm.prototype.getId=function(){return this.f.id};Cm.prototype.Zb=function(){return this.pc};
Cm.prototype.Bb=function(){return this.Ka};var Dm=function(a,c){return a.kc[c]||"unknown"};var Em="StopIteration"in Ha?Ha.StopIteration:{message:"StopIteration",stack:""},Fm=function(){};Fm.prototype.next=function(){throw Em;};Fm.prototype.Sb=function(){return this};
var Gm=function(a){if(a instanceof Fm)return a;if("function"==typeof a.Sb)return a.Sb(!1);if(Va(a)){var c=0,b=new Fm;b.next=function(){for(;;){if(c>=a.length)throw Em;if(c in a)return a[c++];c++}};return b}throw Error("Not implemented");},Hm=function(a,c,b){if(Va(a))try{y(a,c,b)}catch(d){if(d!==Em)throw d;}else{a=Gm(a);try{for(;;)c.call(b,a.next(),void 0,a)}catch(d){if(d!==Em)throw d;}}},Im=function(a,c){a=Gm(a);try{for(;!c.call(void 0,a.next(),void 0,a););}catch(b){if(b!==Em)throw b;}},Jm=function(a){if(Va(a))return z(a);
a=Gm(a);var c=[];Hm(a,function(b){c.push(b)});return c};var Lm=function(a,c){this.f={};this.b=[];this.h=this.g=0;var b=arguments.length;if(1<b){if(b%2)throw Error("Uneven number of arguments");for(var d=0;d<b;d+=2)this.set(arguments[d],arguments[d+1])}else a&&Km(this,a)};Lm.prototype.sa=function(){return this.g};Lm.prototype.oa=function(){Mm(this);for(var a=[],c=0;c<this.b.length;c++)a.push(this.f[this.b[c]]);return a};Lm.prototype.Ab=function(){Mm(this);return this.b.concat()};var Om=function(a,c){return Nm(a.f,c)};
Lm.prototype.Ff=function(a){for(var c=0;c<this.b.length;c++){var b=this.b[c];if(Nm(this.f,b)&&this.f[b]==a)return!0}return!1};Lm.prototype.equals=function(a,c){if(this===a)return!0;if(this.g!=a.sa())return!1;c=c||Pm;Mm(this);for(var b,d=0;b=this.b[d];d++)if(!c(this.get(b),a.get(b)))return!1;return!0};var Pm=function(a,c){return a===c};Lm.prototype.Wb=function(){return 0==this.g};Lm.prototype.clear=function(){this.f={};this.h=this.g=this.b.length=0};
Lm.prototype.remove=function(a){return Nm(this.f,a)?(delete this.f[a],this.g--,this.h++,this.b.length>2*this.g&&Mm(this),!0):!1};var Mm=function(a){if(a.g!=a.b.length){for(var c=0,b=0;c<a.b.length;){var d=a.b[c];Nm(a.f,d)&&(a.b[b++]=d);c++}a.b.length=b}if(a.g!=a.b.length){var e={};for(b=c=0;c<a.b.length;)d=a.b[c],Nm(e,d)||(a.b[b++]=d,e[d]=1),c++;a.b.length=b}};Lm.prototype.get=function(a,c){return Nm(this.f,a)?this.f[a]:c};
Lm.prototype.set=function(a,c){Nm(this.f,a)||(this.g++,this.b.push(a),this.h++);this.f[a]=c};var Km=function(a,c){if(c instanceof Lm)for(var b=c.Ab(),d=0;d<b.length;d++)a.set(b[d],c.get(b[d]));else for(b in c)a.set(b,c[b])};Lm.prototype.forEach=function(a,c){for(var b=this.Ab(),d=0;d<b.length;d++){var e=b[d],f=this.get(e);a.call(c,f,e,this)}};Lm.prototype.clone=function(){return new Lm(this)};var Qm=function(a){Mm(a);for(var c={},b=0;b<a.b.length;b++){var d=a.b[b];c[d]=a.f[d]}return c};
Lm.prototype.Sb=function(a){Mm(this);var c=0,b=this.h,d=this,e=new Fm;e.next=function(){if(b!=d.h)throw Error("The map has changed since the iterator was created");if(c>=d.b.length)throw Em;var f=d.b[c++];return a?f:d.f[f]};return e};var Nm=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};var Rm=function(a,c){this.h=c;this.f=a;this.f.ra=this.ra.bind(this);this.b=new Lm;this.j=new Lm;this.m=hb("mr.cast.SinkDiscoveryService");this.g={ug:0,Gg:0}};q(Rm,Mi);Rm.prototype.init=function(){cm(this);Wi("mr.cast.SinkDiscoveryService",this)};
var Zm=function(a,c){a.m.info("addSinks returned "+c.length+" sinks");ob(a.m,function(){return"....the list is: "+JSON.stringify(c)});var b=new Set(a.b.Ab());c.forEach(function(e){var f=e.sink_id;var g=e.extra_data.cast_media_sink,k=g.ip_endpoint?g.ip_endpoint.address:g.ip_address,m=g.ip_endpoint?g.ip_endpoint.port:wm().h||8009;f=new Cm(f,e.name,g.model_name,g.capabilities,k.address_bytes.join("."),m);g=a.b.get(f.getId());k=a.f;e=e.extra_data.cast_media_sink.cast_channel_id;m=f.getId();var p=k.f.get(m);
if(!p||p.channelId!=e){Sm.info("Added cast channel "+e+" to receiver: "+m);p&&k.b.remove(p.channelId);p={auth:"ssl_verified",ipAddress:f.Zb(),port:f.Bb()};p={channelId:e,readyState:"open",keepAlive:!0,audioOnly:!(f.b&1),connectInfo:p};k.f.set(m,p);k.b.set(e,m);var v=k.h.get(m);v&&v.channelId!=e&&(Sm.info("Re-connected to receiver: "+f.getId()),Tm(k.g,v,p),Um(k.j.j,f,!0));k.h.set(m,p)}if(g){if(k=g.update(f.f.friendlyName,f.Zb(),f.Bb(),f.b))g.Ci=!1;k&&Vm(a.h,g)}else a.m.info("Adding sink "+f.getId()),
Wm(a,f),g=a.h,g.g.onSinkAvailabilityUpdated(g,1),Vm(g,f),Um(g.j,f),wm().b=new tm(f.Cc,f.Zb());b.delete(f.getId())});b.forEach(function(e){var f=a.f,g=f.h.get(e);g&&(Xm(f.g,g),f.h.remove(e));Ym(a,e)});var d=a.b.sa();a.g={ug:d,Gg:d}};Rm.prototype.Xe=function(){return this.g};
var Wm=function(a,c){var b=a.b.get(c.getId()),d=null,e=c.Zb(),f=c.Bb();null!=e&&null!=f&&(d=a.j.get(e+":"+f));if(b&&!d){var g=c.Zb(),k=c.Bb();g&&k&&a.j.remove(g+":"+k)}d&&!b&&a.b.remove(d.getId());a.b.set(c.getId(),c);null!=e&&null!=f&&a.j.set(e+":"+f,c)},Ym=function(a,c){var b=a.b.get(c);if(b){a.m.info("Removing sink "+c);a.b.remove(c);c=b.Zb();var d=b.Bb();null!=c&&null!=d&&a.j.remove(c+":"+d);a=a.h;if(0==a.b.b.sa())a.g.onSinkAvailabilityUpdated(a,0);c=a.j;b=b.getId();(b=$m(c.b,b))&&b.session&&
an(c,b.session.sessionId);bn(a.F);a.g.ed()}},dn=function(a){a.m.info("Pruning inactive sinks.");var c=new Set;a.b.forEach(function(b){cn(a.f,b)||c.add(b.getId())});c.forEach(function(b){return Ym(a,b)})};Rm.prototype.ra=function(a){return this.b.get(a,null)};var en=function(a,c){var b=[];Hm(a.b.Sb(!1),function(d){Vl(Dm(d,c))&&b.push(d)});return b};Rm.prototype.Ea=function(){return"cast.SinkDiscoveryService"};
Rm.prototype.kb=function(){var a=this,c={};Hm(this.b.Sb(!0),function(b){var d=a.b.get(b);d={id:d.getId(),ip:d.Zb(),port:d.Bb(),friendlyName:d.f.friendlyName,modelName:d.Cc,capabilities:d.b,discoveredByDial:d.Ci,appStatusMap:d.kc};c[b]=d});return[new fn(c,this.g)]};
Rm.prototype.jb=function(){var a=$l(this);if(a&&4==a.version){this.g=a.deviceCounts;a=a.sinkMap;for(var c in a){var b=void 0,d=a[c],e=new Cm("",d.friendlyName,d.modelName,d.capabilities,d.ip,d.port);e.f.id=d.id;e.Ci=d.discoveredByDial;e.kc=d.appStatusMap;for(b in e.kc)"unavailable"==e.kc[b]&&(e.kc[b]="unavailable_rescan");b=e;this.ra(b.getId())||Wm(this,b)}dn(this)}};var fn=function(a,c){this.sinkMap=a;this.deviceCounts=c;this.version=4};var gn={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var hn=function(){this.type="GET_STATUS";this.requestId=0};var jn=function(a,c){this.requestId=a;this.gh=c;this.Dn=null};jn.prototype.b=function(){};var kn=function(){this.b=new Lm},ln=function(a,c){a.b.set(c.requestId,c);c.Dn=setTimeout(function(){a.b.remove(c.requestId);c.b()},c.gh)},mn=function(a,c){var b=a.b.get(c);if(!b)return null;clearTimeout(b.Dn);a.b.remove(c);return b};var nn=function(a,c,b){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=c;this.message=b};var on=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var pn=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var qn=function(a){this.f=a;this.b=1E3*Math.floor(1E6*Math.random())},rn=function(a){var c=a.b++;0==c&&(c=a.b++);return c};qn.prototype.Ea=function(){return"IdGenerator."+this.f};qn.prototype.kb=function(){return[this.b]};qn.prototype.jb=function(){var a=$l(this);a&&(this.b=a)};var sn=function(a,c){this.f=a;this.g=c;this.b=new kn;this.h=new qn("cast.RequestIdGenerator")};sn.prototype.init=function(){cm(this.h)};var un=function(a,c,b,d){var e=rn(a.h);c.requestId=e;c=new Db;b=new tn(e,c,r(b)&&0<b?b:6E5,d);ln(a.b,b);return b};
sn.prototype.sendRequest=function(a,c,b,d,e,f){var g=this;if(!Ul.hasOwnProperty(b))return Promise.reject(Error("Custom namespace is not supported"));var k=un(this,a,Ia(d)?d:3E3,e),m=k.wb;vn(this.f,c,b,a,e||this.g,f).then(null,function(){mn(g.b,k.requestId);m.reject(wn)});return m.b};
sn.prototype.sendMessage=function(a,c,b,d,e,f){var g=this,k=un(this,a,Ia(d)?d:3E3,e),m=k.wb;vn(this.f,c,b,a,e||this.g,f).then(function(){mn(g.b,k.requestId);m.resolve(!0)},function(){mn(g.b,k.requestId);m.reject(wn)});return m.b};
var xn=function(a,c,b){var d=new on(c.appId);d.language=c.language?c.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return a.sendRequest(d,b,Pl,c.requestSessionTimeout)},yn=Error("Timeout"),wn=Error("Failed to send message"),tn=function(a,c,b,d){jn.call(this,a,b);this.wb=c;this.sourceId=d};q(tn,jn);tn.prototype.b=function(){this.wb.reject(yn)};var zn=function(a){return a.sa&&"function"==typeof a.sa?a.sa():Va(a)||Ja(a)?a.length:Bc(a)},An=function(a){if(a.oa&&"function"==typeof a.oa)return a.oa();if(Ja(a))return a.split("");if(Va(a)){for(var c=[],b=a.length,d=0;d<b;d++)c.push(a[d]);return c}return Dc(a)},Bn=function(a){if(a.Ab&&"function"==typeof a.Ab)return a.Ab();if(!a.oa||"function"!=typeof a.oa){if(Va(a)||Ja(a)){var c=[];a=a.length;for(var b=0;b<a;b++)c.push(b);return c}return Ec(a)}},Cn=function(a){return a.Wb&&"function"==typeof a.Wb?
a.Wb():Va(a)||Ja(a)?Vb(a):Jc(a)},Dn=function(a,c,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(c,b);else if(Va(a)||Ja(a))y(a,c,b);else for(var d=Bn(a),e=An(a),f=e.length,g=0;g<f;g++)c.call(b,e[g],d&&d[g],a)},En=function(a,c,b){if("function"==typeof a.map)return a.map(c,b);if(Va(a)||Ja(a))return Nb(a,c,b);var d=Bn(a),e=An(a),f=e.length;if(d){var g={};for(var k=0;k<f;k++)g[d[k]]=c.call(b,e[k],d[k],a)}else for(g=[],k=0;k<f;k++)g[k]=c.call(b,e[k],void 0,a);return g},Fn=function(a,c){if("function"==
typeof a.every)return a.every(c,void 0);if(Va(a)||Ja(a))return Qb(a,c,void 0);for(var b=Bn(a),d=An(a),e=d.length,f=0;f<e;f++)if(!c.call(void 0,d[f],b&&b[f],a))return!1;return!0};var Hn=function(a){this.b=new Lm;a&&Gn(this,a)},In=function(a){var c=typeof a;return"object"==c&&a||"function"==c?"o"+(a[Za]||(a[Za]=++ab)):c.substr(0,1)+a};Hn.prototype.sa=function(){return this.b.sa()};Hn.prototype.add=function(a){this.b.set(In(a),a)};var Gn=function(a,c){c=An(c);for(var b=c.length,d=0;d<b;d++)a.add(c[d])};h=Hn.prototype;h.removeAll=function(a){a=An(a);for(var c=a.length,b=0;b<c;b++)this.remove(a[b])};h.remove=function(a){return this.b.remove(In(a))};h.clear=function(){this.b.clear()};
h.Wb=function(){return this.b.Wb()};h.contains=function(a){return Om(this.b,In(a))};h.oa=function(){return this.b.oa()};h.clone=function(){return new Hn(this)};h.equals=function(a){return this.sa()==zn(a)&&Jn(this,a)};var Jn=function(a,c){var b=zn(c);if(a.sa()>b)return!1;!(c instanceof Hn)&&5<b&&(c=new Hn(c));return Fn(a,function(d){var e=c;return e.contains&&"function"==typeof e.contains?e.contains(d):e.Ff&&"function"==typeof e.Ff?e.Ff(d):Va(e)||Ja(e)?Ub(e,d):Ic(e,d)})};Hn.prototype.Sb=function(){return this.b.Sb(!1)};var Ln=function(a,c){this.h=a;this.g=c;this.f=new Lm;this.b=new Hn;this.j=0;this.o=new Lm("serviceCheck",this.Eq.bind(this),"startDeviceMonitor",this.Fq.bind(this),"releaseDeviceMonitor",this.Dq.bind(this),"deviceJustSetUp",this.Aq.bind(this),"logRecord",this.Bq.bind(this));chrome.runtime.onMessage.addListener(this.l.bind(this));chrome.runtime.onMessageExternal.addListener(this.w.bind(this));Kn(this,"serviceReady")};Ln.prototype.m=hb("castApp.eventPage.Service");
var bn=function(a){if(Mn(a)){var c=new Hn;Hm(a.h.b.Sb(!1),function(d){var e=d.Zb();c.add(e);Om(this.f,e)||this.g.sendRequest(new hn,d,Pl)}.bind(a));var b=!1;a.f.Ab().forEach(function(d){c.contains(d)||(this.f.remove(d),b=!0)}.bind(a));b&&Nn(a)}},Mn=function(a){if(0===a.b.sa())return!1;var c=u();3E4<c-a.j&&(a.j=c,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(b){0===b.length?(this.m.info("No tabs found. Clearing device monitor clients."),
this.b.clear()):this.m.info(function(){return"Tab check found active tabs: "+b.map(function(d){return d.id})})}.bind(a)));c=a.b.sa();a.m.info("Monitor client count: "+c);return 0<c};Ln.prototype.l=function(a,c,b){if("object"!==typeof a||"cast_app"!==a.type)return!1;var d=this.o.get(a.subtype);if(!d)return!1;if(!a.originId)return Hb("Missing origin ID in the incoming message."),!1;try{var e=d(a,c,b);e&&b(e)}catch(f){this.m.error("Error while handling request",f)}return!1};
var Kn=function(a,c,b){var d=new Kl(c,b);ob(a.m,function(){return"Sending message: "+JSON.stringify(d)});chrome.runtime.sendMessage(d)};h=Ln.prototype;h.Eq=function(){Kn(this,"serviceReady")};h.Fq=function(a){this.b.contains(a.originId)?this.m.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.m.info("Registering monitor client: "+a.originId),this.b.add(a.originId));Nn(this);On(this)};h.Dq=function(a){this.m.info("Unregistering monitor client: "+a.originId);this.b.remove(a.originId)};
h.Aq=function(a){a=a.deviceJustSetUp.udn.replace(/-/g,"").toLowerCase();this.m.info("Device just set up: "+a.slice(-4))};h.Bq=function(a){a=a.logRecord;kb({level:rb(a.levelValue),R:a.loggerName,time:a.time,message:a.msg})};var Nn=function(a){var c=a.f.oa();Kn(a,"devices",c)},On=function(a){a.h.b.oa().forEach(function(c){this.g.sendRequest(new hn,c,Pl)}.bind(a))};
Ln.prototype.w=function(a,c,b){switch(a.type){case "handshake":b(new Ml("handshake"));break;case "launch":c=c.tab&&r(c.tab.id)?c.tab.id:null,null===c||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(c,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.VERSION=[1,2];w("chrome.cast.VERSION",chrome.cast.VERSION);chrome.cast.wt=!0;w("chrome.cast.usingPresentationApi",chrome.cast.wt);chrome.cast.Error=function(a,c,b){this.code=a;this.description=c||null;this.details=b||null};w("chrome.cast.Error",chrome.cast.Error);chrome.cast.ep=function(a){this.platform=a;this.packageId=this.url=null};w("chrome.cast.SenderApplication",chrome.cast.ep);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};w("chrome.cast.Image",chrome.cast.Image);
chrome.cast.Volume=function(a,c){this.level=Ia(a)?a:null;this.muted=Ia(c)?c:null};w("chrome.cast.Volume",chrome.cast.Volume);chrome.cast.kd={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};w("chrome.cast.AutoJoinPolicy",chrome.cast.kd);chrome.cast.oh={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};w("chrome.cast.DefaultActionPolicy",chrome.cast.oh);chrome.cast.Ud={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
w("chrome.cast.Capability",chrome.cast.Ud);chrome.cast.od={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};w("chrome.cast.ErrorCode",chrome.cast.od);chrome.cast.Po={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
w("chrome.cast.ReceiverAvailability",chrome.cast.Po);chrome.cast.fp={CHROME:"chrome",IOS:"ios",ANDROID:"android"};w("chrome.cast.SenderPlatform",chrome.cast.fp);chrome.cast.ph={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};w("chrome.cast.ReceiverType",chrome.cast.ph);chrome.cast.co={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};w("chrome.cast.DialAppState",chrome.cast.co);chrome.cast.mg={CAST:"cast",STOP:"stop"};w("chrome.cast.ReceiverAction",chrome.cast.mg);
chrome.cast.Vk={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};w("chrome.cast.SessionStatus",chrome.cast.Vk);chrome.cast.Zk={ATTENUATION:"attenuation",FIXED:"fixed",MASTER:"master"};w("chrome.cast.VolumeControlType",chrome.cast.Zk);chrome.cast.Qn=function(a,c,b,d,e){this.sessionRequest=a;this.sessionListener=c;this.receiverListener=b;this.autoJoinPolicy=d||chrome.cast.kd.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=e||chrome.cast.oh.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};w("chrome.cast.ApiConfig",chrome.cast.Qn);chrome.cast.fo=function(a,c){this.appName=a;this.launchParameter=c||null};w("chrome.cast.DialRequest",chrome.cast.fo);
chrome.cast.Ck=function(a,c,b){this.receiver=a;this.appState=c;this.extraData=b||null};w("chrome.cast.DialLaunchData",chrome.cast.Ck);chrome.cast.eo=function(a,c){this.doLaunch=a;this.launchParameter=c||null};w("chrome.cast.DialLaunchResponse",chrome.cast.eo);chrome.cast.Uk=function(a,c,b){this.appId=a;this.capabilities=Ua(c)?c:[chrome.cast.Ud.VIDEO_OUT,chrome.cast.Ud.AUDIO_OUT];this.requestSessionTimeout=b||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
w("chrome.cast.SessionRequest",chrome.cast.Uk);
chrome.cast.gi=function(a,c,b,d){this.label=a;a=c;ud.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(od,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(pd,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(qd,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(rd,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(sd,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(td,"&#0;")));this.friendlyName=a;this.capabilities=b||[];this.volume=d||null;this.receiverType=chrome.cast.ph.CAST;this.displayStatus=this.isActiveInput=null};
w("chrome.cast.Receiver",chrome.cast.gi);chrome.cast.Qo=function(a,c){this.statusText=a;this.appImages=c;this.showStop=null};w("chrome.cast.ReceiverDisplayStatus",chrome.cast.Qo);chrome.cast.Xk=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};w("chrome.cast.Timeout",chrome.cast.Xk);chrome.cast.timeout=new chrome.cast.Xk;w("chrome.cast.timeout",chrome.cast.timeout);chrome.cast.wk="auto-join";chrome.cast.Qk="cast-session_";chrome.cast.media.mo={SDR:"sdr",HDR:"hdr",DV:"dv"};w("chrome.cast.media.HdrType",chrome.cast.media.mo);chrome.cast.media.no={AAC:"aac",AC3:"ac3",MP3:"mp3",TS:"ts",TS_AAC:"ts_aac",E_AC3:"e_ac3",FMP4:"fmp4"};w("chrome.cast.media.HlsSegmentFormat",chrome.cast.media.no);chrome.cast.media.oo={MPEG2_TS:"mpeg2_ts",FMP4:"fmp4"};w("chrome.cast.media.HlsVideoSegmentFormat",chrome.cast.media.oo);chrome.cast.media.xe={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};
w("chrome.cast.media.MediaCommand",chrome.cast.media.xe);chrome.cast.media.Mo={ALBUM:"ALBUM",PLAYLIST:"PLAYLIST",AUDIOBOOK:"AUDIOBOOK",RADIO_STATION:"RADIO_STATION",PODCAST_SERIES:"PODCAST_SERIES",TV_SERIES:"TV_SERIES",VIDEO_PLAYLIST:"VIDEO_PLAYLIST",LIVE_TV:"LIVE_TV",MOVIE:"MOVIE"};w("chrome.cast.media.QueueType",chrome.cast.media.Mo);chrome.cast.media.bi={GENERIC_CONTAINER:0,AUDIOBOOK_CONTAINER:1};w("chrome.cast.media.ContainerType",chrome.cast.media.bi);
chrome.cast.media.ye={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4,AUDIOBOOK_CHAPTER:5};w("chrome.cast.media.MetadataType",chrome.cast.media.ye);chrome.cast.media.PlayerState={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};w("chrome.cast.media.PlayerState",chrome.cast.media.PlayerState);chrome.cast.media.hi={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};w("chrome.cast.media.RepeatMode",chrome.cast.media.hi);
chrome.cast.media.Ro={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};w("chrome.cast.media.ResumeState",chrome.cast.media.Ro);chrome.cast.media.Wk={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};w("chrome.cast.media.StreamType",chrome.cast.media.Wk);chrome.cast.media.qo={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};w("chrome.cast.media.IdleReason",chrome.cast.media.qo);chrome.cast.media.pp={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};
w("chrome.cast.media.TrackType",chrome.cast.media.pp);chrome.cast.media.mp={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};w("chrome.cast.media.TextTrackType",chrome.cast.media.mp);chrome.cast.media.hp={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};w("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.hp);chrome.cast.media.np={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};
w("chrome.cast.media.TextTrackWindowType",chrome.cast.media.np);chrome.cast.media.jp={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};w("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.jp);chrome.cast.media.kp={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};w("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.kp);
chrome.cast.media.sp={LIKE:"LIKE",DISLIKE:"DISLIKE",FOLLOW:"FOLLOW",UNFOLLOW:"UNFOLLOW"};w("chrome.cast.media.UserAction",chrome.cast.media.sp);chrome.cast.media.ko=function(){this.customData=null};w("chrome.cast.media.GetStatusRequest",chrome.cast.media.ko);chrome.cast.media.Bo=function(){this.customData=null};w("chrome.cast.media.PauseRequest",chrome.cast.media.Bo);chrome.cast.media.Co=function(){this.customData=null};w("chrome.cast.media.PlayRequest",chrome.cast.media.Co);chrome.cast.media.cp=function(){this.customData=this.resumeState=this.currentTime=null};w("chrome.cast.media.SeekRequest",chrome.cast.media.cp);
chrome.cast.media.gp=function(){this.customData=null};w("chrome.cast.media.StopRequest",chrome.cast.media.gp);chrome.cast.media.wp=function(a){this.volume=a;this.customData=null};w("chrome.cast.media.VolumeRequest",chrome.cast.media.wp);chrome.cast.media.so=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};w("chrome.cast.media.LoadRequest",chrome.cast.media.so);
chrome.cast.media.Ay=function(a){this.type="PRECACHE";this.requestId=0;this.precacheData=a};chrome.cast.media.jo=function(a,c){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=c||null};w("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.jo);chrome.cast.media.ai=function(a){this.containerType=a=void 0===a?chrome.cast.media.bi.GENERIC_CONTAINER:a;this.containerDuration=this.containerImages=this.sections=this.title=void 0};w("chrome.cast.media.ContainerMetadata",chrome.cast.media.ai);
chrome.cast.media.sc=function(a){this.metadataType=this.type=a;this.queueItemId=this.sectionStartTimeInContainer=this.sectionStartAbsoluteTime=this.sectionStartTimeInMedia=this.sectionDuration=void 0};w("chrome.cast.media.MediaMetadata",chrome.cast.media.sc);chrome.cast.media.Ik=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ye.GENERIC);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=void 0};q(chrome.cast.media.Ik,chrome.cast.media.sc);
w("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.Ik);chrome.cast.media.Kk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ye.MOVIE);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=void 0};q(chrome.cast.media.Kk,chrome.cast.media.sc);w("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.Kk);
chrome.cast.media.Yk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ye.TV_SHOW);this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=void 0};q(chrome.cast.media.Yk,chrome.cast.media.sc);w("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.Yk);
chrome.cast.media.Lk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ye.MUSIC_TRACK);this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=void 0};q(chrome.cast.media.Lk,chrome.cast.media.sc);w("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.Lk);
chrome.cast.media.Rk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ye.PHOTO);this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=void 0};q(chrome.cast.media.Rk,chrome.cast.media.sc);w("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.Rk);chrome.cast.media.yk=function(){chrome.cast.media.ai.call(this,chrome.cast.media.bi.AUDIOBOOK_CONTAINER);this.releaseDate=this.publisher=this.narrators=this.authors=void 0};
q(chrome.cast.media.yk,chrome.cast.media.ai);w("chrome.cast.media.AudiobookContainerMetadata",chrome.cast.media.yk);chrome.cast.media.xk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ye.AUDIOBOOK_CHAPTER);this.images=this.subtitle=this.bookTitle=this.chapterNumber=this.title=this.chapterTitle=void 0};q(chrome.cast.media.xk,chrome.cast.media.sc);w("chrome.cast.media.AudiobookChapterMediaMetadata",chrome.cast.media.xk);
chrome.cast.media.uo=function(a,c){this.contentId=a;this.contentUrl=void 0;this.streamType=chrome.cast.media.Wk.BUFFERED;this.contentType=c;this.metadata=null;this.entity=void 0;this.duration=null;this.startAbsoluteTime=void 0;this.customData=this.textTrackStyle=this.tracks=null;this.userActionStates=this.hlsVideoSegmentFormat=this.hlsSegmentFormat=this.vmapAdsRequest=this.breakClips=this.breaks=void 0};w("chrome.cast.media.MediaInfo",chrome.cast.media.uo);
chrome.cast.media.Go=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};w("chrome.cast.media.QueueItem",chrome.cast.media.Go);chrome.cast.media.ao="CC1AD845";w("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.ao);chrome.cast.media.timeout={};chrome.cast.media.timeout.load=0;w("chrome.cast.media.timeout.load",chrome.cast.media.timeout.load);
chrome.cast.media.timeout.Wa=0;w("chrome.cast.media.timeout.getStatus",chrome.cast.media.timeout.Wa);chrome.cast.media.timeout.play=0;w("chrome.cast.media.timeout.play",chrome.cast.media.timeout.play);chrome.cast.media.timeout.pause=0;w("chrome.cast.media.timeout.pause",chrome.cast.media.timeout.pause);chrome.cast.media.timeout.seek=0;w("chrome.cast.media.timeout.seek",chrome.cast.media.timeout.seek);chrome.cast.media.timeout.stop=0;w("chrome.cast.media.timeout.stop",chrome.cast.media.timeout.stop);
chrome.cast.media.timeout.setVolume=0;w("chrome.cast.media.timeout.setVolume",chrome.cast.media.timeout.setVolume);chrome.cast.media.timeout.Ei=0;w("chrome.cast.media.timeout.editTracksInfo",chrome.cast.media.timeout.Ei);chrome.cast.media.timeout.os=0;w("chrome.cast.media.timeout.queue",chrome.cast.media.timeout.os);chrome.cast.media.op=function(a,c){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=c;this.customData=this.subtype=this.language=this.name=null};
w("chrome.cast.media.Track",chrome.cast.media.op);chrome.cast.media.lp=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};w("chrome.cast.media.TextTrackStyle",chrome.cast.media.lp);
chrome.cast.media.Io=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.hi.OFF;this.customData=null};w("chrome.cast.media.QueueLoadRequest",chrome.cast.media.Io);chrome.cast.media.Fo=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};w("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.Fo);
chrome.cast.media.No=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};w("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.No);chrome.cast.media.Ho=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};w("chrome.cast.media.QueueJumpRequest",chrome.cast.media.Ho);
chrome.cast.media.Lo=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};w("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.Lo);chrome.cast.media.Jo=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};w("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.Jo);
chrome.cast.media.Ko=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};w("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.Ko);chrome.cast.media.Tn=function(a,c,b){this.id=a;this.breakClipIds=c;this.position=b;this.duration=void 0;this.isWatched=!1;this.isEmbedded=void 0};w("chrome.cast.media.Break",chrome.cast.media.Tn);
chrome.cast.media.Un=function(a){this.id=a;this.vastAdsRequest=this.customData=this.hlsSegmentFormat=this.clickThroughUrl=this.posterUrl=this.whenSkippable=this.duration=this.title=this.contentType=this.contentUrl=this.contentId=void 0};w("chrome.cast.media.BreakClip",chrome.cast.media.Un);chrome.cast.media.up=function(){this.adsResponse=this.adTagUrl=void 0};w("chrome.cast.media.VastAdsRequest",chrome.cast.media.up);
chrome.cast.media.Vn=function(){this.whenSkippable=this.breakClipId=this.breakId=this.currentBreakClipTime=this.currentBreakTime=void 0};w("chrome.cast.media.BreakStatus",chrome.cast.media.Vn);chrome.cast.media.ro=function(a,c,b,d){this.start=a;this.end=c;this.isMovingWindow=b;this.isLiveDone=d};w("chrome.cast.media.LiveSeekableRange",chrome.cast.media.ro);
chrome.cast.media.Eo=function(a,c,b,d,e,f,g){this.id=a;this.queueType=this.entity=void 0;this.name=c;this.description=b;this.repeatMode=d;this.shuffle=!1;this.items=e;this.startIndex=f;this.startTime=g;this.containerMetadata=void 0};w("chrome.cast.media.QueueData",chrome.cast.media.Eo);chrome.cast.media.tp=function(a){this.userAction=a;this.customData=void 0};w("chrome.cast.media.UserActionState",chrome.cast.media.tp);chrome.cast.media.vp=function(a,c,b){this.width=a;this.height=c;this.hdrType=b};
w("chrome.cast.media.VideoInformation",chrome.cast.media.vp);chrome.cast.media.X=function(a,c){this.sessionId=a;this.mediaSessionId=c;this.media=null;this.videoInfo=this.queueData=void 0;this.playbackRate=1;this.playerState=chrome.cast.media.PlayerState.IDLE;this.currentTime=0;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.hi.OFF;this.liveSeekableRange=this.breakStatus=void 0};
w("chrome.cast.media.Media",chrome.cast.media.X);chrome.cast.media.X.prototype.Wa=function(){};chrome.cast.media.X.prototype.getStatus=chrome.cast.media.X.prototype.Wa;chrome.cast.media.X.prototype.play=function(){};chrome.cast.media.X.prototype.play=chrome.cast.media.X.prototype.play;chrome.cast.media.X.prototype.es=function(){};chrome.cast.media.X.prototype.playWithContext=chrome.cast.media.X.prototype.es;chrome.cast.media.X.prototype.pause=function(){};chrome.cast.media.X.prototype.pause=chrome.cast.media.X.prototype.pause;
chrome.cast.media.X.prototype.cs=function(){};chrome.cast.media.X.prototype.pauseWithContext=chrome.cast.media.X.prototype.cs;chrome.cast.media.X.prototype.seek=function(){};chrome.cast.media.X.prototype.seek=chrome.cast.media.X.prototype.seek;chrome.cast.media.X.prototype.stop=function(){};chrome.cast.media.X.prototype.stop=chrome.cast.media.X.prototype.stop;chrome.cast.media.X.prototype.setVolume=function(){};chrome.cast.media.X.prototype.setVolume=chrome.cast.media.X.prototype.setVolume;
chrome.cast.media.X.prototype.Ei=function(){};chrome.cast.media.X.prototype.editTracksInfo=chrome.cast.media.X.prototype.Ei;chrome.cast.media.X.prototype.rs=function(){};chrome.cast.media.X.prototype.queueInsertItems=chrome.cast.media.X.prototype.rs;chrome.cast.media.X.prototype.qs=function(){};chrome.cast.media.X.prototype.queueAppendItem=chrome.cast.media.X.prototype.qs;chrome.cast.media.X.prototype.Cs=function(){};chrome.cast.media.X.prototype.queueUpdateItems=chrome.cast.media.X.prototype.Cs;
chrome.cast.media.X.prototype.xs=function(){};chrome.cast.media.X.prototype.queuePrev=chrome.cast.media.X.prototype.xs;chrome.cast.media.X.prototype.ws=function(){};chrome.cast.media.X.prototype.queueNext=chrome.cast.media.X.prototype.ws;chrome.cast.media.X.prototype.ts=function(a){Pn(this,a)};chrome.cast.media.X.prototype.queueJumpToItem=chrome.cast.media.X.prototype.ts;chrome.cast.media.X.prototype.Bs=function(){};chrome.cast.media.X.prototype.queueSetRepeatMode=chrome.cast.media.X.prototype.Bs;
chrome.cast.media.X.prototype.zs=function(){};chrome.cast.media.X.prototype.queueRemoveItems=chrome.cast.media.X.prototype.zs;chrome.cast.media.X.prototype.ys=function(a){Pn(this,a)};chrome.cast.media.X.prototype.queueRemoveItem=chrome.cast.media.X.prototype.ys;chrome.cast.media.X.prototype.As=function(){};chrome.cast.media.X.prototype.queueReorderItems=chrome.cast.media.X.prototype.As;
chrome.cast.media.X.prototype.vs=function(a,c,b,d){a=Pn(this,a);0>a||(0>c?d&&d(new chrome.cast.Error(chrome.cast.od.INVALID_PARAMETER)):a==c&&b&&b())};chrome.cast.media.X.prototype.queueMoveItemToNewIndex=chrome.cast.media.X.prototype.vs;chrome.cast.media.X.prototype.st=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.X.prototype.supportsCommand=chrome.cast.media.X.prototype.st;chrome.cast.media.X.prototype.tq=function(){return this.currentTime};
chrome.cast.media.X.prototype.getEstimatedTime=chrome.cast.media.X.prototype.tq;chrome.cast.media.X.prototype.ri=function(){};chrome.cast.media.X.prototype.addUpdateListener=chrome.cast.media.X.prototype.ri;chrome.cast.media.X.prototype.si=function(){};chrome.cast.media.X.prototype.addUpdateListenerWithContext=chrome.cast.media.X.prototype.si;chrome.cast.media.X.prototype.Yj=function(){};chrome.cast.media.X.prototype.removeUpdateListener=chrome.cast.media.X.prototype.Yj;
chrome.cast.media.X.prototype.Zj=function(){};chrome.cast.media.X.prototype.removeUpdateListenerWithContext=chrome.cast.media.X.prototype.Zj;var Pn=function(a,c){return Rb(a.items,function(b){return b.itemId==c})};var Qn=function(a,c,b){this.sessionId=a;this.namespaceName=c;this.message=b};var Rn=function(a,c){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=c||null};chrome.cast.da=function(a,c,b,d,e){this.sessionId=a;this.appId=c;this.displayName=b;this.statusText=null;this.appImages=d;this.receiver=e;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.Vk.CONNECTED;this.transportId=""};w("chrome.cast.Session",chrome.cast.da);chrome.cast.da.prototype.ft=function(a,c,b){this.xn(null,a,c,b)};chrome.cast.da.prototype.setReceiverVolumeLevel=chrome.cast.da.prototype.ft;
chrome.cast.da.prototype.xn=function(a,c,b,d){c=new Rn(new chrome.cast.Volume(c,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,c,b,d)};chrome.cast.da.prototype.setReceiverVolumeLevelWithContext=chrome.cast.da.prototype.xn;chrome.cast.da.prototype.et=function(a,c,b){this.wn(null,a,c,b)};chrome.cast.da.prototype.setReceiverMuted=chrome.cast.da.prototype.et;
chrome.cast.da.prototype.wn=function(a,c,b,d){a=new Rn(new chrome.cast.Volume(null,c),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,d)};chrome.cast.da.prototype.setReceiverMutedWithContext=chrome.cast.da.prototype.wn;chrome.cast.da.prototype.leave=function(a,c){null.leaveSession(this.sessionId,a,c)};chrome.cast.da.prototype.leave=chrome.cast.da.prototype.leave;chrome.cast.da.prototype.stop=function(){};chrome.cast.da.prototype.stop=chrome.cast.da.prototype.stop;
chrome.cast.da.prototype.pt=function(){};chrome.cast.da.prototype.stopWithContext=chrome.cast.da.prototype.pt;chrome.cast.da.prototype.sendMessage=function(){};chrome.cast.da.prototype.sendMessage=chrome.cast.da.prototype.sendMessage;chrome.cast.da.prototype.Rs=function(){};chrome.cast.da.prototype.sendMessageWithContext=chrome.cast.da.prototype.Rs;chrome.cast.da.prototype.ri=function(){};chrome.cast.da.prototype.addUpdateListener=chrome.cast.da.prototype.ri;chrome.cast.da.prototype.si=function(){};
chrome.cast.da.prototype.addUpdateListenerWithContext=chrome.cast.da.prototype.si;chrome.cast.da.prototype.Yj=function(){};chrome.cast.da.prototype.removeUpdateListener=chrome.cast.da.prototype.Yj;chrome.cast.da.prototype.Zj=function(){};chrome.cast.da.prototype.removeUpdateListenerWithContext=chrome.cast.da.prototype.Zj;chrome.cast.da.prototype.Kp=function(){};chrome.cast.da.prototype.addMessageListener=chrome.cast.da.prototype.Kp;chrome.cast.da.prototype.Lp=function(){};
chrome.cast.da.prototype.addMessageListenerWithContext=chrome.cast.da.prototype.Lp;chrome.cast.da.prototype.Ip=function(){};chrome.cast.da.prototype.addMediaListener=chrome.cast.da.prototype.Ip;chrome.cast.da.prototype.Jp=function(){};chrome.cast.da.prototype.addMediaListenerWithContext=chrome.cast.da.prototype.Jp;chrome.cast.da.prototype.Ks=function(){};chrome.cast.da.prototype.removeMediaListener=chrome.cast.da.prototype.Ks;chrome.cast.da.prototype.Ls=function(){};
chrome.cast.da.prototype.removeMediaListenerWithContext=chrome.cast.da.prototype.Ls;chrome.cast.da.prototype.Ms=function(){};chrome.cast.da.prototype.removeMessageListener=chrome.cast.da.prototype.Ms;chrome.cast.da.prototype.Ns=function(){};chrome.cast.da.prototype.removeMessageListenerWithContext=chrome.cast.da.prototype.Ns;chrome.cast.da.prototype.Vq=function(a){a.sessionId=this.sessionId};chrome.cast.da.prototype.loadMedia=chrome.cast.da.prototype.Vq;
chrome.cast.da.prototype.us=function(a){a.sessionId=this.sessionId};chrome.cast.da.prototype.queueLoad=chrome.cast.da.prototype.us;var Un=function(a,c){if(!c.applications||1!=c.applications.length)return null;var b=c.applications[0];a=Sn(a);a=new chrome.cast.da(b.sessionId,b.appId,b.displayName,b.appImages,a);a.senderApps=b.senderApps;a.namespaces=b.namespaces||[];a.transportId=b.transportId;a.statusText=b.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||Tn(a)))return null;a.receiver.volume=c.volume;Ka(c.isActiveInput)&&(a.receiver.isActiveInput=c.isActiveInput);return a},Vn=function(a){var c=[];if(!a)return c;
a&1&&c.push(chrome.cast.Ud.VIDEO_OUT);a&2&&c.push(chrome.cast.Ud.VIDEO_IN);a&4&&c.push(chrome.cast.Ud.AUDIO_OUT);a&8&&c.push(chrome.cast.Ud.AUDIO_IN);a&32&&c.push(chrome.cast.Ud.MULTIZONE_GROUP);return c},Sn=function(a){var c=xm(wm(),a.getId());return new chrome.cast.gi(c,a.f.friendlyName,Vn(a.b))},Wn=function(a,c){if(a.statusText!=c.statusText)return!0;var b=a.namespaces||[],d=c.namespaces||[];if(b.length!=d.length)return!0;for(var e={jg:0};e.jg<b.length;e={jg:e.jg},e.jg++)if(!d.some(function(f){return function(g){return g.name==
b[f.jg].name}}(e)))return!0;return a.receiver.volume.level!==c.receiver.volume.level||a.receiver.volume.muted!==c.receiver.volume.muted?!0:!1},Xn=function(a){Ua(a)?a.forEach(Xn):Ya(a)&&Object.keys(a).forEach(function(c){null===a[c]?delete a[c]:(Ya(a[c])||Ua(a[c]))&&Xn(a[c])})},Yn=function(a){return a.namespaces.some(function(c){return c.name==Rl})},Tn=function(a){return null!==a&&"MultizoneLeader"==a.appId},Zn=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==a};var $n=function(a,c,b){this.type=a;this.message=c;this.sequenceNumber=Ia(b)?b:-1;this.timeoutMillis=0;this.clientId=""};var ao=function(a,c){this.h=a;this.b=c;this.g=[];this.f=new kn},co=function(a,c){return(a=bo(a.b,c))?a.routeId:null};ao.prototype.listen=function(a,c){this.g[a]=c};var fo=function(a,c,b,d){ob(eo,"Sending to "+b);ob(eo,JSON.stringify(d));d.clientId=b;a.h.g.ge(c,d)},go=function(a,c,b){var d=bo(a.b,c);d&&d.b?fo(a,d.routeId,c,b):a.connect(c).then(function(e){e?(e=co(a,c))?fo(a,e,c,b):eo.G("No route for "+c):eo.G("No connected client "+c)},null)};
ao.prototype.connect=function(a){var c=bo(this.b,a);if(null!=c&&c.b)return Promise.resolve(!0);c=co(this,a);if(!c)return eo.G("No route for client "+a),Promise.resolve(!1);if(a=this.f.b.get(c,null))return a.wb.b;a=new Db;ln(this.f,new ho(c,a));return a.b};var eo=hb("mr.cast.ApiMessenger"),ho=function(a,c){jn.call(this,a,3E4);this.wb=c};q(ho,jn);ho.prototype.b=function(){this.wb.resolve(!1)};var io=function(a,c,b){this.g=a;this.b=c;this.f=b},jo=function(a){var c="cast-dial:"+a.g,b=new URLSearchParams;a.b&&b.set("dialPostData",a.b);a.f&&b.set("clientId",a.f);(a=b.toString())&&(c+="?"+a);return c};var ko=function(a,c,b,d,e,f,g,k,m,p){this.j=a;this.b=c||null;this.f=b||null;this.g=d||null;this.h=Ia(e)?e:null;this.s=f||null;this.D=g||null;this.o=k||!1;this.l=m||null;this.w=p||null},lo=function(a,c){return(a=a.match(c+"=([^/]*)"))?a[1]:null},no=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:Mb(Nb(a,function(c){c=lo(c,"__castAppId__");if(!c)return null;c=c.match(mo);if(!c||0==c.length)return null;var b=[];3==c.length&&c[2]&&(b=c[2].split(","));return{appId:c[1],capabilities:b}}),
function(c){return null!=c})},oo=function(a){return Nb(a.j,function(c){return c.appId})},po=function(a){return a.f?a.f:chrome.cast.kd.TAB_AND_ORIGIN_SCOPED},qo=function(a){var c=a.j.map(function(b){var d="cast:"+b.appId,e=new URLSearchParams;b.capabilities&&0<b.capabilities.length&&e.set("capabilities",b.capabilities.join(","));a.b&&e.set("clientId",a.b);a.f&&e.set("autoJoinPolicy",a.f);a.g&&e.set("defaultActionPolicy",a.g);null!=a.h&&e.set("launchTimeout",String(a.h));a.o&&e.set("invisibleSender",
"true");a.l&&(e.set("broadcastNamespace",a.l),e.set("broadcastId",String(Math.random())));a.w&&e.set("broadcastMessage",encodeURIComponent(JSON.stringify(a.w)));return d+"?"+e.toString()});a.s&&c.push(jo(new io(a.s,a.D,a.b)));return c},so=function(a,c){a=oo(a);var b=ro(c);return Pb(a,function(d){return Ub(b,d)})},to=function(a){try{var c=new URL(a)}catch(v){return null}if("https:"==c.protocol)if("https:"!=c.protocol||"google.com"!=c.host||"/cast"!=c.pathname)a=null;else{var b=c.hash;if((a=no(b))&&
0!=a.length){c=lo(b,"__castClientId__");var d=lo(b,"__castAutoJoinPolicy__"),e=lo(b,"__castDefaultActionPolicy__");var f=lo(b,"__castLaunchTimeout__");null==f?f=null:(f=Number(f),f=!isNaN(f)&&0<f?f:null);var g=lo(b,"__dialAppName__"),k=lo(b,"__dialPostData__");var m=lo(b,"__castInvisibleSender__");m=null===m?null:"true"==m;var p=lo(b,"__castBroadcastNamespace__");b=(b=lo(b,"__castBroadcastMessage__"))?JSON.parse(decodeURIComponent(b)):null;a=new ko(a,c,d,e,f,g,k,m,p,b)}else a=null}else if("cast:"==
c.protocol){a=c.pathname;d=c.searchParams.get("capabilities");a={appId:a,capabilities:d?d.split(","):[]};k=c.searchParams;c=k.get("clientId");d=k.get("autoJoinPolicy");e=k.get("defaultActionPolicy");b=Number(k.get("launchTimeout"));if(isNaN(b)||0>=b)b=null;f="true"==k.get("invisibleSender");g=k.get("broadcastNamespace");k=(k=k.get("broadcastMessage"))?JSON.parse(decodeURIComponent(k)):null;a=new ko([a],c,d,e,b,void 0,void 0,f,g,k)}else a=null;return a},ro=function(a){return(a=to(a))?oo(a):null},uo=
function(a){return(a=to(a))?a.b:null},mo=/(^\w+)(?:\(([\w, ]*)\))?$/;var vo={Cw:0,ow:1},wo={kA:0,Oo:1,Ey:2},xo={Hx:0,TIMEOUT:1,FAILED:2},yo={aw:0,my:1,SEEK:2,kx:3,zz:4,Qt:5},zo=function(a){Cb("MediaRouter.Cast.Session.Ended",a,wo)},Ao=function(a){Cb("MediaRouter.Cast.Controller.ActionType",a,yo)},Bo=function(a){Cb("MediaRouter.Cast.Session.Fail",a,xo)};var Co=function(a,c,b){this.R=hb("mr.MediaRouteController."+a);this.h=new mojo.Binding(mojo.MediaController,this,c);this.g=b;this.b=new mojo.MediaStatus({title:"",description:"",duration:new mojo.TimeDelta({microseconds:0}),current_time:new mojo.TimeDelta({microseconds:0})});this.s=!1;this.h.setConnectionErrorHandler(this.w.bind(this));this.g.ptr.setConnectionErrorHandler(this.w.bind(this))};Co.prototype.w=function(){this.ab();this.rj()};
Co.prototype.ab=function(){this.s||(this.s=!0,this.qj(),this.h&&(this.h.close(),this.h=null),this.g&&(this.g.ptr.reset(),this.g=null))};var Do=function(a){if(a.g)a.g.onMediaStatusUpdated(a.b)};h=Co.prototype;h.qj=function(){};h.rj=function(){};h.play=function(){};h.pause=function(){};h.lf=function(){};h.setVolume=function(){};h.seek=function(){};h.yi=function(a){a.close();throw Error("Not implemented");};Co.prototype.connectHangoutsMediaRouteController=Co.prototype.yi;Co.prototype.seek=Co.prototype.seek;
Co.prototype.setVolume=Co.prototype.setVolume;Co.prototype.setMute=Co.prototype.lf;Co.prototype.pause=Co.prototype.pause;Co.prototype.play=Co.prototype.play;var Eo=function(a){var c=new URL(a);a={};a.scheme=c.protocol.replace(":","");a.host=c.hostname;c=c.port?Number.parseInt(c.port,10):0;switch(a.scheme){case "http":a.port=c||80;break;case "https":a.port=c||443;break;default:throw Error("Scheme must be http or https");}a.suborigin="";return new mojo.Origin(a)},Fo=function(a){return new mojo.TimeDelta({microseconds:Math.floor(1E6*a)})};var Go=function(a,c,b,d){this.type=a;this.mediaSessionId=c;this.requestId=0;this.sessionId=b;this.currentTime=d},Io=function(a,c,b,d,e){Co.call(this,"CastRouteController",a,c);this.session=b;this.f=d;this.j=e;this.o=new Date;this.l=new Set;Ho(this);Ao(0)};q(Io,Co);
var Ho=function(a){var c=Jo(a);c&&Ko(a,c);c&&a.j||!a.session.statusText||(a.b.title=a.session.statusText.substring(0,256));a.b.volume=null===a.session.receiver.volume.level?0:a.session.receiver.volume.level;a.b.is_muted=!!a.session.receiver.volume.muted;a.b.can_mute=a.session.receiver.volume.controlType!==chrome.cast.Zk.FIXED;a.b.can_set_volume=a.b.can_mute;Do(a)};h=Io.prototype;h.rj=function(){Lo(this.f.b,this.session.sessionId)};
h.play=function(){var a=Jo(this);this.b.can_play_pause&&a&&this.b.play_state===mojo.MediaStatus.PlayState.PAUSED&&Mo(this.f,this.session,new Go("PLAY",a.mediaSessionId,this.session.sessionId));No(this,1)};h.pause=function(){var a=Jo(this);this.b.can_play_pause&&a&&this.b.play_state!==mojo.MediaStatus.PlayState.PAUSED&&Mo(this.f,this.session,new Go("PAUSE",a.mediaSessionId,this.session.sessionId));No(this,1)};
h.seek=function(a){var c=Jo(this);a=a?a.microseconds/1E6:0;var b;if(b=this.b.can_seek&&c&&0<=a)b=this.b.duration,b=a<=(b?b.microseconds/1E6:0);b&&Mo(this.f,this.session,new Go("SEEK",c.mediaSessionId,this.session.sessionId,a));No(this,2)};h.lf=function(a){this.b.can_mute&&a!==this.b.is_muted&&Oo(this.f,this.session,new chrome.cast.Volume(null,a));No(this,3)};h.setVolume=function(a){this.b.can_set_volume&&0<=a&&1>=a&&Oo(this.f,this.session,new chrome.cast.Volume(a));No(this,4)};
var Jo=function(a){return a.session.media.find(function(c){return!c.idleReason})||null},Ko=function(a,c){a.j&&c.media&&c.media.metadata&&c.media.metadata.title&&(a.b.title=c.media.metadata.title.substring(0,256));a.b.can_play_pause=c.supportedMediaCommands.includes(chrome.cast.media.xe.PAUSE);a.b.can_seek=c.supportedMediaCommands.includes(chrome.cast.media.xe.SEEK);var b=c.playerState;a.b.play_state=b===chrome.cast.media.PlayerState.PLAYING?mojo.MediaStatus.PlayState.PLAYING:b===chrome.cast.media.PlayerState.PAUSED?
mojo.MediaStatus.PlayState.PAUSED:mojo.MediaStatus.PlayState.BUFFERING;a.b.current_time=c.currentTime?Fo(c.playerState===chrome.cast.media.PlayerState.PLAYING?c.currentTime+(new Date-a.o)/1E3:c.currentTime):Fo(0);a.b.duration=c.media&&c.media.duration?Fo(c.media.duration):Fo(0)},No=function(a,c){0==a.l.size&&Ao(5);a.l.has(c)||(Ao(c),a.l.add(c))};Io.prototype.setVolume=Io.prototype.setVolume;Io.prototype.setMute=Io.prototype.lf;Io.prototype.seek=Io.prototype.seek;Io.prototype.pause=Io.prototype.pause;
Io.prototype.play=Io.prototype.play;var Po=function(a){this.f=a;this.m=hb("mr.cast.SessionLauncher")},Qo=function(a,c,b){Cb("MediaRouter.Cast.Session.Type",0,vo);return xn(a.f,c,b).then(a.b.bind(a,b),function(d){d&&yn==d?Bo(1):Bo(0);throw d;})};Po.prototype.b=function(a,c){ob(this.m,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==c.type)throw Bo(2),Error(c.reason);a=Un(a,c.status);this.m.info("Launched session: "+a.sessionId);return a};var Ro=function(a){this.b=a;this.m=hb("mr.cast.ReceiverStatusQuerier")},So=function(a,c){return(new df(t(a.f,a,c),3500,5)).start().then(null,function(b){a.m.info("Failed to get receiver status from "+c.getId());throw b;})};Ro.prototype.f=function(a){this.m.info("Query receiver status: "+a.getId());return this.b.sendRequest(new hn,a,Pl)};var To=function(a,c,b,d,e,f){this.g=a;this.w=c;this.j=b;this.b=d;this.l=e;this.h=f;this.f=new ao(f,b);this.C=new Ro(this.g);this.F=new Po(this.g)};To.prototype.init=function(){this.j.init();this.f.listen("v2_message",this.D.bind(this));this.f.listen("app_message",this.o.bind(this));this.f.listen("leave_session",this.s.bind(this))};
var Wo=function(a,c,b,d){Uo(a.b,c).slice().forEach(function(e){e!=d&&Vo(a,e,b)})},Vo=function(a,c,b){b.clientId=c;go(a.f,c,b)},Xo=function(a,c,b,d){b={receiver:Sn(b),action:d};Vo(a,c,new $n("receiver_action",b))};
To.prototype.D=function(a){var c=a.message,b=c.sessionId;if(b){var d=Yo(this.b,b);if(d)if(b=Zo(this.b,b))if(b=this.w.ra(b))switch(c.type){case "STOP":$o(this,a,b);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":ap(this,a,b,d);break;case "SET_VOLUME":bp(this,a,b);break;default:cp.G("Unknown request")}else dp(this,
a,chrome.cast.od.INVALID_PARAMETER,"No receiver");else dp(this,a,chrome.cast.od.INVALID_PARAMETER,"No sink ID");else dp(this,a,chrome.cast.od.INVALID_PARAMETER,"Unknown session ID")}else dp(this,a,chrome.cast.od.INVALID_PARAMETER,"No session ID")};
var dp=function(a,c,b,d){b=new chrome.cast.Error(b,d);ep(a,c,b)},ep=function(a,c,b){go(a.f,c.clientId,new $n("error",b,c.sequenceNumber))},$o=function(a,c,b){var d=c.message;Bb("MediaRouter.Cast.Session.End");var e=d.sessionId,f=fp(a.b,e);f&&(f.j=!0);f=function(){an(a,e,c)};a.g.sendRequest(d,b,Pl,c.timeoutMillis,c.clientId).then(f,f)},ap=function(a,c,b,d){var e=c.message,f=e.type;f in gn&&(e.type=gn[f]);a.g.sendRequest(e,b,Rl,c.timeoutMillis,c.clientId,d.transportId).then(function(g){gp(a,d,g);go(a.f,
c.clientId,new $n("v2_message",g,c.sequenceNumber))},function(g){ep(a,c,g)})},bp=function(a,c,b){var d=c.message;delete d.sessionId;a.g.sendRequest(d,b,Pl,c.timeoutMillis,c.clientId).then(function(){go(a.f,c.clientId,new $n("v2_message",null,c.sequenceNumber))},function(e){ep(a,c,e)})};
To.prototype.o=function(a){var c=this,b=a.message,d=b.sessionId;if(d){var e=Zo(this.b,d);e?(e=this.w.ra(e))?(d=Yo(this.b,d),Sb(d.namespaces,function(f){return f.name==b.namespaceName})?vn(this.l,e,b.namespaceName,b.message,a.clientId,d.transportId).then(function(){go(c.f,a.clientId,new $n("app_message",null,a.sequenceNumber))},function(){dp(c,a,chrome.cast.od.CHANNEL_ERROR,"Channel to receiver not available")}):dp(this,a,chrome.cast.od.INVALID_PARAMETER,"Invalid namespace")):cp.G("No receiver from sinkId"):
cp.G("No sinkId from sessionId")}else cp.G("No sessionId")};
To.prototype.s=function(a){var c=this;cp.info("Leave session");var b=fp(this.b,a.message);if(b){var d=a.clientId,e=bo(this.j,d);if(e){var f=[],g=[],k=e.tabId,m=e.origin,p=e.autoJoinPolicy;b.f.forEach(function(v){var A=bo(c.j,v);p==chrome.cast.kd.TAB_AND_ORIGIN_SCOPED&&k==A.tabId&&m==A.origin||p==chrome.cast.kd.ORIGIN_SCOPED&&m==A.origin?(A.f=!0,f.push(v)):g.push(v)});go(this.f,d,new $n("leave_session",null,a.sequenceNumber));f.forEach(function(v){(v=bo(c.j,v))&&hp(c.h,v.routeId,!0,!0)});b.f=g}else cp.G("No client record")}else cp.G("No session")};
var ip=function(a,c,b){Yn(c)&&a.g.sendRequest(new hn,b,Rl,void 0,void 0,c.transportId).catch(Qa)},Um=function(a,c,b){var d=c.getId();cp.info("Query status for "+d);So(a.C,c).then(function(e){jp(a,d,e);b&&(e=kp(a.b,d))&&ip(a,e,c)},Qa)},lp=function(a,c){if("*"==c.destinationId)return!0;c=c.destinationId;if(c==a.l.w||null!=bo(a.j,c))return!0;cp.info("Invalid destination "+c);return!1},pp=function(a,c,b){ob(cp,function(){return"Cast message: "+JSON.stringify(b)});if(lp(a,b))if(b.namespace_==Ql||b.namespace_==
Sl)(c=$m(a.b,c))&&c.b.forEach(function(f){var g=a.h,k=g.f.get(f);k&&k.Gf&&g.g.Sh(f,b)});else{var d=JSON.parse(b.data),e=mp(a,d);e=e?e.sourceId:void 0;switch(d.type){case "RECEIVER_STATUS":jp(a,c,d);break;case "MEDIA_STATUS":np(a,c,b,e)}}else op(a.l,c,b.destinationId,b.sourceId,!1)},mp=function(a,c){a=mn(a.g.b,c.requestId);if(!a)return null;var b=a.wb;switch(c.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete c.requestId;b.reject(new chrome.cast.Error(chrome.cast.od.SESSION_ERROR,
c.reason||c.type,c));break;default:b.resolve(c)}return a},qp=function(a,c,b){ob(cp,function(){return"App message: "+JSON.stringify(b)});if(c=kp(a.b,c)){var d;"*"==b.destinationId?d=Uo(a.b,c.sessionId):d=[b.destinationId];var e=new Qn(c.sessionId,b.namespace_,b.data);d.forEach(function(f){go(a.f,f,new $n("app_message",e))})}else cp.G("No session for incoming app message")},rp=function(a,c){a.forEach(function(b){b.sessionId=c;var d=b.supportedMediaCommands,e=[];d&1&&e.push(chrome.cast.media.xe.PAUSE);
d&2&&e.push(chrome.cast.media.xe.SEEK);d&4&&e.push(chrome.cast.media.xe.STREAM_VOLUME);d&8&&e.push(chrome.cast.media.xe.STREAM_MUTE);b.supportedMediaCommands=e});return a},gp=function(a,c,b){c=c.sessionId;b.sessionId=c;b=rp(b.status,c);sp(a.b,c,b);(a=fp(a.b,c))&&a.controller&&(a=a.controller,a.o=new Date,(b=Jo(a))?Ko(a,b):(a.j&&(a.b.title=""),a.b.can_play_pause=!1,a.b.can_seek=!1),Do(a))},tp=function(a,c){if(c=kp(a.b,c)){c=c.sessionId;var b=fp(a.b,c);b&&b.j||an(a,c)}},an=function(a,c,b){b&&Vo(a,b.clientId,
b);(b=fp(a.b,c))&&b.b.slice().forEach(function(d){hp(a.h,d,!0)});up(a.b,c);vp(a.h)},jp=function(a,c,b){ob(cp,"Receiver status for "+c);var d=b.status;if(d)if(b=a.w.ra(c)){d=Un(b,d);var e=$m(a.b,c);e?d?d.sessionId==e.session.sessionId?(c=e.session,Wn(c,d)&&(ob(cp,"Updating session "+d.sessionId),e.g&&(c.statusText=d.statusText),c.namespaces=d.namespaces,c.receiver.volume=d.receiver.volume,wp(a.h,e),Wo(a,c.sessionId,new $n("update_session",c)),e.controller&&Ho(e.controller))):(tp(a,c),zo(1),xp(a.h,
null,b,null,d)):(tp(a,c),zo(1)):d&&xp(a.h,null,b,null,d)}else Bb("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),cp.G("Got message from receiver "+c+", but sink is no longer available.")},np=function(a,c,b,d){if(c=kp(a.b,c))if(b=JSON.parse(b.data))gp(a,c,b),Wo(a,b.sessionId,new $n("v2_message",b),d)},yp=function(a,c){var b=Vn(c.b);return(c=Sb(a.j,function(d){return Qb(d.capabilities,function(e){return Ub(b,e)})}))?c.appId:oo(a)[0]},zp=function(a,c,b){var d=to(c);if(!d)return Promise.reject(Error("Invalid source "+
c));var e=yp(d,b),f=new sb("MediaRouter.Cast.Session.Launch");return Qo(a.F,new chrome.cast.Uk(e,void 0,null==d.h?chrome.cast.timeout.requestSession:d.h),b).then(function(g){cp.info("Launched session "+g.sessionId+" for appId "+e);f.end("Success");return g},function(g){cp.error("Failed to session for appId "+e);f.end("Failure");throw g;})};
To.prototype.createMediaRouteController=function(a,c,b){a=Ap(this.b,a);if(!a)return Error("Session not found for the route");var d=a.session;if(a.controller)return Error("Controller already exists for the route");var e=Bp(this,d.sessionId);if(!e)return Error("Sink not found for the route");a.controller=new Io(c,b,d,this,a.g);ip(this,d,e);return null};
var Mo=function(a,c,b){var d=Bp(a,c.sessionId);d&&a.g.sendRequest(b,d,Rl,0,"",c.transportId).catch(function(e){cp.G("Failed to send a media control request: "+e)})},Oo=function(a,c,b){b=new Rn(b);(c=Bp(a,c.sessionId))&&a.g.sendRequest(b,c,Pl).catch(function(d){cp.G("Failed to send a volume control request: "+d)})},Bp=function(a,c){return(c=Zo(a.b,c))?a.w.ra(c):null},cp=hb("mr.cast.ApiHandler");var Cp=function(a){return"0F5096E8"==a||"85CDB22F"==a};var Dp=function(a,c,b,d,e){for(var f=[],g=4;g<arguments.length;++g)f[g-4]=arguments[g];var k=this;this.j=a;this.w=c;this.Fj=b;this.f=d;this.h=f;this.b=!1;this.g=function(m){for(var p=[],v=0;v<arguments.length;++v)p[v-0]=arguments[v];return k.jq.apply(k,n(p))}};h=Dp.prototype;h.addListener=function(){this.b||(this.b=!0,this.f.addListener.apply(this.f,[this.g].concat(n(this.h))))};h.removeListener=function(){this.b&&(this.f.removeListener(this.g),this.b=!1)};
h.ih=function(a){for(var c=0;c<arguments.length;++c);return!0};h.jq=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];var d=this;Zi(this.j);if(!this.ih.apply(this,n(c)))return!1;Qi(this.Fj).then(function(e){return e.handleEvent.apply(e,[d.f].concat(n(c)))});return this.Ai()};h.Ea=function(){return"mr.EventListener."+this.w};h.kb=function(){return[this.b]};h.jb=function(){$l(this)&&this.addListener()};h.Ai=function(){};var Ep=null,Fp=null,Gp=function(){Ep||(Ep=new Dp(2,"CastChannelMessageListener","mr.cast.ChannelService",chrome.cast.channel.onMessage));Fp||(Fp=new Dp(1,"CastChannelErrorListener","mr.cast.ChannelService",chrome.cast.channel.onError));return[Ep,Fp]};var Hp=function(){},Ip=function(a){if(!a.startsWith("urn:x-org.chromium:media:route:"))return null;var c=a.substring(31);if(!c)return null;var b=c.match(/([^/]*)\/([^-/]*)-([^/]*)\/(.*)/);if(!b)return null;c=new Hp;c.f=a;a=l(b);a.next();c.b=a.next().value;c.h=a.next().value;c.j=a.next().value;c.g=a.next().value;return c};var Jp=function(a,c,b,d,e,f){this.id=a;this.presentationId=c;this.sinkId=b;this.mediaSource=d;this.isLocal=e;this.description=f;this.iconUrl=null;this.allowStop=!0;this.customControllerPath=null;this.supportsMediaRouteController=!1;this.controllerType=mojo&&mojo.RouteControllerType&&mojo.RouteControllerType.kNone;this.forDisplay=!0;this.offTheRecord=!1;this.Gf=e;this.isOffscreenPresentation=!1},Kp=function(a,c,b,d,e,f){c=d&&cj(d)?a:"urn:x-org.chromium:media:route:"+a+"/"+c+"-"+b+"/"+d;return new Jp(c,
a,b,d,e,f)};var Lp=function(a,c,b,d){b=Kp(b,"cast",c.getId(),a,d,"");b.supportsMediaRouteController=!0;mojo&&mojo.RouteControllerType&&(b.controllerType=d&&$i(a)&&c.b&1&&mojo.RouteControllerType.kMirroring?mojo.RouteControllerType.kMirroring:mojo.RouteControllerType.kGeneric);return b},Mp=function(a,c){var b=c.pb.vc;b&&(c.description=nj(b),a.displayName="",a.statusText="mirror_desktop"==b.f?"":b.g||"")};var Np=function(a,c,b,d){return{namespace_:a,data:Ja(c)?c:JSON.stringify(c),sourceId:b,destinationId:d}};var Op=function(a){this.type="CLOSE";this.reasonCode=a};var Pp=function(a){return(a=a.exec(Xd))?a[1]:""},Qp=function(){if(Xe)return Pp(/Firefox\/([0-9.]+)/);if(Be||Ce||Ae)return Ue;if(af)return te()||$d("iPad")||$d("iPod")?Pp(/CriOS\/([0-9.]+)/):Pp(/Chrome\/([0-9.]+)/);if(bf&&!(te()||$d("iPad")||$d("iPod")))return Pp(/Version\/([0-9.]+)/);if(Ye||Ze){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(Xd);if(a)return a[1]+"."+a[2]}else if($e)return(a=Pp(/Android\s+([0-9.]+)/))?a:Pp(/Version\/([0-9.]+)/);return""}(),Rp=function(a){return 0<=wd(Qp,a)};var Tp=function(a){this.type="CONNECT";this.origin={};this.userAgent=Xd;var c=this.userAgent.indexOf("(")+1;c=this.userAgent.substr(c,this.userAgent.indexOf(")",c)-1-c+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:Qp,platform:Sp(),systemVersion:c,connectionType:1};this.connType=a?0:2},Sp=function(){switch(wi()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var Up=function(a){if(!chrome.runtime.lastError)return null;var c="chrome.cast.channel.send failed, chrome.runtime.lastError: "+(chrome.runtime.lastError.message||"Unknown error");a&&ob(a,c);return Error(c)};var Vp=function(){this.b=new Lm};Vp.prototype.init=function(){cm(this)};var Wp=function(a,c,b,d,e){if(!Om(a.b,[c.channelId,b,d].join("#"))){var f=Np(Ol,new Tp(e),b,d);chrome.cast.channel.send(c,f,a.f.bind(a));a.b.set([c.channelId,b,d].join("#"),e)}};Vp.prototype.f=function(){Up(Xp)};
var Xm=function(a,c){a.b.Ab().forEach(function(b){b.split("#")[0]==c.channelId.toString()&&a.b.remove(b)})},Tm=function(a,c,b){a.b.forEach(function(d,e){var f=e.split("#");f[0]==c.channelId.toString()&&(Wp(a,b,f[1],f[2],d),a.b.remove(e))})};Vp.prototype.Ea=function(){return"cast.VirtualConnectionManager"};Vp.prototype.kb=function(){var a=Qm(this.b);return[new Yp(a)]};Vp.prototype.jb=function(){var a=$l(this);if(a)for(var c in a.b)this.b.set(c,a.b[c])};Ra(Vp);
var Xp=hb("mr.cast.VirtualConnectionManager"),Yp=function(a){this.b=a};var Zp=function(a,c){this.j=c;this.w=a;this.f=new Lm;this.b=new Lm;this.g=Vp.Ia();this.ra=null;this.h=new Lm};q(Zp,Mi);Zp.prototype.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];a==chrome.cast.channel.onMessage?this.o.apply(this,n(b)):a==chrome.cast.channel.onError&&this.l.apply(this,n(b))};Zp.prototype.init=function(){this.g.init();cm(this);Wi("mr.cast.ChannelService",this);Gp().forEach(function(a){return a.addListener()})};
var vn=function(a,c,b,d,e,f){e=e||a.w;f=f||"receiver-0";var g=cn(a,c);return g?$p(a,g,b,d,e,f):Promise.reject("Channel not found for "+c.getId())},op=function(a,c,b,d,e){if(c=a.f.get(c))a=a.g,Om(a.b,[c.channelId,b,d].join("#"))&&(a.b.remove([c.channelId,b,d].join("#")),b=Np(Ol,new Op(e?5:0),b,d),chrome.cast.channel.send(c,b,a.f.bind(a)))};
Zp.prototype.o=function(a,c){var b=this.b.get(a.channelId);if(b){var d=this.ra(b);if(d){if(Ul.hasOwnProperty(c.namespace_)){var e=JSON.parse(c.data);switch(e.type){case "CLOSE":this.g.b.remove([a.channelId,c.destinationId,c.sourceId].join("#"));return;case "RPC":break;default:ob(Sm,function(){return"Got message "+(e.type||e.responseType)+" "+("from "+d.getId())})}}else ob(Sm,"Got message in "+c.namespace_+" from "+d.getId());aq(this.j,d,c)}else Sm.G("Got message for unknown receiver (receiverId="+
b+").")}else Sm.G("Got message for unknown channel (channelId="+a.channelId+").")};var bq=function(a,c){var b=a.b.get(c.channelId);b&&(a.b.remove(c.channelId),a.f.remove(b))};Zp.prototype.l=function(a,c){Sm.G(function(){return"Channel error: "+JSON.stringify(a)+(c?", "+JSON.stringify(c):"")});bq(this,a)};
var cn=function(a,c){c=c.getId();(a=a.f.get(c))||Sm.info("Channel not found for receiver: "+c);return a},$p=function(a,c,b,d,e,f){Wp(a.g,c,e,f,0==f.indexOf("receiver-0"));Xn(d);var g=Np(b,d,e,f);"object"===typeof d&&"RPC"==d.type||ob(Sm,function(){return"Channel is sending message: "+JSON.stringify(g)});return new Promise(function(k,m){chrome.cast.channel.send(c,g,function(p){p?p.errorState?(m(Error("Failed to send message")),bq(a,p)):k(!0):(p=Up(Sm||void 0),m(p))})})};Zp.prototype.Ea=function(){return"cast.ChannelService"};
Zp.prototype.kb=function(){return[new cq(Qm(this.f),Qm(this.b),Qm(this.h))]};Zp.prototype.jb=function(){var a=$l(this);a&&(Km(this.f,a.f),Km(this.b,a.b),Km(this.h,a.g))};var Sm=hb("mr.cast.ChannelService"),cq=function(a,c,b){this.f=a;this.b=c;this.g=b};var dq=function(a,c,b,d,e,f){this.routeId=a;this.clientId=c;this.appIds=b;this.autoJoinPolicy=d;this.origin=e;this.tabId=f;this.f=this.b=!1},eq=function(){this.b=[]};eq.prototype.init=function(){cm(this)};eq.prototype.sa=function(){return this.b.length};var bo=function(a,c){return Sb(a.b,function(b){return b.clientId==c})},fq=function(a,c){return Sb(a.b,function(b){return b.routeId==c})},gq=function(a,c){a.b=Mb(a.b,function(b){return b.clientId!=c})};eq.prototype.Ea=function(){return"cast.ClientRecords"};
eq.prototype.kb=function(){return[new hq(this.b)]};eq.prototype.jb=function(){var a=$l(this);a&&(this.b=a.b)};var hq=function(a){this.b=a};var iq=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var jq=function(a,c){this.h=a;this.f=c;this.g=new Hn;this.b=new Lm};jq.prototype.init=function(){cm(this)};var kq=function(a,c){var b=a.b.get(c);b&&(b.Wj--,0<b.Wj||(Hm(a.f.b.Sb(!1),function(d){switch(Dm(d,c)){case "available":d.kc[c]="available_rescan";break;case "unavailable":d.kc[c]="unavailable_rescan"}}),a.b.remove(c)))};h=jq.prototype;
h.Bm=function(a){var c=this;Hm(this.b.Sb(!0),function(b){a:{switch(Dm(a,b)){case "unknown":case "available_rescan":case "unavailable_rescan":var d=!0;break a}d=!1}if(d){var e=a.getId()+":"+b;c.g.contains(e)||(c.g.add(e),d=function(){c.g.remove(e)},(new df(c.Xp.bind(c,a,b),5500,3)).start().then(c.Fn.bind(c,a,b),function(){c.m.error("Failed to get app availability response for "+a.getId()+", appId "+b+" after 3 attempts.");c.Fn(a,b,"unknown")}).then(d,d))}})};
h.Fn=function(a,c,b){b!=Dm(a,c)&&(this.m.info(c+" on "+a.getId()+" is "+b),a.kc[c]=b,Vm(this.f.h,a))};
h.Xp=function(a,c){var b=this,d=new iq;d.appId=[c];var e=new sb("MediaRouter.Cast.App.Availability");return this.h.sendRequest(d,a,Pl,5E3).then(function(f){e.end("Success");ob(b.m,function(){return"App availability response "+JSON.stringify(f)});for(var g in f.availability){if("APP_AVAILABLE"==f.availability[g])return"available";if("APP_UNAVAILABLE"==f.availability[g])return"unavailable"}return"unknown"},function(f){e.end("Failure");b.m.error("checkAppAvailability_ failed for "+a.getId()+", appId "+
c);throw f;})};h.Ea=function(){return"cast.AppDiscoveryService"};h.kb=function(){return[new lq(Qm(this.b))]};h.jb=function(){var a=$l(this);a&&Km(this.b,a.b)};h.m=hb("mr.cast.AppDiscoveryService");var lq=function(a){this.b=a};var mq=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var nq=function(a,c){this.f=[];this.b=[];this.sinkId=a;this.session=c;this.w=this.h=null;this.offTheRecord=this.j=!1;this.controller=null;this.g=!0},oq=function(){this.m=hb("mr.cast.SessionRecords");this.b=[]};oq.prototype.init=function(){cm(this)};
var up=function(a,c){a.m.info("Removing session "+c);Lo(a,c);a.b=Mb(a.b,function(b){return b.session.sessionId!=c})},Uo=function(a,c){return(a=fp(a,c))?a.f:[]},kp=function(a,c){return(a=$m(a,c))?a.session:null},pq=function(a,c){return Sb(a.b,function(b){return Ub(b.f,c)})},Ap=function(a,c){return Sb(a.b,function(b){return Ub(b.b,c)})},qq=function(a,c){return Sb(a.b,function(b){return null!=Sb(b.b,function(d){return Ip(d).b==c})})},$m=function(a,c){return Sb(a.b,function(b){return b.sinkId==c||b.h==
c})},fp=function(a,c){return Sb(a.b,function(b){return b.session.sessionId==c})},Zo=function(a,c){return(a=fp(a,c))?a.sinkId:null},Yo=function(a,c){return(a=fp(a,c))?a.session:null},sp=function(a,c,b){var d=Yo(a,c);d&&(a=Mb(b,function(e){return e.playerState!=chrome.cast.media.PlayerState.IDLE}),a.forEach(function(e){if(!e.media){var f=Sb(d.media,function(g){return g.mediaSessionId==e.mediaSessionId});f&&(e.media=f.media)}}),d.media=a)};oq.prototype.Ea=function(){return"cast.SessionRecords"};
oq.prototype.kb=function(){return[new rq(this.b)]};oq.prototype.jb=function(){var a=$l(this);if(a)for(var c=0;c<a.b.length;c++){var b=a.b[c],d=new nq(b.sinkId,b.session);d.f=b.f;d.b=b.b;d.j=b.j;d.w=b.w;d.h=b.h;d.g=b.g;this.b.push(d)}};
var Lo=function(a,c){(a=fp(a,c))&&a.controller&&(a.controller.ab(),a.controller=null)},rq=function(a){var c=[];a=l(a);for(var b=a.next();!b.done;b=a.next()){b=b.value;var d=new nq(b.sinkId,b.session);d.f=b.f;d.b=b.b;d.j=b.j;d.w=b.w;d.h=b.h;d.offTheRecord=b.offTheRecord;d.g=b.g;c.push(d)}this.b=c};var sq=function(a,c,b){var d=Error.call(this);this.message=d.message;"stack"in d&&(this.stack=d.stack);this.name="RouteRequestError";this.message=c||"";if(b)this.stack=b;else if(Error.captureStackTrace)Error.captureStackTrace(this,sq);else if(c=Error().stack)this.stack=c;this.errorCode=a};q(sq,Error);var tq=function(a,c){this.sinks=a;this.origins=c||null},uq=new tq([]);var vq=function(a){this.D="sender-"+re();this.f=new Lm;this.o=null;cm(this);this.g=a;this.l=new eq;this.h=new oq;this.s=new Zp(this.D,this);this.b=new Rm(this.s,this);this.C=new sn(this.s,this.D);this.w=null;this.j=new To(this.C,this.b,this.l,this.h,this.s,this);this.F=new Ln(this.b,this.C)};h=vq.prototype;h.getName=function(){return"cast"};
h.initialize=function(a){a=a&&"boolean"===typeof a.enable_cast_sink_query?a.enable_cast_sink_query:!0;this.m.info("Query enabled: "+a);this.C.init();this.h.init();this.j.init();this.s.init();this.b.init();a&&(this.w=new jq(this.C,this.b),this.w.init())};h.Dd=function(){return this.f.oa()};
h.Dg=function(a){var c=this;if(null!=wq(a))return new tq([]);var b=new Hn;xq(a).forEach(function(d){en(c.b,d).map(function(e){return e.f}).forEach(function(e){b.add(e)})});return new tq(b.oa(),-1!=a.indexOf("0F5096E8")?dj:null)};
h.startObservingMediaSinks=function(a){var c=this,b=wq(a);b?(this.m.info("Received broadcast request "+a),Hm(this.b.b.Sb(!1),function(d){c.C.sendMessage(b,d,Tl).catch(function(e){c.m.error("Broadcast failed "+e.message)})})):this.w&&xq(a).forEach(function(d){var e=c.w,f=e.b.get(d);f?f.Wj++:e.b.set(d,{Wj:1});e.m.info("Scanning sinks for app availability");Hm(e.f.b.Sb(!1),e.Bm,e)})};h.stopObservingMediaSinks=function(a){var c=this;null!=wq(a)||this.w&&xq(a).forEach(function(b){kq(c.w,b)})};
h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.ra=function(a){return(a=this.b.ra(a))?a.f:null};
var yq=function(a,c,b){a.m.error("Error launching.",b);hp(a,c.id,!1,!0,"error");b=new hi(mq,"warning");li(b,c.id);mi(b,c.sinkId);a.g.cf(b)},Bq=function(a,c,b,d,e,f,g,k){wm().f=new tm(b.Cc,b.Zb());var m=Lp(c,b,d,!0);m.forDisplay=!1;m.offTheRecord=e;a.f.set(m.id,m);a.g.Yf(a,m);vp(a);(e=to(c))&&e.b&&zq(a,e,m.id,g,k);return new Promise(function(p,v){bj(c)||cj(c)?(m.pb={tabId:k,sessionId:"",eg:b.Zb()||"",me:b.Cc||"",kt:b.f.friendlyName||""},cj(c)&&(m.isOffscreenPresentation=!0),a.g.sj(a,m,d,function(A){return ri(Aq(a,
c,b,d,f,g,k,A))}).b.then(function(){var A=Ap(a.h,m.id);A.g=!1;Mp(A.session,m);A.controller&&(A.controller.j=!1,Ho(A.controller));p(m)},function(A){yq(a,m,A);v(A)})):Aq(a,c,b,d,f,g,k,m).then(function(){p(m)},function(A){yq(a,m,A);v(A)})})},Aq=function(a,c,b,d,e,f,g,k){return zp(a.j,Cq(c,b,e),b).then(function(m){xp(a,c,b,d,m,f,g,k);return k})};
vq.prototype.createRoute=function(a,c,b,d,e,f,g){var k=this,m=this.b.ra(c);if(!m)return qi(Error("No sink with ID "+c));var p=uo(a);if(p){setTimeout(function(){Xo(k.j,p,m,chrome.cast.mg.CAST)},0);var v=function(){return Bq(k,a,m,b,d,e,f,g)},A=bo(this.l,p);if(A)return ri(this.terminateRoute(A.routeId).then(v,v));if(f&&g&&(c=Dq(this,a,f,g,d,e,c)))return c}return ri(Bq(this,a,m,b,d,e,f,g))};
var hp=function(a,c,b,d,e){d=void 0===d?!1:d;e=void 0===e?"closed":e;a.m.info("Remove route "+c);var f=fq(a.l,c);if(f){b=b||f.f;var g=f.clientId;a.m.info("Remove client "+g);for(var k=a.h,m=0;m<k.b.length;m++)ac(k.b[m].f,g);gq(a.l,g)}if(g=Ap(a.h,c))ac(g.b,c),Eq(a,g.b);if(k=a.f.get(c))if(k.Gf&&g&&(op(a.s,k.sinkId,f?f.clientId:a.D,g.session.transportId,b),k.forDisplay&&f&&(a.o={Ef:f,rn:g})),a.f.remove(c),a.g.Kg(k),vp(a),d)a.g.onPresentationConnectionClosed(c,e,"Remove route");else a.g.onPresentationConnectionStateChanged(c,
"terminated")},wp=function(a,c){c.b.forEach(function(b){if(b=a.f.get(b)){var d=c.session;if(b.forDisplay){var e=Cp(d.appId);e&&!b.isLocal?(b.description=d.statusText||"",d.displayName="",d.statusText=""):e||(b.description=d.statusText||d.displayName);c.controller&&Ho(c.controller)}a.g.bf(b)}})},Fq=function(a,c){Pb(c,function(b){b=a.f.get(b,null);if(!b||!b.mediaSource)return!1;var d=to(b.mediaSource);d=d?d.o:!1;return b.isLocal&&!d})&&y(c,function(b){if(b=a.f.get(b,null))b.isLocal=!0})},Eq=function(a,
c){var b=[],d=[],e=null;c.forEach(function(f){if(f=a.f.get(f)){f.forDisplay=!1;var g=to(f.mediaSource);g&&Sb(oo(g),Zn)||(f.Gf?(g=g?po(g):null,e||g==chrome.cast.kd.CUSTOM_CONTROLLER_SCOPED||(b.push(f),e=f.sinkId)):e&&e!=f.sinkId?b.push(f):d.push(f))}});y(0<b.length?b:d,function(f){f.forDisplay=!0})},zq=function(a,c,b,d,e){var f=c.b;if(f&&!bo(a.l,f)){a.m.info("Add client "+f);var g=oo(c);a.l.b.push(new dq(b,f,g,po(c),d||null,Ia(e)?e:null))}},xp=function(a,c,b,d,e,f,g,k){var m=$m(a.h,b.getId());if(!m){var p=
a.h;m=b.getId();p.m.info("Adding new session: "+m+", "+e.sessionId);var v=fp(p,e.sessionId);v?(Tn(e)?(v.w=e,v.h=m):Tn(v.session)&&(v.w=v.session,v.h=v.sinkId,v.session=e,v.sinkId=m),m=v):(m=new nq(m,e),p.b.push(m))}k&&k.isLocal&&k.pb&&(m.g=!1);var A=null!=c;if(!A&&Zn(e.appId))return null;null==c?(v=new ko([{appId:e.appId,capabilities:e.capabilities}]),c=qo(v)[0]):v=to(c);if(p=k){if(!a.f.get(p.id))return a.m.G("Route "+p.id+" not added"),p}else p=Lp(c,b,d||e.sessionId,A),a.f.set(p.id,p);d=p.id;a.m.info("Add route "+
d);c=null;v&&(c=v.b,zq(a,v,d,f,g));Ub(m.b,d)||m.b.push(d);p.Gf&&(f=a.s,g=c||a.D,d=e.transportId,v=!(v&&v.o),(A=cn(f,b))&&Wp(f.g,A,g,d,v));m.offTheRecord=p.offTheRecord;f=m.b;Fq(a,f);Eq(a,f);f=p;g=e.sessionId;Cp(e.appId)?f.isLocal&&g&&f.pb?f.pb.sessionId=g:(f.description=e.statusText||"",e.displayName="",e.statusText=""):f.description=e.statusText||e.displayName;k?a.g.bf(p):a.g.Yf(a,p);vp(a);if(k=c)Ub(m.f,c)?k=!1:(m.f.push(c),k=!0);k&&(a=a.j,go(a.f,c,new $n("new_session",e)),ip(a,e,b));return p};
vq.prototype.terminateRoute=function(a){var c=this,b=this.f.get(a);if(!b)return Promise.reject(new sq(3,"Route in Cast provider not found for routeId  "+a));var d=Ap(this.h,a);if(!d)return hp(this,a,!0),Promise.resolve();var e=d.session.sessionId,f=this.b.ra(b.sinkId);if(!f)return an(this.j,e),Promise.resolve();(a=fq(this.l,a))&&Xo(this.j,a.clientId,f,chrome.cast.mg.STOP);zo(0);return new Promise(function(g){var k=function(){tp(c.j,f.getId());g()};c.C.sendRequest(new pn(e),f,Pl).then(k,k)})};
var Gq=function(a,c){var b=null;Im(a.f.Sb(!1),function(f){if(!f.Gf)return!1;var g=a.b.ra(f.sinkId);if(!g||!so(c,Cq(f.mediaSource,g)))return!1;b=f;return!0});if(!b||!b.mediaSource)return null;var d=uo(b.mediaSource);if(!d)return null;var e=bo(a.l,d);return e?(d=pq(a.h,d))?{Ef:e,rn:d}:null:null},Dq=function(a,c,b,d,e,f,g){var k=null;Im(a.f.Sb(!1),function(p){var v=p.pb;return v&&null!=v.tabId&&v.tabId==d&&$i(p.mediaSource)?(k=p,!0):!1});if(!k)return null;var m=function(){return a.createRoute(c,g||k.sinkId,
"",e,f,b,null==d?void 0:d)};return ri(a.terminateRoute(k.id).then(m,m))};h=vq.prototype;h.connectRouteByRouteId=function(a,c,b,d,e){if(!to(a))return qi(Error("Unsupported presentation URL"));if(!c)return qi(Error("No routeId"));c=Ip(c);c=fp(this.h,c.b);if(!c)return qi(Error("No matching route"));var f=this.b.ra(c.sinkId);return f?(a=xp(this,a,f,b,c.session,d,e))?pi(a):qi(Error("Failed to create route")):qi(Error("No sink"))};
h.joinRoute=function(a,c,b,d,e,f){var g=to(a);if(!g)return qi(Error("Unsupported presentation URL"));if(c==chrome.cast.wk){a:{var k=Gq(this,g);if(!k){if(!this.o||this.o.Ef.origin!=e||this.o.Ef.tabId!=f){k=null;break a}k=this.o}switch(po(g)){case chrome.cast.kd.PAGE_SCOPED:k=null;break a;case chrome.cast.kd.ORIGIN_SCOPED:if(e!=k.Ef.origin){k=null;break a}break;case chrome.cast.kd.TAB_AND_ORIGIN_SCOPED:if(e!=k.Ef.origin||f!=k.Ef.tabId){k=null;break a}}k=fp(this.h,k.rn.session.sessionId)}if(!k&&(g.g?
g.g:chrome.cast.oh.CREATE_SESSION)!=chrome.cast.oh.CAST_THIS_TAB&&(d=Dq(this,a,e,f,b,d)))return d}else k=Hq(this,c);if(!k)return qi(Error("No matching route"));if(k.offTheRecord!=b)return qi(Error("Off the record mismatch"));d=this.b.ra(k.sinkId);if(!d)return qi(Error("No sink"));a=xp(this,a,d,c,k.session,e,f);a.offTheRecord=b;return pi(a)};h.detachRoute=function(a){hp(this,a,!1,!0)};
h.Kf=function(a){var c=this.b.ra(a);if(!c)throw Error("Cannot mirror with no sink.");var b=new uj;c=c.b;c&1||(b.shouldCaptureVideo=!1);c&4||(b.shouldCaptureAudio=!1);b.shouldCaptureAudio&&!b.shouldCaptureVideo&&(b.minLatencyMillis=b.maxLatencyMillis,b.animatedLatencyMillis=b.maxLatencyMillis);b.senderSideLetterboxing=!0;vj(b);Object.freeze(b);this.m.info(function(){return"Settings for "+a+": "+tj(b)});if(!b.shouldCaptureAudio&&!b.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture");
return b};h.Ye=function(){return"cast_streaming"};h.Th=function(a){var c=this.f.get(a);c&&c.pb&&c.pb.vc&&(a=Ap(this.h,a))&&(Mp(a.session,c),a.controller&&Ho(a.controller))};
h.sendRouteMessage=function(a,c,b){var d=this;if(!b)return new Promise(function(k,m){"string"!==typeof c&&m(Error("Cannot send non-string messages via ApiHandler."));m=d.j.f;ob(eo,"Received: "+c);var p=JSON.parse(c),v=p.clientId;"client_connect"==p.type?(ob(eo,"App "+v),(p=bo(m.b,v))?(p.b=!0,(m=mn(m.f,p.routeId))&&m.wb.resolve(!0)):eo.G("Client not found "+v)):co(m,v)?(m=m.g[p.type])&&m(p):eo.G("No route for "+v);k()});var e=Ap(this.h,a);if(!e)return Promise.reject(Error("Not managing the route "+
a));var f=this.b.ra(e.sinkId);if(!f)return Promise.reject(Error("Sink no longer accessible"));var g=(a=fq(this.l,a))?a.clientId:this.D;return new Promise(function(k){vn(d.s,f,b.namespace,c,g,e.session.transportId).then(k,k)})};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};h.wg=function(a,c){var b=this.b.ra(c);if(!b)return!1;if(!this.w)return!0;a=Cq(a,b);return(a=ro(a))&&0!=a.length?Pb(a,function(d){return Vl(Dm(b,d))}):!1};
h.Df=function(a,c,b){var d=xq(a);return d&&0!=d.length?c==chrome.cast.wk?!0:b&&b.mediaSource?(a=ro(b.mediaSource),Pb(a,function(e){return Ub(d,e)})):void 0==c||Hq(this,c)?!0:!1:!1};
var Cq=function(a,c,b){return to(a)?a:bj(a)||cj(a)?(a={appId:0==(c.b&1)?"85CDB22F":"0F5096E8",capabilities:Vn(c.b)},qo(new ko([a],void 0,void 0,void 0,b))[0]):a},xq=function(a){var c=[],b=to(a);if(b)c=oo(b);else if(bj(a)||cj(a))aj(a)||c.push("85CDB22F"),c.push("0F5096E8");return c},wq=function(a){var c=to(a);if(!c)return null;a=xq(a);var b=c.l||"";c=c.w;return b&&c?new nn(a,b,JSON.stringify(c)):null},Hq=function(a,c){return 0==c.indexOf(chrome.cast.Qk)?fp(a.h,c.substr(chrome.cast.Qk.length)):qq(a.h,
c)},aq=function(a,c,b){var d=a.F;if(Mn(d)&&Ul.hasOwnProperty(b.namespace_)){var e=c.Zb();if(e){var f=JSON.parse(b.data);if("RECEIVER_STATUS"===f.type){var g=f.status&&f.status.applications&&f.status.applications[0],k=f=null;g&&(g.appId&&(f=g.appId),g.sessionId&&(k=g.sessionId));g=d.f.get(e);d.f.set(e,new Ll(e,f,k));g&&g.appId===f||Nn(d)}}}a=a.j;c=c.getId();Ul.hasOwnProperty(b.namespace_)?pp(a,c,b):qp(a,c,b)},Vm=function(a,c){a.w&&a.w.Bm(c);bn(a.F);a.g.ed()};h=vq.prototype;h.Ea=function(){return"cast.Provider"};
h.kb=function(){return[new Iq(this.D,Qm(this.f),this.o)]};h.jb=function(){var a=$l(this);a&&(this.D=a.g,Km(this.f,a.f),this.o=a.b)};h.searchSinks=function(){return eb()};h.createMediaRouteController=function(a,c,b){return(a=this.j.createMediaRouteController(a,c,b))?Promise.reject(a):Promise.resolve()};h.provideSinks=function(a){Zm(this.b,a)};var vp=function(a){var c=a.Dd().some(function(b){return b.isLocal});a.g.ag(a.Ea(),c)};vq.prototype.m=hb("mr.CastProvider");
var Iq=function(a,c,b){this.g=a;this.f=c;this.b=b};var Jq=function(){this.b=[]};Jq.prototype.listen=function(a,c,b){this.b.push({type:a,Tc:c,target:b})};var Kq=function(a,c,b){var d=a.b.findIndex(function(e){return"internal_message"==e.type&&e.Tc==c&&e.target==b});-1!=d&&a.b.splice(d,1)},Lq=function(a,c){a.b.forEach(function(b){b.type==c.type&&Promise.resolve().then(function(){return b.Tc.call(b.target,c)})})};var Mq={SUCCESS:0,Vo:1,Rt:2,St:3,gA:4,dz:5},Nq={SUCCESS:0,ez:1,Vo:2,Hz:3},Oq={SUCCESS:0,by:1,kw:2},Pq=function(a){Cb("MediaRouter.Dial.CreateRoute",a,Mq)},Qq=function(a){Cb("MediaRouter.Dial.TerminateRoute",a,Nq)},Rq=function(a){Cb("MediaRouter.Dial.ParseMessage",a,Oq)};var Sq=function(a,c,b,d){c="["+c+"]: "+b+" "+d.responseURL+" => "+d.status+" ("+d.statusText+")";200<=d.status&&299>=d.status?a.info(c):ob(a,c)};var Tq=function(){this.name="unknown";this.state="error";this.b=null;this.allowStop=!0;this.resource=null;this.extraData={}},Uq=function(){var a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};q(Uq,Error);var Wq=function(a){if(void 0===c){Vq||(Vq=new ff(10,2E3));var c=Vq}this.f=a;this.b=c;this.m=hb("mr.dial.Client")};
Wq.prototype.launchApp=function(a,c){var b=this;return this.b.send(Xq(this,a),"POST",c,{timeoutMillis:15E3}).then(function(d){return Yq(b,"launchApp","POST",d)})};
var $q=function(a,c){return Zq(a,c).then(function(b){return b.resource?b.resource:(a.m.G("stopApp: Resource path for not available for app "+c+": using fallback path."),"run")},function(){a.m.G("stopApp: getAppInfo failed: using fallback path.");return"run"}).then(function(b){return a.b.send(Xq(a,c)+"/"+b,"DELETE")}).then(function(b){return Yq(a,"stopApp","DELETE",b)})},Zq=function(a,c){return a.b.send(Xq(a,c),"GET",void 0,{Fm:3}).then(function(b){Sq(a.m,"GetAppInfo","GET",b);if(!(200<=b.status&&
299>=b.status)){if(404==b.status)throw new Uq;throw Error("Response error: "+b.status);}b=b.responseText;b=(new DOMParser).parseFromString(b,"text/xml");b=b.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length?null:b;if(!b)throw a.m.info("Invalid or empty response"),Error("Invalid or empty response");var d=b.getElementsByTagName("service");if(!d||1!=d.length)throw a.m.info("Invalid GET response (invalid service)"),Error("Invalid GET response (invalid service)");b=new Tq;for(var e=
0,f=d[0].childNodes.length;e<f;e++){var g=d[0].childNodes[e];if("state"==g.nodeName){a:switch(g.textContent){case "running":g="running";break a;case "stopped":g="stopped";break a;default:g="error"}b.state=g}else"name"==g.nodeName?b.name=g.textContent:"link"==g.localName?b.resource=g.getAttribute("href"):"options"==g.nodeName?b.allowStop="false"!=g.getAttribute("allowStop"):b.extraData[g.nodeName]=g.innerHTML}if("unknown"==b.name)throw a.m.info("GET response missing name value"),Error("GET response missing name value");
if(b.name!=c)throw a.m.info("GET app name mismatch"),Error("GET app name mismatch");if("error"==b.state)throw a.m.info("GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(b.state))&&d[1])b.state="installable",b.b=d[1];else if("running"!=b.state&&"stopped"!=b.state)throw a.m.info("GET response has invalid state value"),Error("GET response has invalid state value");return b})},Xq=function(a,c){a=a.f.Vd;"/"!=a.charAt(a.length-1)&&(a+="/");return a+
c},Yq=function(a,c,b,d){return new Promise(function(e,f){Sq(a.m,c,b,d);200<=d.status&&299>=d.status?e():f(Error(d.statusText))})},Vq=null;var ar=function(a,c){this.Jc=a;this.appName=c};var br=function(a){this.b=new Map;this.f=a};br.prototype.init=function(){cm(this)};br.prototype.clear=function(){this.b.clear()};br.prototype.add=function(a){if(!this.b.get(a.Jc.id)){this.b.set(a.Jc.id,a);var c=this.f;cr(c);c.h.Yf(c,a.Jc)}};var dr=function(a,c){a=l(a.b);for(var b=a.next();!b.done;b=a.next())if(b=l(b.value),b.next(),b=b.next().value,b.Jc.sinkId==c)return b;return null},fr=function(a,c){var b=a.b.get(c);b&&(a.b.delete(c),er(a.f,b))};
br.prototype.Dd=function(){return Array.from(this.b.values(),function(a){return a.Jc})};br.prototype.Ea=function(){return"dial.ActivityRecords"};br.prototype.kb=function(){return[Array.from(this.b)]};br.prototype.jb=function(){var a=$l(this);a&&(this.b=new Map(a))};var gr=function(a){this.g=a;this.m=hb("mr.dial.SinkDiscoveryService");this.b=new Map;this.f={ug:0,Gg:0};this.h=0};gr.prototype.init=function(){cm(this)};
var jr=function(a,c){a.m.info("addSinks returned "+c.length+" sinks");ob(a.m,function(){return"....the list is: "+JSON.stringify(c)});var b=new Set(a.b.keys());c.forEach(function(f){var g=f.sink_id,k=f.extra_data.dial_media_sink,m=hr.test(k.model_name);f=new zm(f.name,g);f.pc=k.ip_address.address_bytes?k.ip_address.address_bytes.join("."):k.ip_address.address.join(".");f.Vd=k.app_url.url;f.Cc=k.model_name;f.He=!m;ir(a,f);b.delete(f.getId())});var d=[];b.forEach(function(f){var g=a.b.get(f);d.push(g);
a.b.delete(f)});0<d.length&&a.g.pj(d);var e=a.b.size;a.f={ug:e,Gg:e}},ir=function(a,c){ob(a.m,"mayAddSink, id = "+c.getId());var b=a.b.get(c.getId());b?b.update(c)&&(ob(a.m,"Updated sink "+b.getId()),a.g.Nh(b)):(ob(a.m,function(){return"Adding new sink "+c.getId()+": "+("name = "+c.Dc.friendlyName+(c.pc?", ip = "+c.pc:"")+(c.Cc?", model = "+c.Cc:"")+", apps = "+JSON.stringify(c.kc))}),a.b.set(c.getId(),c),a.g.oj(c))};gr.prototype.ra=function(a){return this.b.get(a)||null};
var lr=function(a,c){var b=[];a.b.forEach(function(d){"available"==Am(d,c)&&b.push(d.Dc)});return new tq(b,kr[c])};gr.prototype.Xe=function(){return this.f};gr.prototype.Ea=function(){return"dial.DialSinkDiscoveryService"};gr.prototype.kb=function(){return[new nr(Array.from(this.b),this.f),{deviceCountMetricsRecordTime:this.h}]};
gr.prototype.jb=function(){var a=$l(this);if(a){for(var c=l(a.sinks),b=c.next();!b.done;b=c.next())b=b.value,this.b.set(b[0],Bm(b[1]));this.f=a.deviceCounts}if(a=am(this))this.h=a.deviceCountMetricsRecordTime};
var kr={YouTube:"https://tv.youtube.com https://tv-green-qa.youtube.com https://tv-release-qa.youtube.com https://web-green-qa.youtube.com https://web-release-qa.youtube.com https://www.youtube.com".split(" "),Netflix:["https://www.netflix.com"],Pandora:["https://www.pandora.com"],Radio:["https://www.pandora.com"],Hulu:["https://www.hulu.com"],Vimeo:["https://www.vimeo.com"],Dailymotion:["https://www.dailymotion.com"],"com.dailymotion":["https://www.dailymotion.com"]},hr=/Eureka Dongle|Chromecast Audio|Chromecast Ultra/i,
nr=function(a,c){this.sinks=a;this.deviceCounts=c};var or=function(a){return Promise.all(a.map(function(c){return c.then(function(b){return{ce:!0,value:b}},function(b){return{ce:!1,reason:b}})}))};var pr=function(a,c){this.m=hb("mr.dial.AppDiscoveryService");this.b=new Set;this.f=a;this.w=c;this.j=new Map;this.l=new Map;this.g=null;this.h=!1};pr.prototype.init=function(){cm(this)};pr.prototype.start=function(){this.m.info("Starting periodic scanning.");this.h||(this.h=!0,qr(this))};pr.prototype.stop=function(){this.m.info("Stopping periodic scanning.");this.h&&(this.h=!1,this.g&&(clearTimeout(this.g),this.g=null),this.j.clear())};
var qr=function(a){a.m.info("Start app status scan.");var c=[];Array.from(a.f.b.values()).forEach(function(b){c.push.apply(c,rr(a,b))});Array.from(a.w.b.values()).forEach(function(b){c.push(sr(a,b))});or(c).then(function(){a.h&&!a.g&&(ob(a.m,"Scan complete; scheduling for next scan."),a.g=setTimeout(function(){ob(a.m,"Start app status scan (timer-based)");a.g=null;qr(a)},6E4))})},rr=function(a,c){if(!c.He)return[];for(var b=[],d=l(a.b),e=d.next();!e.done;e=d.next())b.push(a.o(e.value,c));return b};
pr.prototype.o=function(a,c){var b=this;if("unknown"!=Am(c,a)&&36E5>Date.now()-(c.Kh[a]||0)||!c.He)return Promise.resolve();ob(this.m,"Querying "+c.getId()+" for "+a+" to update app status");return tr(this,c,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}ur(b,c,a,d)},function(d){d instanceof
Uq?ur(b,c,a,"unavailable"):(b.m.G("Failed to process app availability; "+c.getId()+" does not support app availability"),c.He=!1)})};
var sr=function(a,c){var b=a.f.ra(c.Jc.sinkId);if(!b)return a.m.G("Activity refers to nonexistent sink: "+c.Jc.id),Promise.resolve();if(!b.He)return Promise.resolve();var d=c.appName;ob(a.m,"Querying "+b.getId()+" for "+d+" to update activity");return tr(a,b,d).then(function(e){"running"!=e.state&&vr(a,b,d)},function(){return vr(a,b,d)})},wr=function(a,c){var b=a.l.get(c.getId());b||(b=new Wq(c),ob(a.m,"Created DIAL client for "+c.getId()),a.l.set(c.getId(),b));return b},tr=function(a,c,b){var d=
xr(c,b),e=a.j.get(d);if(e)return e;e=Zq(wr(a,c),b);a.j.set(d,e);c=function(){a.j.delete(d)};e.then(c,c);return e},xr=function(a,c){return a.getId()+":"+c},ur=function(a,c,b,d){ob(a.m,"Got app status "+d+" from "+c.getId()+" for "+b);var e=Am(c,b);c.kc[b]=d;c.Kh[b]=Date.now();d!=e&&a.f.g.Nh(c)},vr=function(a,c,b){(c=dr(a.w,c.getId()))&&c.appName==b&&fr(a.w,c.Jc.id)},yr=function(a,c){return Array.from(a.f.b.values()).some(function(b){return"unknown"==Am(b,c)})};pr.prototype.Ea=function(){return"dial.AppDiscoveryService"};
pr.prototype.kb=function(){return[Array.from(this.b)]};pr.prototype.jb=function(){var a=$l(this);this.b=new Set(a||[])};var zr=function(a,c){this.appName=a;this.launchParameter=void 0===c?"":c},Cr=function(a){try{var c=new URL(a)}catch(b){return Ar.info("Invalid URL: "+a),null}switch(c.protocol){case "dial:":a:if(a=c.pathname,a.match(/^\w+$/)){if(c=c.searchParams.get("postData")||void 0)try{c=om(c)}catch(b){Ar.G("Invalid base64 encoded postData:"+c);a=null;break a}a=new zr(a,c)}else Ar.G("Invalid app name: "+a),a=null;return a;case "https:":return Br(c);default:return ob(Ar,"Unhandled protocol: "+c.protocol),null}},
Br=function(a){var c=a.hash;if(!c)return null;a=(a=Dr.exec(c))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(c=(c=Er.exec(c))?c[1]:void 0)try{c=om(c)}catch(b){return Ar.G("Invalid base64 encoded postData:"+c),null}return new zr(a,c)},Ar=hb("mr.dial.PresentationUrl"),Dr=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,Er=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var Fr=function(a,c){this.h=a;this.f=c||new gr(this);this.g=new br(this);this.b=null;this.m=hb("mr.DialProvider")};h=Fr.prototype;h.getName=function(){return"dial"};h.Xe=function(){return this.f.Xe()};h.initialize=function(a){a=a&&0==a.enable_dial_sink_query?!1:!0;this.m.info("Dial sink query enabled: "+a+"...");this.g.init();this.f.init();a?(this.b=this.b||new pr(this.f,this.g),this.b.init()):this.b=null;cr(this)};
h.Dg=function(a){if(!this.b)return uq;ob(this.m,"GetAvailableSinks for "+a);return(a=Cr(a))?lr(this.f,a.appName):uq};h.startObservingMediaSinks=function(a){if(this.b){var c=Cr(a);if(c){a=this.b;c=c.appName;if(!a.b.has(c)||yr(a,c))a.b.add(c),0!=a.f.b.size&&(a.h?Array.from(a.f.b.values()).forEach(a.o.bind(a,c)):a.start());cr(this)}}};h.stopObservingMediaSinks=function(a){this.b&&(a=Cr(a))&&(this.b.b.delete(a.appName),Gr(this))};h.startObservingMediaRoutes=function(){cr(this)};
h.stopObservingMediaRoutes=function(){Gr(this)};var Gr=function(a){a.b&&(0==a.f.b.size||0==a.b.b.size&&0==a.g.b.size)&&a.b.stop()},cr=function(a){a.b&&0<a.f.b.size&&(0<a.b.b.size||0<a.g.b.size)&&a.b.start()};h=Fr.prototype;h.ra=function(a){return(a=this.f.ra(a))?a.Dc:null};h.Dd=function(){return this.g.Dd()};
h.createRoute=function(a,c,b,d){var e=this,f=this.f.ra(c);if(!f)return Pq(1),qi(Error("Unkown sink: "+c));wm().f=new tm(f.Cc,f.Zb());var g=Cr(a);if(!g)return Pq(4),qi(Error("No app name set."));var k=g.appName,m=new Wq(f);return ri(Zq(m,k).then(function(p){if("running"==p.state)return $q(m,k)}).then(function(){return m.launchApp(k,g.launchParameter)}).then(function(){return Hr(e,c,a,k,b,d)}).catch(function(p){Pq(3);throw p;}))};h.joinRoute=function(){return qi(Error("Not supported"))};
h.connectRouteByRouteId=function(){return qi(Error("Not supported"))};h.detachRoute=function(){};var Hr=function(a,c,b,d,e,f){Pq(0);c=Kp(e,a.getName(),c,b,!0,d);c.offTheRecord=f;a.g.add(new ar(c,d));return c};Fr.prototype.oj=function(a){this.h.onSinkAvailabilityUpdated(this,1);this.b&&(cr(this),rr(this.b,a));this.h.ed();wm().b=new tm(a.Cc,a.Zb())};
Fr.prototype.pj=function(a){var c=this;if(0==this.f.b.size)this.h.onSinkAvailabilityUpdated(this,0);Gr(this);a.forEach(function(b){var d=c.g;b=b.getId();if(b=dr(d,b))d.b.delete(b.Jc.id),er(d.f,b)});this.h.ed()};Fr.prototype.Nh=function(){this.h.ed()};var er=function(a,c){c=c.Jc;if(c.isLocal)a.h.onPresentationConnectionStateChanged(c.id,"terminated");Gr(a);a.h.Kg(c)};h=Fr.prototype;
h.terminateRoute=function(a){var c=this.g.b.get(a)||null;if(!c)return Qq(1),Promise.reject(new sq(3,"Route in DIAL provider not found for routeId "+a));fr(this.g,a);a=this.f.ra(c.Jc.sinkId);return a?$q(new Wq(a),c.appName).then(function(){Qq(0);return Promise.resolve()}).catch(function(b){Qq(3);return Promise.reject(b)}):(Qq(1),Promise.reject(new sq(3,"Sink in DIAL provider not found for sinkId "+c.Jc.sinkId)))};h.Kf=function(){throw Error("Not implemented.");};h.Ye=function(){return null};h.Th=function(){};
h.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.wg=function(a,c){c=this.f.ra(c);return!c||bj(a)?!1:(a=Cr(a))?"available"==Am(c,a.appName):!1};h.Df=function(){return!1};h.searchSinks=function(){return eb()};h.createMediaRouteController=function(){return eb()};h.provideSinks=function(a){jr(this.f,a)};var Ir=function(a){this.l=new gr(this);this.g=new Lm;this.f=a;this.w=this.j=0;this.h=new Hn;this.b=new Fr(this,this.l)};h=Ir.prototype;h.Ea=function(){return"cast.DialProviderWrapper"};h.kb=function(){return[new Jr(Qm(this.g),this.j,this.w,this.h.oa())]};h.jb=function(){var a=$l(this);a&&(Km(this.g,a.f),this.j=a.sequenceNumber,this.w=a.g,Gn(this.h,a.b))};h.getName=function(){return this.b.getName()};h.initialize=function(a){this.b.initialize(a);cm(this)};h.Dd=function(){return this.b.Dd()};
h.Dg=function(a){return(a=Kr(a))?this.b.Dg(a):uq};h.startObservingMediaSinks=function(a){(a=Kr(a))&&this.b.startObservingMediaSinks(a)};h.stopObservingMediaSinks=function(a){(a=Kr(a))&&this.b.stopObservingMediaSinks(a)};h.startObservingMediaRoutes=function(a){(a=Kr(a))&&this.b.startObservingMediaRoutes(a)};h.stopObservingMediaRoutes=function(a){(a=Kr(a))&&this.b.stopObservingMediaRoutes(a)};h.ra=function(a){return this.b.ra(a)};
var Nr=function(a,c,b,d,e){var f=Kr(c);if(!f)return Promise.reject(Error("Invalid source"));var g=Cr(f),k=a.l.ra(b);if(!k)return Promise.reject(Error("Attempting custom launch with closed route"));var m=g.appName;if(!m)return Promise.reject(Error("No app name given"));var p=Lr(c);return p?Zq(new Wq(k),m).then(function(v){var A=Hr(a.b,b,c,m,e,d);v={routeId:A.id,sinkId:k.getId(),appName:m,ll:v,launchParameter:g.launchParameter,session:null,clientId:null};a.g.set(A.id,v);var G=Mr(a,v.sinkId),F=new $n("receiver_action",
{receiver:G,action:chrome.cast.mg.CAST});F.clientId=p;a.f.ge(v.routeId,F);F=chrome.cast.da;var P=String(a.w);a.w=(a.w+1)%9007199254740992;G=new F(P,"",v.appName,[],G);v.session=G;v.clientId=p;G=new $n("new_session",G);G.clientId=p;a.f.ge(v.routeId,G);return A}):Promise.reject(Error("No client ID"))};Ir.prototype.createRoute=function(a,c,b,d,e,f,g){return a.startsWith("cast-dial:")||Or.test(a)?ri(Nr(this,a,c,d,b)):this.b.createRoute(a,c,b,d,e,f,g)};
Ir.prototype.terminateRoute=function(a){var c=this.g.get(a);if(c&&c.session&&c.clientId){var b={receiver:Mr(this,c.sinkId),action:chrome.cast.mg.STOP};b=new $n("receiver_action",b);b.clientId=c.clientId;this.f.ge(c.routeId,b);this.f.onPresentationConnectionStateChanged(c.routeId,"terminated")}return this.b.terminateRoute(a)};
Ir.prototype.sendRouteMessage=function(a,c,b){try{var d=JSON.parse(c)}catch(e){return Rq(1),Promise.reject(e)}switch(d.type){case "client_connect":return Rq(0),c=d.clientId,(a=this.g.get(a))?(b=Mr(this,a.sinkId),b.receiverType=chrome.cast.ph.DIAL,b=new $n("custom_dial_launch",new chrome.cast.Ck(b,a.ll.state,a.ll.extraData)),b.clientId=c,c=this.j,this.j=(this.j+1)%9007199254740992,b.sequenceNumber=c,this.h.add(b.sequenceNumber),this.f.ge(a.routeId,b),a=Promise.resolve()):a=Promise.reject(Error("Unknown route")),
a;case "custom_dial_launch":if(this.h.contains(d.sequenceNumber))return Rq(0),c=d,this.h.remove(c.sequenceNumber),c=c.message,(a=this.g.get(a))?c&&!c.doLaunch?a=Promise.resolve():(b=this.l.ra(a.sinkId))?(b=new Wq(b),d=a.launchParameter,d=(c?c.launchParameter:null)||d,a=b.launchApp(a.appName,d)):a=Promise.reject(Error("Custom launch response for sink that no longer exists")):a=Promise.reject(Error("Unknown route")),a;break;case "v2_message":if("STOP"==d.message.type)return Rq(0),this.terminateRoute(a),
Promise.resolve()}Rq(2);return this.b.sendRouteMessage(a,c,b)};Ir.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};var Mr=function(a,c){a=a.l.ra(c);c=xm(wm(),c);c=new chrome.cast.gi(c,a.Dc.friendlyName);c.ipAddress=a.Zb();c.receiverType=chrome.cast.ph.DIAL;return c};h=Ir.prototype;h.Kf=function(a){return this.b.Kf(a)};h.Ye=function(a){return this.b.Ye(a)};h.Th=function(){};
h.wg=function(a,c){return a.startsWith("cast-dial:")||Or.test(a)||this.b.wg(a,c)};h.Df=function(a,c,b){return this.b.Df(a,c,b)};h.connectRouteByRouteId=function(a,c,b,d,e){return this.b.connectRouteByRouteId(a,c,b,d,e)};h.joinRoute=function(a,c,b,d,e,f){return this.b.joinRoute(a,c,b,d,e,f)};h.detachRoute=function(a){this.g.remove(a);this.b.detachRoute(a)};h.ed=function(){this.f.ed()};h.onSinkAvailabilityUpdated=function(a,c){this.f.onSinkAvailabilityUpdated(a,c)};
h.Yf=function(a,c){this.f.Yf(this,c)};h.Kg=function(a){this.f.Kg(a)};h.bf=function(a){this.f.bf(a)};h.Si=function(){};h.getMirroringServiceHostForTab=function(){};h.getMirroringServiceHostForDesktop=function(){};h.getMirroringServiceHostForOffscreenTab=function(){};h.ge=function(a,c){this.f.ge(a,c)};h.onPresentationConnectionStateChanged=function(a,c){this.f.onPresentationConnectionStateChanged(a,c)};h.onPresentationConnectionClosed=function(a,c,b){this.f.onPresentationConnectionClosed(a,c,b)};
h.Li=function(a){return this.f.Li(a)};h.Ni=function(){return this.f.Ni()};h.cf=function(a){this.f.cf(a)};h.Sh=function(a,c){this.f.Sh(a,c)};h.Uh=function(a){this.f.Uh(a)};h.oj=function(a){this.b.oj(a)};h.pj=function(a){this.b.pj(a)};h.Nh=function(a){this.b.Nh(a)};h.sj=function(){};h.qm=function(){};h.searchSinks=function(a,c){return this.b.searchSinks(a,c)};h.provideSinks=function(a){this.b.provideSinks(a)};h.createMediaRouteController=function(){return eb()};
h.ag=function(a,c){return this.f.ag(a,c)};h.Xe=function(){return this.b.Xe()};
var Kr=function(a){try{var c=new URL(a)}catch(e){return null}if("dial:"==c.protocol)return a;if("cast-dial:"==c.protocol){var b=c;a="cast-dial:"!=b.protocol?null:new io(b.pathname,b.searchParams.get("dialPostData"),b.searchParams.get("clientId"));b=a.g;var d=a.b}else if("https:"==c.protocol){a=to(a);if(!a)return null;b=a.s;d=a.D}b?(a=d||"",b=new URL("dial:"+b),a&&b.searchParams.set("postData",a),b=b.toString()):b=null;return b},Lr=function(a){try{var c=new URL(a)}catch(b){return null}return"cast-dial:"==
c.protocol?c.searchParams.get("clientId"):"https:"==c.protocol?uo(a):null},Jr=function(a,c,b,d){this.f=a;this.sequenceNumber=c;this.g=b;this.b=d},Or=/__dialAppName__/;var Pr=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,Qr=function(a,c){if(a){a=a.split("&");for(var b=0;b<a.length;b++){var d=a[b].indexOf("="),e=null;if(0<=d){var f=a[b].substring(0,d);e=a[b].substring(d+1)}else f=a[b];c(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}},Rr=function(a,c,b){b=null!=b?"="+encodeURIComponent(String(b)):"";if(c+=b){b=a.indexOf("#");0>b&&(b=a.length);var d=a.indexOf("?");if(0>d||d>b){d=b;var e=""}else e=
a.substring(d+1,b);a=[a.substr(0,d),e,a.substr(b)];b=a[1];a[1]=c?b?b+"&"+c:c:b;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a},Sr=/#|$/,Tr=function(a,c){var b=a.search(Sr);a:{var d=0;for(var e=c.length;0<=(d=a.indexOf(c,d))&&d<b;){var f=a.charCodeAt(d-1);if(38==f||63==f)if(f=a.charCodeAt(d+e),!f||61==f||38==f||35==f)break a;d+=e+1}d=-1}if(0>d)return null;e=a.indexOf("&",d);if(0>e||e>b)e=b;d+=c.length+1;return decodeURIComponent(a.substr(d,e-d).replace(/\+/g," "))},Ur=function(a,c){var b=a.length-1;0<=b&&
a.indexOf("/",b)==b&&(a=a.substr(0,a.length-1));id(c,"/")&&(c=c.substr(1));return qe(a,"/",c)};var Vr=function(a){this.xc=this.w=this.g="";this.Ka=null;this.h=this.b="";this.j=!1;var c;a instanceof Vr?(this.j=Ia(void 0)?void 0:a.j,Wr(this,a.g),this.w=a.w,this.xc=a.xc,Xr(this,a.Bb()),this.b=a.b,Yr(this,a.f.clone()),this.h=a.h):a&&(c=String(a).match(Pr))?(this.j=!1,Wr(this,c[1]||"",!0),this.w=Zr(c[2]||""),this.xc=Zr(c[3]||"",!0),Xr(this,c[4]),this.b=Zr(c[5]||"",!0),Yr(this,c[6]||"",!0),this.h=Zr(c[7]||"")):(this.j=!1,this.f=new $r(null,this.j))};
Vr.prototype.toString=function(){var a=[],c=this.g;c&&a.push(as(c,bs,!0),":");var b=this.xc;if(b||"file"==c)a.push("//"),(c=this.w)&&a.push(as(c,bs,!0),"@"),a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.Bb(),null!=b&&a.push(":",String(b));if(b=this.b)this.xc&&"/"!=b.charAt(0)&&a.push("/"),a.push(as(b,"/"==b.charAt(0)?cs:ds,!0));(b=this.f.toString())&&a.push("?",b);(b=this.h)&&a.push("#",as(b,es));return a.join("")};
Vr.prototype.resolve=function(a){var c=this.clone(),b=!!a.g;b?Wr(c,a.g):b=!!a.w;b?c.w=a.w:b=!!a.xc;b?c.xc=a.xc:b=null!=a.Ka;var d=a.b;if(b)Xr(c,a.Bb());else if(b=!!a.b){if("/"!=d.charAt(0))if(this.xc&&!this.b)d="/"+d;else{var e=c.b.lastIndexOf("/");-1!=e&&(d=c.b.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=id(e,"/");e=e.split("/");for(var f=[],g=0;g<e.length;){var k=e[g++];"."==k?d&&g==e.length&&f.push(""):".."==k?((1<f.length||1==f.length&&""!=
f[0])&&f.pop(),d&&g==e.length&&f.push("")):(f.push(k),d=!0)}d=f.join("/")}else d=e}b?c.b=d:b=""!==a.f.toString();b?Yr(c,a.f.clone()):b=!!a.h;b&&(c.h=a.h);return c};Vr.prototype.clone=function(){return new Vr(this)};var Wr=function(a,c,b){a.g=b?Zr(c,!0):c;a.g&&(a.g=a.g.replace(/:$/,""))};Vr.prototype.Bb=function(){return this.Ka};
var Xr=function(a,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);a.Ka=c}else a.Ka=null},Yr=function(a,c,b){c instanceof $r?(a.f=c,fs(a.f,a.j)):(b||(c=as(c,gs)),a.f=new $r(c,a.j))},Zr=function(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},as=function(a,c,b){return Ja(a)?(a=encodeURI(a).replace(c,hs),b&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},hs=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},
bs=/[#\/\?@]/g,ds=/[#\?:]/g,cs=/[#\?]/g,gs=/[#\?@]/g,es=/#/g,$r=function(a,c){this.f=this.b=null;this.g=a||null;this.h=!!c},is=function(a){a.b||(a.b=new Lm,a.f=0,a.g&&Qr(a.g,function(c,b){a.add(decodeURIComponent(c.replace(/\+/g," ")),b)}))},ks=function(a){var c=Bn(a);if("undefined"==typeof c)throw Error("Keys are undefined");var b=new $r(null,void 0);a=An(a);for(var d=0;d<c.length;d++){var e=c[d],f=a[d];Ua(f)?js(b,e,f):b.add(e,f)}return b};h=$r.prototype;h.sa=function(){is(this);return this.f};
h.add=function(a,c){is(this);this.g=null;a=ls(this,a);var b=this.b.get(a);b||this.b.set(a,b=[]);b.push(c);this.f+=1;return this};h.remove=function(a){is(this);a=ls(this,a);return Om(this.b,a)?(this.g=null,this.f-=this.b.get(a).length,this.b.remove(a)):!1};h.clear=function(){this.b=this.g=null;this.f=0};h.Wb=function(){is(this);return 0==this.f};var ms=function(a,c){is(a);c=ls(a,c);return Om(a.b,c)};h=$r.prototype;h.Ff=function(a){var c=this.oa();return Ub(c,a)};
h.forEach=function(a,c){is(this);this.b.forEach(function(b,d){y(b,function(e){a.call(c,e,d,this)},this)},this)};h.Ab=function(){is(this);for(var a=this.b.oa(),c=this.b.Ab(),b=[],d=0;d<c.length;d++)for(var e=a[d],f=0;f<e.length;f++)b.push(c[d]);return b};h.oa=function(a){is(this);var c=[];if(Ja(a))ms(this,a)&&(c=dc(c,this.b.get(ls(this,a))));else{a=this.b.oa();for(var b=0;b<a.length;b++)c=dc(c,a[b])}return c};
h.set=function(a,c){is(this);this.g=null;a=ls(this,a);ms(this,a)&&(this.f-=this.b.get(a).length);this.b.set(a,[c]);this.f+=1;return this};h.get=function(a,c){if(!a)return c;a=this.oa(a);return 0<a.length?String(a[0]):c};var js=function(a,c,b){a.remove(c);0<b.length&&(a.g=null,a.b.set(ls(a,c),z(b)),a.f+=b.length)};
$r.prototype.toString=function(){if(this.g)return this.g;if(!this.b)return"";for(var a=[],c=this.b.Ab(),b=0;b<c.length;b++){var d=c[b],e=encodeURIComponent(String(d));d=this.oa(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}}return this.g=a.join("&")};$r.prototype.clone=function(){var a=new $r;a.g=this.g;this.b&&(a.b=this.b.clone(),a.f=this.f);return a};
var ls=function(a,c){c=String(c);a.h&&(c=c.toLowerCase());return c},fs=function(a,c){c&&!a.h&&(is(a),a.g=null,a.b.forEach(function(b,d){var e=d.toLowerCase();d!=e&&(this.remove(d),js(this,e,b))},a));a.h=c};$r.prototype.extend=function(a){for(var c=0;c<arguments.length;c++)Dn(arguments[c],function(b,d){this.add(d,b)},this)};var ns=function(a,c){this.input=a;this.domain=c};var os=function(a){this.b=a;this.m=hb("mr.ExternalMessageHandler")};
os.prototype.onMessage=function(a,c,b){var d=this;this.m.info("Received a message from "+c.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,this.b.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new ns(a.meetingName,a.domain)).then(function(f){var g="PresentationId"+c.id+ps++;d.b.createRoute("urn:x-org.chromium.media:source:desktop",f,g).then(function(k){b(new pf(e,"route",k.id))}).catch(function(k){b(new pf(e,"error",k))})},function(){b(new pf(e,"error",
Error("Failed to find sink.")))})):"stop"==a.type?this.b.terminateRoute(a.message.routeId).then(function(){b(new pf(e,"stopped"))}):"subscribe_log_data"==a.type?(jb.push(function(f){chrome.runtime.sendMessage(c.id,new pf(e,"log_message",f))}),b(new pf(e,"subscribed"))):(b(new pf(e,"error",Error("Unhandled message type"))),this.m.error("Unhandled message type "+a.type))};var ps=0;var qs=function(){this.b=[];this.f=[]};h=qs.prototype;h.enqueue=function(a){if(1E3<=this.sa()){if(this.Wb())throw Error("Empty queue");0==this.b.length&&(this.b=this.f,this.b.reverse(),this.f=[]);this.b.pop()}this.f.push(a)};h.sa=function(){return this.b.length+this.f.length};h.Wb=function(){return 0==this.sa()};h.oa=function(){var a=this.b.slice();a.reverse();a.push.apply(a,n(this.f));return a};h.clear=function(){this.b=[];this.f=[]};var rs=function(){this.b=new qs;this.f=Date.now()},ts=function(){null==ss&&(ss=new rs);return ss};rs.prototype.init=function(){ib=1;var a=hb("browser"),c=window.onerror;window.onerror=function(d,e,f,g,k){c&&c(d,e,f,g,k);a.error("Error: "+d+" ("+e+" @ Line: "+f+")",k)};jb.push(this.h.bind(this));var b=window.localStorage["debug.logs"];b&&(ib=qb(b.toUpperCase()));(b=window.localStorage["debug.console"])&&"false"!=b.toLowerCase()&&jb.push(this.g.bind(this))};
rs.prototype.h=function(a){this.b.enqueue(us(this,a,!1));a=a.Hc;a instanceof Error&&a.stack&&this.b.enqueue(a.stack)};rs.prototype.g=function(a){var c=[us(this,a,!0)];a.Hc&&c.push(a.Hc);switch(a.level){case 3:console.error.apply(console,n(c));break;case 2:console.warn.apply(console,n(c));break;case 1:console.log.apply(console,n(c));break;default:console.debug.apply(console,n(c))}};
var us=function(a,c,b){var d=["["];if(b)d.push(("       "+((Date.now()-a.f)/1E3).toFixed(3)).slice(-7));else{a=new Date(c.time);var e=function(f){return 10>f?"0"+f:f};d.push(a.getFullYear().toString(),"-",e(a.getMonth()+1),"-",e(a.getDate())," ",e(a.getHours()),":",e(a.getMinutes()),":",e(a.getSeconds()),".",e(Math.floor(a.getMilliseconds()/10)))}d.push("][",pb[c.level],"][",c.R,"] ",c.message);if(!b&&null!=c.Hc)if(d.push("\n"),c.Hc instanceof Error)d.push(c.Hc.message);else try{d.push(JSON.stringify(c.Hc))}catch(f){d.push(c.Hc.toString())}d.push("\n");
return d.join("")},vs=function(){var a=ts();return 0==a.b.sa()?"NA":a.b.oa().join("")},ws=function(){var a=ts();cm(a)};rs.prototype.Ea=function(){return"LogManager"};rs.prototype.kb=function(){return[this.b.oa()]};rs.prototype.jb=function(){var a=this.b.oa();this.b.clear();for(var c=l($l(this)||[]),b=c.next();!b.done;b=c.next())this.b.enqueue(b.value);a=l(a);for(b=a.next();!b.done;b=a.next())this.b.enqueue(b.value)};var ss=null;var xs=function(a){this.b=a;this.m=hb("mr.InternalMessageHandler")};
xs.prototype.onMessage=function(a,c,b){var d=this;if("retrieve_log_data"!=a.type)b(new pf(chrome.runtime.id,"error",Error("Unhandled message type")));else{var e={logs:vs(),device:ym()};c=[];var f=of(e.device.ip).then(function(k){k.b&&(e.device.version=k.b)});c.push(f);var g=this.b.s;g&&(a=ys(this,g,a.source).then(function(k){k&&(e.castStreamingLogs=k)},function(){d.m.error("Log upload failed for service: "+g)}),c.push(a));e.dialDeviceCounts=zs(this);c.push(As(this,e));a=this.b.getMediaSinkServiceStatus().then(function(k){e.mediaSinkServiceStatus=
k.status},function(){d.m.error("Fail to get media sink service status")});c.push(a);e.dialogType=this.b.H;or(c).then(function(){b(e)})}};var As=function(a,c){return Qi("mr.cast.SinkDiscoveryService").then(function(b){b=b.Xe();c.castDeviceCounts=b.Gg+"."+b.ug},function(){a.m.error("Failed to get device counts for castDeviceCounts.")})},zs=function(a){a=Bs(a.b,"dial");if(!a)return"";a=a.Xe();return a.Gg+"."+a.ug},ys=function(a,c,b){return Cs(a.b,c).then(function(d){return d.Gj(b)})};var Ds={ACCEPTED:0,Xu:1,TIMEOUT:2},Es={SUCCESS:0,nv:1},Fs={rp:0,Oo:1,sA:2,Ov:3,Nv:4,cx:5,TIMEOUT:6,uy:7},Gs={Lv:0,Iz:1},Hs={Vx:0,Jw:1,USER:2,Gv:3},Is=function(a){Cb("MediaRouter.Cloud.Knock.Result",a,Ds)},Js=function(a){Cb("MediaRouter.Cloud.Session.Start",a,Es)},Ks=function(a){Cb("MediaRouter.Cloud.Session.Type",a,Gs)},Ls=function(a){Cb("MediaRouter.Cloud.Device.UserRole",a,Hs)};var Ms=function(a,c){this.b=a;this.f=c},Ns=new Ms("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Os=new Ms("https://castedumessaging-pa.googleapis.com/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Ps=new Ms("https://www.googleapis.com/calendar/v3",""),Qs=new Ms("https://www.googleapis.com/hangouts/v1",""),Rs=new Ms("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var Ss=function(a,c,b,d,e,f){b=void 0===b?null:b;a||null==b&&(b="default");this.gm=a;this.Ja=c;this.xc=b;this.Tf=void 0===d?null:d;this.Uc=void 0===e?null:e;this.kf=void 0===f?null:f};Ss.prototype.f=function(){var a="";this.Uc?a=this.Uc:this.Tf&&(a=this.Tf);return a};Ss.prototype.Jd=function(){return this.gm};Ss.prototype.getId=function(){return this.Ja};Ss.prototype.merge=function(a){!this.kf&&a.kf&&(this.kf=a.kf);!this.Uc&&a.Uc&&(this.Uc=a.Uc);this.Uc&&a.Uc&&this.kf&&(this.Uc=a.Uc)};var Ts=function(a,c){this.f=a;this.g=c;this.m=hb("mr.cloud.calendar.CalendarService")},baa=function(a){return Us(a,a.g.b).then(function(c){a.m.info(Vs(c.length)+" events discovered before filtering.");return aaa(a,c)},function(c){a.m.G("Error getting Hangouts from calendar.",c);return[]})},Vs=function(a){return 20<a?"20+":a.toString()},Us=function(a,c){var b=Date.now();return caa(a,c,new Date(b),new Date(b+9E5)).then(function(d){return d.filter(a.b)})};
Ts.prototype.b=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};
var caa=function(a,c,b,d){c=Ws(Ps.b,["calendars",c,"events"],{timeMin:b.toJSON(),timeMax:d.toJSON(),singleEvents:!0});ob(a.m,"Retrieving Hangouts from Calendar: "+c);return Xs(a.f,c,"GET").then(function(e){return e.items?e.items:[]})},aaa=function(a,c){var b=[];c.filter(function(d){return d.hangoutLink}).forEach(function(d){var e=new Vr(d.hangoutLink);if("meet.google.com"==e.xc)b.push(new Ss(!0,e.b.substring(1),void 0,void 0,d.summary));else if(e=e.b.substring(12).split("/"),2==e.length){var f=l(e);
e=f.next().value;f=f.next().value;if(-1!=e.indexOf(".")){var g=f;var k=e}b.push(new Ss(!1,f+"@"+e,k,g,d.summary,void 0))}else a.m.G("Invalid hangout link from calendar event: "+d.hangoutLink)});a.m.info(Vs(b.length)+" events discovered with Hangout links.");return b};var Ys=function(a){this.b=a;this.id=a.id;this.m=hb("mr.cloud.devices.WeaveDevice")};Ys.prototype.isAvailable=function(){if(this.getState().appStatus){var a="online"==this.b.connectionStatus,c="available"==this.getState().appStatus,b=Zs(this,864E5);ob(this.m,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+c+", checked in: "+b);return a&&c&&b}a=Zs(this,9E5);this.m.info("Availability for legacy receiver app: "+a);return a};
var Zs=function(a,c){a=a.b.lastUpdateTimeMs?Number(a.b.lastUpdateTimeMs):null;return!!(a&&a>Date.now()-c)};Ys.prototype.f=function(){return this.getState().settings.receiverName};Ys.prototype.getId=function(){return this.id};Ys.prototype.getState=function(){return this.b.state._cloudCast};var $s=function(){this.m=Lf("mr.cloud.GcmRegistrationSerializer");this.b=Promise.resolve("")};$s.prototype.register=function(a){var c=this,b=function(){return new Promise(function(d,e){chrome.gcm.register(a,function(f){f?(c.m.info("Got GCM registration ID: "+f),d(f)):e(Error(chrome.runtime.lastError&&chrome.runtime.lastError.message||"unknown error"))})})};return this.b=this.b.then(b,b)};var daa=function(a){this.email=a;this.imageUrl=null},eaa=function(a){this.type=a},at=function(a,c,b,d){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=c||null;this.flungUrl=b||null;this.presentationId=d||null};q(at,eaa);
var bt=function(a,c,b){this.name=a;this.parameters=c;this.minimalRole=null!=b?b:"user"},ct={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},faa=new bt("_knockingStartWebrtcSession",ct,"viewer"),gaa=new bt("_startWebrtcSession",ct),haa=new bt("_stopSession",{},"viewer");var dt=function(a,c){this.j=a;this.w=c;this.f=this.g=this.b=null;this.h=!1;this.m=hb("mr.cloud.devices.WeaveDevicesService");cm(this)};dt.prototype.getDevice=function(a){a=Ws(Ns.b,["devices",a]);return Xs(this.j,a,"GET").then(function(c){return new Ys(c)})};
var et=function(a,c){var b=Ws(Ns.b,["devices"],c);return Xs(a.j,b,"GET").then(function(d){var e=(d.devices||[]).filter(function(g){return null!=g.commandDefs&&null!=g.commandDefs._cloudCast}).map(function(g){return new Ys(g)});if(d=d.nextPageToken){var f=Lc(c);f.token=d;return et(a,f).then(function(g){return e.concat(g)})}return e})};dt.prototype.Ea=function(){return"WeaveDevicesService"};dt.prototype.kb=function(){return[new iaa(this.b,this.f,this.g)]};
dt.prototype.jb=function(){var a=$l(this);a&&(this.b=a.Tq,this.f=a.gcmRegistrationId,this.g=a.Sq)};var jaa=function(a){return a.f&&null!=a.g&&a.g+864E5>=Date.now()?Promise.resolve(a.f):a.w.register(["919648714761"]).then(function(c){ob(a.m,"Got GCM ID: "+c);a.f=c;a.g=Date.now();a.b=null;return c},function(c){a.m.G("Error",c);a.f=null;a.g=null;a.b=null;throw c;})};
dt.prototype.subscribe=function(a){var c=this;if(this.h)return Promise.resolve();this.h=!0;if(!a||this.b&&!(this.b+864E5<Date.now()))return Promise.resolve();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var b=Ws(Ns.b,["subscriptions","subscribe"],{});return Xs(this.j,b,"POST",a).then(function(){ob(c.m,"Subscribed on: "+Date.now());c.b=Date.now();c.h=!1;return Promise.resolve()},function(d){c.h=!1;throw d;})};
var iaa=function(a,c,b){this.Tq=a;this.gcmRegistrationId=c;this.Sq=b};var ft=function(a,c,b,d,e,f,g,k){var m=xm(wm(),a);this.nb=new Wl(m,c,g,k,e);this.deviceId=a;this.b=b;this.model=d;this.isAvailable=f};ca.Object.defineProperties(ft.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.nb.id}},displayName:{configurable:!0,enumerable:!0,set:function(a){this.nb.friendlyName=a}}});var gt=function(a,c,b,d,e){ft.call(this,a,c,"weave","Chrome Streaming Receiver",d,e,"education");this.pi=b};q(gt,ft);
var ht=function(a){var c=a.xc,b;a.Tf&&a.f()!=a.Tf&&(b=a.Tf);ft.call(this,a.getId(),a.f(),"mesi","Hangout",c,!1,a.Jd()?"meeting":"hangout",b);this.Jd=a.Jd();this.fh=a.kf||""};q(ht,ft);var it=function(a,c,b){ft.call(this,a,c,"slarti","Cast Receiver for Education","default",b,"education")};q(it,ft);var jt=function(a,c,b){this.w=a;this.h=c;this.b=new Map;this.g=new Map;this.f=null;this.j=b};jt.prototype.he=function(){var a=this.f+this.j;if(null==this.f||a<Date.now())this.f=Date.now(),kaa(this);return Array.from(this.b.values())};jt.prototype.ra=function(a){return this.b.get(a)||null};
var kaa=function(a){a.w().then(function(c){laa(a,c)})},laa=function(a,c){var b=new Map(a.b),d=new Map,e=new Map,f=[],g=[];c.forEach(function(k){var m=k.id;d.set(m,k);e.set(m,k.deviceId);b.has(m)?b.has(m)&&JSON.stringify(b.get(m))!=JSON.stringify(k)&&g.push(k.nb):f.push(k.nb);b.delete(m)});c=[].concat(n(b.values())).map(function(k){return k.nb});a.g.clear();a.g=e;a.b.clear();a.b=d;maa(a,f,g,c)},maa=function(a,c,b,d){0<c.length&&kt(a.h,c);0<b.length&&lt(a.h,b);0<d.length&&mt(a.h,d)},nt=function(a){for(var c=
{},b=l(a.b.entries()),d=b.next();!d.done;d=b.next()){var e=l(d.value);d=e.next().value;e=e.next().value;c[d]=e}b={};d=l(a.g.entries());for(e=d.next();!e.done;e=d.next()){var f=l(e.value);e=f.next().value;f=f.next().value;b[e]=f}return new naa(c,b,a.f)},ot=function(a,c){for(var b in c.sinks){var d=c.sinks[b],e=null;"Hangout"==d.model?e=new ht(new Ss(d.Jd,d.deviceId,d.nb.domain,d.nb.description,d.nb.friendlyName,d.fh)):"Cast Receiver for Education"==d.model?e=new it(d.deviceId,d.nb.friendlyName,d.isAvailable):
"Chrome Streaming Receiver"==d.model&&(e=new gt(d.deviceId,d.nb.friendlyName,d.pi,d.nb.domain,d.isAvailable));a.b.set(b,e)}for(b in c.b)a.g.set(b,c.b[b]);c.f&&(a.f=c.f)},naa=function(a,c,b){this.sinks=a;this.b=c;this.f=b};var qt=function(a,c,b){if(!pt){Kf();var d=Jf;d.f=Ff;var e=oaa;d.b||(d.b=[]);d.b.push(e);pt=!0}this.g=a;this.h=c;this.b=new jt(this.j.bind(this),b,2E4);this.f=new Map;cm(this)},oaa=function(a){kb({R:a.g,level:rb(a.f.value),time:a.j,message:a.getMessage(),Hc:a.b})};qt.prototype.he=function(){return this.b.he()};qt.prototype.ra=function(a){return this.b.ra(a)};
qt.prototype.j=function(){var a=this;this.m.info("Fetching hangouts");return or([paa(this.h),baa(this.g)]).then(function(c){var b=Array.from(a.f.values());c.forEach(function(e){e.ce?b=b.concat(e.value):a.m.error("Error discovering Hangouts",e.reason)});var d=b.reduce(function(e,f){var g=e[f.getId()];g?g.merge(f):g=f;e[g.getId()]=g;return e},{});return Object.keys(d).map(function(e){e=d[e];Bb("MediaRouter.Cloud.Hangout.Sink.Discovered");return new ht(e)})})};
var qaa=function(a,c){return Qi("mr.mirror.hangouts.MeetingsService").then(function(b){return b.ac(c)}).then(function(b){return rt(a,b)},function(){return c.input.match(/^#/)?Promise.reject(Error("Failed to resolve meeting alias.")):rt(a,c.input,c.domain)})},rt=function(a,c,b){b=b||void 0;var d=!b;c=new Ss(d,d?c:c+"@"+b,b,c,void 0,void 0);a.f.set(c.getId(),c);c=new ht(c);a.b.b.set(c.id,c);return c.nb};qt.prototype.Ea=function(){return"HangoutSinkDiscoveryService"};
qt.prototype.kb=function(){for(var a={},c=l(this.f.entries()),b=c.next();!b.done;b=c.next()){var d=l(b.value);b=d.next().value;d=d.next().value;a[b]=d}return[{cache:nt(this.b),manualHangouts:a}]};qt.prototype.jb=function(){var a=$l(this);if(a){ot(this.b,a.cache);for(var c in a.manualHangouts){var b=a.manualHangouts[c];this.f.set(c,new Ss(b.gm,b.Ja,b.xc,b.Tf,b.Uc,b.kf))}}};qt.prototype.m=hb("mr.cloud.discovery.HangoutSinkDiscoveryService");var pt=!1;var tt=function(){this.f=!1;this.b=null;this.g=!1;this.m=hb("mr.cloud.identity.IdentityService");cm(this);raa(this);st(this)},ut=function(a){return a.b?a.b.substr(a.b.indexOf("@")+1):""};
tt.prototype.getAuthToken=function(){return chrome.identity?new Promise(function(a,c){chrome.identity.getAuthToken({interactive:!1},function(b){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==b?c(Error("User is not logged in (no token found)")):a(b)})}):Promise.reject(Error("chrome.identity permission required for auth."))};
var saa=function(a){return new Promise(function(c){chrome.identity.removeCachedAuthToken({token:a},function(){c()})})},st=function(a){a.getAuthToken().then(function(c){chrome.identity.getProfileUserInfo(function(b){a.f=!!b.email||!!b.id;a.b=b.email||null;c&&!a.f&&(a.g=!0)})},function(c){ob(a.m,"Unable to set sign in and email.",c)})},raa=function(a){chrome.identity.onSignInChanged.addListener(function(c,b){Zi(6);a.f=b;a.m.info("Signed in change: "+a.f);a.f?st(a):(a.b=null,a.g=!1)})},taa=function(a){return a.getAuthToken().then(function(c){var b=
window.gapi;if(!b)return a.m.error("gapi not loaded."),!1;a.m.info("Setting gapi auth token");b.auth.setToken({access_token:c});return!0})};tt.prototype.Ea=function(){return"IdentityService"};tt.prototype.kb=function(){return[null,{signedIn:this.f,userEmail:this.b,kioskAuth:this.g}]};tt.prototype.jb=function(){var a=am(this);a&&(a.signedIn&&(this.f=a.signedIn),a.userEmail&&(this.b=a.userEmail),a.kioskAuth&&(this.g=a.kioskAuth))};var vt="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var wt=function(a){var c=a.method,b=a.uri,d=a.baseUrl,e=a.Kc,f=a.Ym,g=a.headers,k=a.body,m=a.start,p=a.apiKey,v=a.gh;a=a.ib;this.method=c&&c.toUpperCase()||"GET";(c=b)||(d=[d].concat(n(e||[])).join("/"),d=new Vr(encodeURI(d)),f&&(f=ks(f),Yr(d,f)),c=d);this.uri=c;p&&this.uri.f.add("key",p);this.b=a||null;this.headers=g||{};(this.body=k)&&(this.headers["Content-Type"]="application/json");this.gh=Ia(v)?v:1E4;this.start=m||u()},uaa=function(a){return(a.b?a.b.getAuthToken():Promise.resolve(null)).then(function(c){c&&
(a.headers.Authorization="Bearer "+c);c={method:a.method,headers:a.headers};a.body&&(c.body=JSON.stringify(a.body));return new Request(a.uri.toString(),c)})};var vaa={Ou:100,Mz:101,Rx:200,Pu:201,ACCEPTED:202,vx:203,Ix:204,Oy:205,cy:206,jx:207,ix:300,fx:301,uv:302,lz:303,Fx:304,mA:305,Pz:307,jy:308,Rn:400,Yz:401,zo:402,tv:403,Bx:404,Zw:405,yx:406,yy:407,My:408,Ku:409,Ev:410,Fw:411,ry:412,Jy:413,Ny:414,fA:415,Ly:416,hv:417,eA:422,Iw:423,iv:424,sy:428,Sz:429,Ky:431,po:500,Cx:501,Xt:502,sz:503,zv:504,Uv:505,gw:507,px:511,By:1223};var xt=function(a,c){Eb.call(this,c&&c.message||a.statusText);this.code=a.status;this.response=a;this.status=(this.b=c)&&c.status};q(xt,Eb);var zaa=function(a){if(waa.has(a.code))return!0;var c=a.b||{};return a.b?xaa.has(c.status)?!0:!!(c.errors||[]).find(function(b){return yaa.has(b)}):!1},yt=function(a,c){a=new Response(void 0,{status:c||408,statusText:a});return new xt(a)},waa=new Set([400,401,403,404,405,406,501]),xaa=new Set(["PERMISSION_DENIED"]),yaa=new Set("authError command_is_in_terminal_state forbidden notFound unmanaged_group_acl acl_entry_bad_scope network_error".split(" "));var W=function(){this.Pc=this.Pc;this.Va=this.Va};W.prototype.Pc=!1;W.prototype.w=function(){return this.Pc};W.prototype.ab=function(){this.Pc||(this.Pc=!0,this.ia())};W.prototype.b=function(a){zt(this,db(At,a))};var zt=function(a,c){a.Pc?Ia(void 0)?c.call(void 0):c():(a.Va||(a.Va=[]),a.Va.push(Ia(void 0)?t(c,void 0):c))};W.prototype.ia=function(){if(this.Va)for(;this.Va.length;)this.Va.shift()()};
var At=function(a){a&&"function"==typeof a.ab&&a.ab()},Bt=function(a){for(var c=0,b=arguments.length;c<b;++c){var d=arguments[c];Va(d)?Bt.apply(null,d):At(d)}};var X=function(a,c){this.type=a;this.g=this.target=c;this.hn=!0};X.prototype.h=function(){this.hn=!1};var Ct=!Be||9<=Number(We),Aaa=Be&&!Ve("9"),Baa=function(){if(!Ha.addEventListener||!Object.defineProperty)return!1;var a=!1,c=Object.defineProperty({},"passive",{get:function(){a=!0}});try{Ha.addEventListener("test",Qa,c),Ha.removeEventListener("test",Qa,c)}catch(b){}return a}();var Dt=function(a,c){X.call(this,a?a.type:"");this.relatedTarget=this.g=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.b=null;a&&this.init(a,c)};x(Dt,X);var Caa=uf({2:"touch",3:"pen",4:"mouse"});
Dt.prototype.init=function(a,c){var b=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.g=c;(c=a.relatedTarget)?De&&(we(c,"nodeName")||(c=null)):"mouseover"==b?c=a.fromElement:"mouseout"==b&&(c=a.toElement);this.relatedTarget=c;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:
a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=Ja(a.pointerType)?a.pointerType:Caa[a.pointerType]||"";this.state=a.state;this.b=a;a.defaultPrevented&&this.h()};
Dt.prototype.h=function(){Dt.Ra.h.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Aaa)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(c){}};var Et="closure_listenable_"+(1E6*Math.random()|0),Ft=function(a){return!(!a||!a[Et])},Daa=0;var Eaa=function(a,c,b,d,e){this.listener=a;this.proxy=null;this.src=c;this.type=b;this.capture=!!d;this.Tc=e;this.key=++Daa;this.removed=this.uh=!1},Gt=function(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.Tc=null};var Ht=function(a){this.src=a;this.b={};this.f=0};Ht.prototype.add=function(a,c,b,d,e){var f=a.toString();a=this.b[f];a||(a=this.b[f]=[],this.f++);var g=It(a,c,d,e);-1<g?(c=a[g],b||(c.uh=!1)):(c=new Eaa(c,this.src,f,!!d,e),c.uh=b,a.push(c));return c};Ht.prototype.remove=function(a,c,b,d){a=a.toString();if(!(a in this.b))return!1;var e=this.b[a];c=It(e,c,b,d);return-1<c?(Gt(e[c]),$b(e,c),0==e.length&&(delete this.b[a],this.f--),!0):!1};
var Jt=function(a,c){var b=c.type;if(!(b in a.b))return!1;var d=ac(a.b[b],c);d&&(Gt(c),0==a.b[b].length&&(delete a.b[b],a.f--));return d};Ht.prototype.removeAll=function(a){a=a&&a.toString();var c=0,b;for(b in this.b)if(!a||b==a){for(var d=this.b[b],e=0;e<d.length;e++)++c,Gt(d[e]);delete this.b[b];this.f--}return c};var Kt=function(a,c,b,d,e){a=a.b[c.toString()];c=-1;a&&(c=It(a,b,d,e));return-1<c?a[c]:null};
Ht.prototype.hasListener=function(a,c){var b=Ia(a),d=b?a.toString():"",e=Ia(c);return Ac(this.b,function(f){for(var g=0;g<f.length;++g)if(!(b&&f[g].type!=d||e&&f[g].capture!=c))return!0;return!1})};var It=function(a,c,b,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==c&&f.capture==!!b&&f.Tc==d)return e}return-1};var Lt="closure_lm_"+(1E6*Math.random()|0),Mt={},Nt=0,Pt=function(a,c,b,d,e){if(d&&d.once)return Ot(a,c,b,d,e);if(Ua(c)){for(var f=0;f<c.length;f++)Pt(a,c[f],b,d,e);return null}b=Qt(b);return Ft(a)?a.listen(c,b,Ya(d)?!!d.capture:!!d,e):Rt(a,c,b,!1,d,e)},Rt=function(a,c,b,d,e,f){if(!c)throw Error("Invalid event type");var g=Ya(e)?!!e.capture:!!e,k=St(a);k||(a[Lt]=k=new Ht(a));b=k.add(c,b,d,g,f);if(b.proxy)return b;d=Faa();b.proxy=d;d.src=a;d.listener=b;if(a.addEventListener)Baa||(e=g),void 0===e&&
(e=!1),a.addEventListener(c.toString(),d,e);else if(a.attachEvent)a.attachEvent(Tt(c.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");Nt++;return b},Faa=function(){var a=Gaa,c=Ct?function(b){return a.call(c.src,c.listener,b)}:function(b){b=a.call(c.src,c.listener,b);if(!b)return b};return c},Ot=function(a,c,b,d,e){if(Ua(c)){for(var f=0;f<c.length;f++)Ot(a,c[f],b,d,e);return null}b=Qt(b);return Ft(a)?Ut(a,
c,b,Ya(d)?!!d.capture:!!d,e):Rt(a,c,b,!0,d,e)},Vt=function(a,c,b,d,e){if(Ua(c))for(var f=0;f<c.length;f++)Vt(a,c[f],b,d,e);else d=Ya(d)?!!d.capture:!!d,b=Qt(b),Ft(a)?a.L.remove(String(c),b,d,e):a&&(a=St(a))&&(c=Kt(a,c,b,d,e))&&Wt(c)},Wt=function(a){if(r(a)||!a||a.removed)return!1;var c=a.src;if(Ft(c))return Jt(c.L,a);var b=a.type,d=a.proxy;c.removeEventListener?c.removeEventListener(b,d,a.capture):c.detachEvent?c.detachEvent(Tt(b),d):c.addListener&&c.removeListener&&c.removeListener(d);Nt--;(b=St(c))?
(Jt(b,a),0==b.f&&(b.src=null,c[Lt]=null)):Gt(a);return!0},Xt=function(a){if(a)if(Ft(a))a.Xj(void 0);else if(a=St(a)){var c=0,b;for(b in a.b)for(var d=a.b[b].concat(),e=0;e<d.length;++e)Wt(d[e])&&++c}},Tt=function(a){return a in Mt?Mt[a]:Mt[a]="on"+a},Zt=function(a,c,b,d){var e=!0;if(a=St(a))if(c=a.b[c.toString()])for(c=c.concat(),a=0;a<c.length;a++){var f=c[a];f&&f.capture==b&&!f.removed&&(f=Yt(f,d),e=e&&!1!==f)}return e},Yt=function(a,c){var b=a.listener,d=a.Tc||a.src;a.uh&&Wt(a);return b.call(d,
c)},Gaa=function(a,c){if(a.removed)return!0;if(!Ct){var b=c||Pa("window.event");c=new Dt(b,this);var d=!0;if(!(0>b.keyCode||void 0!=b.returnValue)){a:{var e=!1;if(0==b.keyCode)try{b.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==b.returnValue)b.returnValue=!0}b=[];for(e=c.g;e;e=e.parentNode)b.push(e);a=a.type;for(e=b.length-1;0<=e;e--){c.g=b[e];var f=Zt(b[e],a,!0,c);d=d&&f}for(e=0;e<b.length;e++)c.g=b[e],f=Zt(b[e],a,!1,c),d=d&&f}return d}return Yt(a,new Dt(c,this))},St=function(a){a=a[Lt];return a instanceof
Ht?a:null},$t="__closure_events_fn_"+(1E9*Math.random()>>>0),Qt=function(a){if(Xa(a))return a;a[$t]||(a[$t]=function(c){return a.handleEvent(c)});return a[$t]};var Y=function(){W.call(this);this.L=new Ht(this);this.vf=this;this.D=null};x(Y,W);Y.prototype[Et]=!0;h=Y.prototype;h.addEventListener=function(a,c,b,d){Pt(this,a,c,b,d)};h.removeEventListener=function(a,c,b,d){Vt(this,a,c,b,d)};
h.N=function(a){var c,b=this.D;if(b)for(c=[];b;b=b.D)c.push(b);b=this.vf;var d=a.type||a;if(Ja(a))a=new X(a,b);else if(a instanceof X)a.target=a.target||b;else{var e=a;a=new X(d,b);Pc(a,e)}e=!0;if(c)for(var f=c.length-1;0<=f;f--){var g=a.g=c[f];e=g.Jf(d,!0,a)&&e}g=a.g=b;e=g.Jf(d,!0,a)&&e;e=g.Jf(d,!1,a)&&e;if(c)for(f=0;f<c.length;f++)g=a.g=c[f],e=g.Jf(d,!1,a)&&e;return e};h.ia=function(){Y.Ra.ia.call(this);this.Xj();this.D=null};h.listen=function(a,c,b,d){return this.L.add(String(a),c,!1,b,d)};
var Ut=function(a,c,b,d,e){return a.L.add(String(c),b,!0,d,e)};Y.prototype.Xj=function(a){this.L&&this.L.removeAll(a)};Y.prototype.Jf=function(a,c,b){a=this.L.b[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==c){var g=f.listener,k=f.Tc||f.src;f.uh&&Jt(this.L,f);d=!1!==g.call(k,b)&&d}}return d&&0!=b.hn};Y.prototype.hasListener=function(a,c){return this.L.hasListener(Ia(a)?String(a):void 0,c)};var au=function(a,c){this.g=a;this.h=c;this.f=0;this.b=null};au.prototype.get=function(){if(0<this.f){this.f--;var a=this.b;this.b=a.next;a.next=null}else a=this.g();return a};var bu=function(a,c){a.h(c);100>a.f&&(a.f++,c.next=a.b,a.b=c)};var cu=function(a){Ha.setTimeout(function(){throw a;},0)},du,Haa=function(){var a=Ha.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!$d("Presto")&&(a=function(){var e=document.createElement("IFRAME");e.style.display="none";le(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(ee(ge));e.close();var g="callImmediate"+Math.random(),k="file:"==f.location.protocol?"*":f.location.protocol+"//"+
f.location.host;e=t(function(m){if(("*"==k||m.origin==k)&&m.data==g)this.port1.onmessage()},this);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,k)}}});if("undefined"!==typeof a&&!$d("Trident")&&!$d("MSIE")){var c=new a,b={},d=b;c.port1.onmessage=function(){if(Ia(b.next)){b=b.next;var e=b.wl;b.wl=null;e()}};return function(e){d.next={wl:e};d=d.next;c.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(e){var f=document.createElement("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;f.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){Ha.setTimeout(e,0)}};var eu=function(){this.f=this.b=null},gu=new au(function(){return new fu},function(a){a.reset()});eu.prototype.add=function(a,c){var b=gu.get();b.set(a,c);this.f?this.f.next=b:this.b=b;this.f=b};eu.prototype.remove=function(){var a=null;this.b&&(a=this.b,this.b=this.b.next,this.b||(this.f=null),a.next=null);return a};var fu=function(){this.next=this.scope=this.b=null};fu.prototype.set=function(a,c){this.b=a;this.scope=c;this.next=null};fu.prototype.reset=function(){this.next=this.scope=this.b=null};var ku=function(a,c){hu||Iaa();iu||(hu(),iu=!0);ju.add(a,c)},hu,Iaa=function(){if(Ha.Promise&&Ha.Promise.resolve){var a=Ha.Promise.resolve(void 0);hu=function(){a.then(lu)}}else hu=function(){var c=lu;!Xa(Ha.setImmediate)||Ha.Window&&Ha.Window.prototype&&!$d("Edge")&&Ha.Window.prototype.setImmediate==Ha.setImmediate?(du||(du=Haa()),du(c)):Ha.setImmediate(c)}},iu=!1,ju=new eu,lu=function(){for(var a;a=ju.remove();){try{a.b.call(a.scope)}catch(c){cu(c)}bu(gu,a)}iu=!1};var mu=function(a){a.prototype.$goog_Thenable=!0},nu=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(c){return!1}};var qu=function(a,c){this.b=0;this.l=void 0;this.h=this.f=this.g=null;this.j=this.w=!1;if(a!=Qa)try{var b=this;a.call(c,function(d){ou(b,2,d)},function(d){if(!(d instanceof pu))try{if(d instanceof Error)throw d;throw Error("Promise rejected.");}catch(e){}ou(b,3,d)})}catch(d){ou(this,3,d)}},ru=function(){this.next=this.context=this.f=this.h=this.b=null;this.g=!1};ru.prototype.reset=function(){this.context=this.f=this.h=this.b=null;this.g=!1};
var su=new au(function(){return new ru},function(a){a.reset()}),tu=function(a,c,b){var d=su.get();d.h=a;d.f=c;d.context=b;return d},uu=function(a){if(a instanceof qu)return a;var c=new qu(Qa);ou(c,2,a);return c},vu=function(a){return new qu(function(c,b){b(a)})},xu=function(a,c,b){wu(a,c,b,null)||ku(db(c,a))},yu=function(a){return new qu(function(c,b){a.length||c(void 0);for(var d=0,e;d<a.length;d++)e=a[d],xu(e,c,b)})},zu=function(a){return new qu(function(c,b){var d=a.length,e=[];if(d)for(var f=
function(p,v){d--;e[p]=v;0==d&&c(e)},g=function(p){b(p)},k=0,m;k<a.length;k++)m=a[k],xu(m,db(f,k),g);else c(e)})},Au=function(a){return new qu(function(c){var b=a.length,d=[];if(b)for(var e=function(k,m,p){b--;d[k]=m?{ce:!0,value:p}:{ce:!1,reason:p};0==b&&c(d)},f=0,g;f<a.length;f++)g=a[f],xu(g,db(e,f,!0),db(e,f,!1));else c(d)})},Bu=function(){var a,c,b=new qu(function(d,e){a=d;c=e});return new Jaa(b,a,c)};qu.prototype.then=function(a,c,b){return Cu(this,Xa(a)?a:null,Xa(c)?c:null,b)};mu(qu);
var Eu=function(a,c,b){c=tu(c,c,b);c.g=!0;Du(a,c);return a},Fu=function(a,c,b){return Cu(a,null,c,b)};qu.prototype.cancel=function(a){0==this.b&&ku(function(){var c=new pu(a);Gu(this,c)},this)};
var Gu=function(a,c){if(0==a.b)if(a.g){var b=a.g;if(b.f){for(var d=0,e=null,f=null,g=b.f;g&&(g.g||(d++,g.b==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==b.b&&1==d?Gu(b,c):(f?(d=f,d.next==b.h&&(b.h=d),d.next=d.next.next):Hu(b),Iu(b,e,3,c)))}a.g=null}else ou(a,3,c)},Du=function(a,c){a.f||2!=a.b&&3!=a.b||Ju(a);a.h?a.h.next=c:a.f=c;a.h=c},Cu=function(a,c,b,d){var e=tu(null,null,null);e.b=new qu(function(f,g){e.h=c?function(k){try{var m=c.call(d,k);f(m)}catch(p){g(p)}}:f;e.f=b?function(k){try{var m=b.call(d,
k);!Ia(m)&&k instanceof pu?g(k):f(m)}catch(p){g(p)}}:g});e.b.g=a;Du(a,e);return e.b};qu.prototype.s=function(a){this.b=0;ou(this,2,a)};qu.prototype.D=function(a){this.b=0;ou(this,3,a)};
var ou=function(a,c,b){0==a.b&&(a===b&&(c=3,b=new TypeError("Promise cannot resolve to itself")),a.b=1,wu(b,a.s,a.D,a)||(a.l=b,a.b=c,a.g=null,Ju(a),3!=c||b instanceof pu||Kaa(a,b)))},wu=function(a,c,b,d){if(a instanceof qu)return Du(a,tu(c||Qa,b||null,d)),!0;if(nu(a))return a.then(c,b,d),!0;if(Ya(a))try{var e=a.then;if(Xa(e))return Laa(a,e,c,b,d),!0}catch(f){return b.call(d,f),!0}return!1},Laa=function(a,c,b,d,e){var f=!1,g=function(m){f||(f=!0,b.call(e,m))},k=function(m){f||(f=!0,d.call(e,m))};try{c.call(a,
g,k)}catch(m){k(m)}},Ju=function(a){a.w||(a.w=!0,ku(a.o,a))},Hu=function(a){var c=null;a.f&&(c=a.f,a.f=c.next,c.next=null);a.f||(a.h=null);return c};qu.prototype.o=function(){for(var a;a=Hu(this);)Iu(this,a,this.b,this.l);this.w=!1};
var Iu=function(a,c,b,d){if(3==b&&c.f&&!c.g)for(;a&&a.j;a=a.g)a.j=!1;if(c.b)c.b.g=null,Ku(c,b,d);else try{c.g?c.h.call(c.context):Ku(c,b,d)}catch(e){Lu.call(null,e)}bu(su,c)},Ku=function(a,c,b){2==c?a.h.call(a.context,b):a.f&&a.f.call(a.context,b)},Kaa=function(a,c){a.j=!0;ku(function(){a.j&&Lu.call(null,c)})},Lu=cu,pu=function(a){Eb.call(this,a)};x(pu,Eb);pu.prototype.name="cancel";var Jaa=function(a,c,b){this.Y=a;this.resolve=c;this.reject=b};var Mu=function(a,c){Y.call(this);this.h=a||1;this.g=c||Ha;this.j=t(this.o,this);this.l=u()};x(Mu,Y);Mu.prototype.enabled=!1;Mu.prototype.f=null;var Nu=function(a,c){a.h=c;a.f&&a.enabled?(a.stop(),a.start()):a.f&&a.stop()};Mu.prototype.o=function(){if(this.enabled){var a=u()-this.l;0<a&&a<.8*this.h?this.f=this.g.setTimeout(this.j,this.h-a):(this.f&&(this.g.clearTimeout(this.f),this.f=null),this.N("tick"),this.enabled&&(this.stop(),this.start()))}};
Mu.prototype.start=function(){this.enabled=!0;this.f||(this.f=this.g.setTimeout(this.j,this.h),this.l=u())};Mu.prototype.stop=function(){this.enabled=!1;this.f&&(this.g.clearTimeout(this.f),this.f=null)};Mu.prototype.ia=function(){Mu.Ra.ia.call(this);this.stop();delete this.g};
var Ou=function(a,c,b){if(Xa(a))b&&(a=t(a,b));else if(a&&"function"==typeof a.handleEvent)a=t(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:Ha.setTimeout(a,c||0)},Pu=function(a){Ha.clearTimeout(a)},Qu=function(a){var c=null;return Fu(new qu(function(b,d){c=Ou(function(){b(void 0)},a);-1==c&&d(Error("Failed to schedule timer."))}),function(b){Pu(c);throw b;})};var Ru=function(){var a=void 0===a?!0:a;this.m=Lf("mr.cloud.slarti.Fetcher");this.b=0;this.f=a};Ru.prototype.execute=function(a){var c=this,b="Fetch call "+ ++this.b,d=new df(function(){return Maa(c,b,a,function(e){return d.abort(e)})},1E3,this.f?5:1);return d.start()};
var Maa=function(a,c,b,d){var e=b.uri.toString().replace(/\?.*/,"?<redacted>"),f=b.method+" "+e;C(a.m,c+": "+f);e=[uaa(b).then(function(g){return Promise.resolve(fetch(g))})];b.gh&&e.push(Qu(b.gh).then(function(){throw yt("API call timed out",504);}));return Promise.race(e).then(function(g){if(!g.ok)return g.json().then(function(m){return m},function(){return null}).then(function(m){var p;m&&m instanceof Object&&m.error&&(p=m.error);throw new xt(g,p);});var k=(u()-b.start)/1E3;C(a.m,c+" succeeded: "+
f+" duration = "+k+"s");return(k=g.headers.get("content-type"))&&k.includes("application/json")?g.json():k&&(k.includes("image")||k.includes("application/octet-stream"))?g.blob():g.text()},function(g){var k="";if(g instanceof xt)k=", ("+g.status+"): "+g.message,zaa(g)&&d(g);else{try{k=", "+JSON.stringify(g,null,2)}catch(m){}g instanceof Error&&"Failed to fetch"==g.message&&(g=yt(g.message))}Nf(a.m,c+" failed: "+k);throw g;})};var Su=function(a,c){this.b=Os.b;this.ib=a;this.f=c};var Tu=function(a,c){Su.call(this,a,c)};q(Tu,Su);Tu.prototype.register=function(a){a=new wt({method:"POST",baseUrl:this.b,Kc:["user:register"],ib:this.ib,body:{gcmId:a}});return this.f.execute(a)};Tu.prototype.unregister=function(a){a=new wt({method:"POST",baseUrl:this.b,Kc:["user:unregister"],ib:this.ib,body:{gcmId:a}});return this.f.execute(a)};var Naa=function(a,c,b){this.m=hb("mr.cloud.slarti.GcmRegistration");this.g=a;this.f=c;this.h=b;this.b=null},Oaa=function(a){if(!a.b){var c=a.f["mr.cloud.slarti.GcmRegistration.ID"];a.b=a.h.register(["307539924703"]).then(function(b){if(b==c)ob(a.m,"Slarti GCM ID unchanged: "+b);else return ob(a.m,"Got new Slarti GCM ID: "+b),(c?Uu(a,c):Promise.resolve()).then(function(){return a.g.register(b).then(function(){a.f["mr.cloud.slarti.GcmRegistration.ID"]=b})})},function(b){a.m.G("Error registering for GCM notifications",
b);c&&Uu(a,c).catch(function(d){a.m.G("Failed to unregister GCM ID with Slarti",d)});throw b;});a.b.then(function(){a.b=null},function(){a.b=null})}return a.b},Uu=function(a,c){return a.g.unregister(c).then(function(){delete a.f["mr.cloud.slarti.GcmRegistration.ID"]},function(b){a.m.G("Failed to unregister GCM ID with Slarti",b)})};var Vu=null,Wu=function(){Dp.call(this,5,"mr.cloud.slarti.GcmEventListener","mr.cloud.slarti.SinkDiscoveryService",chrome.gcm.onMessage);this.m=hb("mr.cloud.slarti.GcmEventListener")};q(Wu,Dp);Wu.prototype.ih=function(a){if(a&&"307539924703"==a.from&&"object"==typeof a.data&&"string"==typeof a.data.data){var c=JSON.parse(a.data.data);a=c.type;c=c.id;if(a)return this.m.info("Received Slarti GCM notification: "+a+" ("+c+")"),!0}return!1};var Xu=function(){null==Vu&&(Vu=new Wu);return Vu};var Yu=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];d=a;b=l(b);for(var e=b.next();!e.done;e=b.next()){if(void 0==d||"object"!=typeof d)return;d=d[e.value]}return d};var Zu=function(){Dp.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.WeaveSinkDiscoveryService",chrome.gcm.onMessage);this.m=hb("mr.WeaveGcmEventListener")};q(Zu,Dp);Zu.prototype.ih=function(a){if(!a||"919648714761"!=a.from)return!1;a=Yu(a,"data","notification");if(!a)return this.m.error("Notification json not found"),!1;try{var c=JSON.parse(a);return!!c&&Array.isArray(c.events)&&0<c.events.length}catch(b){return this.m.error("Invalid json: "+a),!1}};
var av=function(){$u||($u=new Zu);return $u},$u=null;var bv=function(a){this.b=a;this.m=hb("mr.cloud.messaging.WeaveGcmMessageHandler")};bv.prototype.onMessage=function(a){var c=this;a=JSON.parse(a.data.notification);var b=wm();a.events.forEach(function(d){if(d.deviceId){var e=xm(b,d.deviceId);switch(d.type){case "deviceCreated":Paa(c,d);break;case "deviceUpdated":Qaa(c,d,e);break;case "deviceDeleted":Raa(c.b,{sinkId:e});break;default:ob(c.m,function(){return"[unhandled event] "+JSON.stringify(d)})}}else c.m.error("Device ID not provided")})};
var Paa=function(a,c){var b=Yu(c,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof b?a.m.error("Receiver name not a string: "+b):(c=new gt(c.deviceId,b,"owner","default",!0),a=a.b,a.b.b.set(c.id,c),a.b.f=Date.now(),kt(a.f,[c.nb]))},Qaa=function(a,c,b){c=Yu(c,"statePatch","_cloudCast","appStatus");if("string"!=typeof c)a.m.error("App status not a string: "+c);else if(a=a.b,c="available"==c,b=a.b.ra(b))b.isAvailable=c||!1,a.b.f=Date.now(),lt(a.f,[b.nb])};var cv=function(a,c){this.g=a;this.f=c;this.b=new jt(this.jr.bind(this),c,2E4);this.h=new bv(this);av().addListener();cm(this);Wi("mr.cloud.discovery.WeaveSinkDiscoveryService",this)};q(cv,Mi);h=cv.prototype;h.he=function(){var a=this;jaa(this.g).then(function(c){a.g.subscribe(c)},function(){});return this.b.he().filter(function(c){return c.isAvailable})};h.ra=function(a){return this.b.ra(a)};
h.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(a==chrome.gcm.onMessage)this.h.onMessage.apply(this.h,n(b));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};
h.jr=function(){return et(this.g,{descriptionSubstring:"Chrome Streaming Receiver"}).then(function(a){return a.map(function(c){Bb("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=c.isAvailable()&&!(c.b.invitations&&0!=c.b.invitations.length);return new gt(c.getId(),c.f(),c.b.personalizedInfo.maxRole,"default",b)})})};h.Ea=function(){return"WeaveSinkDiscoveryService"};h.kb=function(){return[{cache:nt(this.b)}]};h.jb=function(){var a=$l(this);a&&ot(this.b,a.cache)};
var Raa=function(a,c){if(c=a.b.ra(c.sinkId))a.b.b.delete(c.id),a.b.f=Date.now(),mt(a.f,[c.nb])};var dv=Ha.JSON.parse,ev=Ha.JSON.stringify;var fv=function(a,c,b,d,e,f,g,k,m){W.call(this);this.f=null;this.C=!1;this.D=Bu();this.g=[];this.s=a?encodeURIComponent(String(a)):null;this.F=null;!d&&c&&(this.F=c);this.J=b||null;this.h=!d;this.j=null!=e?e:null;this.o=f||null;this.O=!!g;this.L=k||null;this.l=null!=m?m:null};q(fv,W);fv.prototype.init=function(){var a=t(function(b){this.f=b;var d=Pa("auth",b);Pa("client.request",b)&&d?this.H():b.load("client",t(this.H,this))},this),c=gv("gapi");c?a(c.gapi):Saa(this,a);return this.D.Y};
var gv=function(a){for(var c=window,b=Pa(a,c);!b&&c!=window.top&&Taa(c.parent,a);)c=c.parent,b=Pa(a,c);return b?c:null},Taa=function(a,c){try{return!!a&&null!=a.location.href&&we(a,c)}catch(b){return!1}},Saa=function(a,c){var b=gv("gapi_onload");if(b){var d=b.gapi_onload;b.gapi_onload=function(){d();c(b.gapi)}}else{window.gapi_onload=function(){c(window.gapi)};var e=document.createElement("SCRIPT");me(e,Uaa);a.L&&Xf(e,ev(a.L));document.getElementsByTagName("head")[0].appendChild(e)}};
fv.prototype.H=function(){for(var a=0;a<this.g.length;a++)this.g[a].wb.resolve(hv(this,this.g[a].requestData));this.C=!0;this.D.resolve(this.f)};fv.prototype.sendRequest=function(a){if(this.C)return hv(this,a);var c=Bu();this.g.push({requestData:a,wb:c});return c.Y};
var hv=function(a,c){var b=Pa("config.get",a.f);if(!a.h){var d=b("googleapis.config/auth/useFirstPartyAuth");var e=b("googleapis.config/auth/useOriginToken")}var f;null!=a.j&&(f=b("client/cors"));var g;null!=a.l&&(g=b("client/xd4"));try{var k=Pa("config.update",a.f);a.h||(k("googleapis.config/auth/useFirstPartyAuth",!1),k("googleapis.config/auth/useOriginToken",!1));null!=a.j&&k("client/cors",a.j);null!=a.l&&k("client/xd4",a.l);var m=Vaa(a);c.headers&&Pc(m,c.headers);var p={headers:m,root:a.J,path:c.path,
method:c.method,body:c.body},v=c.params||{};a.s&&!a.o?Pc(v,{key:a.s}):a.o&&Pc(v,{key:null});Jc(v)||(p.params=v);var A=uu(Pa("client.request",a.f)(p));c.callback&&A.then(function(G){c.callback.apply(null,[G.result,G])},function(G){c.callback.apply(null,[G.result,G])});return A}finally{b=Pa("config.update",a.f),a.h||(b("googleapis.config/auth/useFirstPartyAuth",d),b("googleapis.config/auth/useOriginToken",e)),null!=a.j&&b("client/cors",f),null!=a.l&&b("client/xd4",g)}},Vaa=function(a){if(a.h){if(a.o)return{Authorization:"Bearer "+
a.o};var c=Pa("auth.getAuthHeaderValueForFirstParty",a.f);return{Authorization:a.O?c([]):c(),"X-Goog-AuthUser":a.F}}return{}},Uaa=hd(Uc(new Tc(Rc,"https://apis.google.com/js/client.js")));var Waa=function(a){this.b=a},Ws=function(a,c,b){var d="";c.forEach(function(e){d+="/"+encodeURIComponent(e)});a=new Vr(a+d);b&&(b=ks(b),Yr(a,b));return a},Xs=function(a,c,b,d){return a.b.getAuthToken().then(function(e){var f=Xaa(e);return Yaa(f,c,b,d).catch(function(g){if("INVALID_ACCESS_ERROR"==g)return Zaa(a,e,c,b,d);throw g;})})},Zaa=function(a,c,b,d,e){return saa(c).then(function(){return Xs(a,b,d,e)})},Yaa=function(a,c,b,d){return new Promise(function(e,f){a.sendRequest($aa(c,b,function(g){g&&
!g.error?e(g):g&&401==g.error.code?f("INVALID_ACCESS_ERROR"):f(g&&g.error?g.error.errors?g.error.errors[0]:g:Error(g))},d))})},Xaa=function(a){a=new fv(void 0,void 0,void 0,!1,!1,a);a.init();return a},$aa=function(a,c,b,d){a={callback:b,method:c,path:a.toString()};d&&(a.body=d);return a};var iv={Hu:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Gu:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},jv=iv;jv=iv;var aba={AED:[2,"dh","\u062f.\u0625."],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,
"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd",
"RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"\u20ba","TRY"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var kv={zk:".",ci:",",Ok:"%",ii:"0",Ao:"+",Jk:"-",Dk:"E",Pk:"\u2030",di:"\u221e",vo:"NaN",Yn:"#,##0.###",jz:"#E0",iy:"#,##0%",Uu:"\u00a4#,##0.00",Ak:"USD"},lv=kv;lv=kv;var nv=function(){this.D=40;this.f=1;this.g=3;this.F=this.w=0;this.J=!1;this.C=this.o="";this.h=lv.Jk;this.s="";this.b=1;this.l=!1;this.j=[];this.L=this.H=!1;var a=lv.Yn;a.replace(/ /g,"\u00a0");var c=[0];this.o=mv(this,a,c);for(var b=c[0],d=-1,e=0,f=0,g=0,k=-1,m=a.length,p=!0;c[0]<m&&p;c[0]++)switch(a.charAt(c[0])){case "#":0<f?g++:e++;0<=k&&0>d&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>d&&k++;break;case ",":0<k&&this.j.push(k);k=0;break;case ".":if(0<=
d)throw Error('Multiple decimal separators in pattern "'+a+'"');d=e+f+g;break;case "E":if(this.L)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.L=!0;this.F=0;c[0]+1<m&&"+"==a.charAt(c[0]+1)&&(c[0]++,this.J=!0);for(;c[0]+1<m&&"0"==a.charAt(c[0]+1);)c[0]++,this.F++;if(1>e+f||1>this.F)throw Error('Malformed exponential pattern "'+a+'"');p=!1;break;default:c[0]--,p=!1}0==f&&0<e&&0<=d&&(f=d,0==f&&f++,g=e-f,e=f-1,f=1);if(0>d&&0<g||0<=d&&(d<e||d>e+f)||0==k)throw Error('Malformed pattern "'+
a+'"');g=e+f+g;this.g=0<=d?g-d:0;0<=d&&(this.w=e+f-d,0>this.w&&(this.w=0));this.f=(0<=d?d:g)-e;this.L&&(this.D=e+this.f,0==this.g&&0==this.f&&(this.f=1));this.j.push(Math.max(0,k));this.H=0==d||d==g;b=c[0]-b;this.C=mv(this,a,c);c[0]<a.length&&";"==a.charAt(c[0])?(c[0]++,1!=this.b&&(this.l=!0),this.h=mv(this,a,c),c[0]+=b,this.s=mv(this,a,c)):(this.h+=this.o,this.s+=this.C)};
nv.prototype.parse=function(a,c){c=c||[0];a=a.replace(/ |\u202f/g,"\u00a0");var b=a.indexOf(this.o,c[0])==c[0],d=a.indexOf(this.h,c[0])==c[0];b&&d&&(this.o.length>this.h.length?d=!1:this.o.length<this.h.length&&(b=!1));b?c[0]+=this.o.length:d&&(c[0]+=this.h.length);if(a.indexOf(lv.di,c[0])==c[0]){c[0]+=lv.di.length;var e=Infinity}else{e=a;var f=!1,g=!1,k=!1,m=-1,p=1,v=lv.zk,A=lv.ci,G=lv.Dk;A=A.replace(/\u202f/g,"\u00a0");for(var F="";c[0]<e.length;c[0]++){var P=e.charAt(c[0]),fa=ov(P);if(0<=fa&&9>=
fa)F+=fa,k=!0;else if(P==v.charAt(0)){if(f||g)break;F+=".";f=!0}else if(P==A.charAt(0)&&("\u00a0"!=A.charAt(0)||c[0]+1<e.length&&0<=ov(e.charAt(c[0]+1)))){if(f||g)break}else if(P==G.charAt(0)){if(g)break;F+="E";g=!0;m=c[0]}else if("+"==P||"-"==P){if(k&&m!=c[0]-1)break;F+=P}else if(1==this.b&&P==lv.Ok.charAt(0)){if(1!=p)break;p=100;if(k){c[0]++;break}}else if(1==this.b&&P==lv.Pk.charAt(0)){if(1!=p)break;p=1E3;if(k){c[0]++;break}}else break}1!=this.b&&(p=this.b);e=parseFloat(F)/p}if(b){if(a.indexOf(this.C,
c[0])!=c[0])return NaN;c[0]+=this.C.length}else if(d){if(a.indexOf(this.s,c[0])!=c[0])return NaN;c[0]+=this.s.length}return d?-e:e};
nv.prototype.format=function(a){if(isNaN(a))return lv.vo;var c=[];var b=bba;a=pv(a,-b.kq);c.push(b.prefix);var d=0>a||0==a&&0>1/a;c.push(d?this.h:this.o);if(isFinite(a))if(a=a*(d?-1:1)*this.b,this.L)if(0==a)qv(this,a,this.f,c),rv(this,0,c);else{var e=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=pv(a,-e);var f=this.f;1<this.D&&this.D>this.f?(f=e%this.D,0>f&&(f=this.D+f),a=pv(a,f),e-=f,f=1):1>this.f?(e++,a=pv(a,-1)):(e-=this.f-1,a=pv(a,this.f-1));qv(this,a,f,c);rv(this,e,c)}else qv(this,a,this.f,c);
else c.push(lv.di);c.push(d?this.s:this.C);c.push(b.rt);return c.join("")};
var qv=function(a,c,b,d){if(a.w>a.g)throw Error("Min value must be less than max value");d||(d=[]);var e=pv(c,a.g);e=Math.round(e);if(isFinite(e)){c=Math.floor(pv(e,-a.g));var f=Math.floor(e-pv(c,a.g))}else f=0;e=c;c=f;var g=e;f=c;var k=0<a.w||0<f||!1;e=a.w;k&&(e=a.w);var m="";for(c=g;1E20<c;)m="0"+m,c=Math.round(pv(c,-1));m=c+m;var p=lv.zk;c=lv.ii.charCodeAt(0);var v=m.length,A=0;if(0<g||0<b){for(g=v;g<b;g++)d.push(String.fromCharCode(c));if(2<=a.j.length)for(b=1;b<a.j.length;b++)A+=a.j[b];b=v-A;
if(0<b){g=a.j;A=v=0;for(var G,F=lv.ci,P=m.length,fa=0;fa<P;fa++)if(d.push(String.fromCharCode(c+1*Number(m.charAt(fa)))),1<P-fa)if(G=g[A],fa<b){var Wa=b-fa;(1===G||0<G&&1===Wa%G)&&d.push(F)}else A<g.length&&(fa===b?A+=1:G===fa-b-v+1&&(d.push(F),v+=G,A+=1))}else{b=m;m=a.j;g=lv.ci;G=b.length;F=[];for(v=m.length-1;0<=v&&0<G;v--){A=m[v];for(P=0;P<A&&0<=G-P-1;P++)F.push(String.fromCharCode(c+1*Number(b.charAt(G-P-1))));G-=A;0<G&&F.push(g)}d.push.apply(d,F.reverse())}}else k||d.push(String.fromCharCode(c));
(a.H||k)&&d.push(p);k=String(f);f=k.split("e+");if(2==f.length){if(k=parseFloat(f[0])){p=k;if(isFinite(p)){for(b=0;1<=(p/=10);)b++;p=b}else p=0<p?p:0;p=0-p-1;k=-1>p?k&&isFinite(k)?pv(Math.round(pv(k,-1)),1):k:k&&isFinite(k)?pv(Math.round(pv(k,p)),-p):k}k=String(k);k=k.replace(".","");k+=ne("0",parseInt(f[1],10)-k.length+1)}a.g+1>k.length&&(k="1"+ne("0",a.g-k.length)+k);for(a=k.length;"0"==k.charAt(a-1)&&a>e+1;)a--;for(g=1;g<a;g++)d.push(String.fromCharCode(c+1*Number(k.charAt(g))))},rv=function(a,
c,b){b.push(lv.Dk);0>c?(c=-c,b.push(lv.Jk)):a.J&&b.push(lv.Ao);c=""+c;for(var d=lv.ii,e=c.length;e<a.F;e++)b.push(d);b.push(c)},ov=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var c=lv.ii.charCodeAt(0);return c<=a&&a<c+10?a-c:-1},mv=function(a,c,b){for(var d="",e=!1,f=c.length;b[0]<f;b[0]++){var g=c.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==c.charAt(b[0]+1)?(b[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return d;case "\u00a4":b[0]+1<f&&"\u00a4"==
c.charAt(b[0]+1)?(b[0]++,d+=lv.Ak):d+=aba[lv.Ak][1];break;case "%":if(!a.l&&1!=a.b)throw Error("Too many percent/permill");if(a.l&&100!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=100;a.l=!1;d+=lv.Ok;break;case "\u2030":if(!a.l&&1!=a.b)throw Error("Too many percent/permill");if(a.l&&1E3!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=1E3;a.l=!1;d+=lv.Pk;break;default:d+=g}}return d},bba={prefix:"",rt:"",kq:0},pv=function(a,c){if(!a||!isFinite(a)||0==
c)return a;a=String(a).split("e");return parseFloat(a[0]+"e"+(parseInt(a[1]||0,10)+c))};var sv=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},tv=sv;tv=sv;var uv=function(a,c){if(void 0===c){c=a+"";var b=c.indexOf(".");c=Math.min(-1==b?0:c.length-b-1,3)}return 1==(a|0)&&0==c?"one":"other"},vv=uv;vv=uv;var zv=function(){this.h=cba;this.f=this.b=this.j=null;var a=lv,c=jv;if(wv!==a||xv!==c)wv=a,xv=c,yv=new nv;this.w=yv},wv=null,xv=null,yv=null,dba=/'([{}#].*?)'/g,eba=/''/g;zv.prototype.format=function(a){if(this.h){this.j=[];var c=fba(this,this.h);this.f=Av(this,c);this.h=null}if(this.f&&0!=this.f.length)for(this.b=z(this.j),c=[],Bv(this,this.f,a,!1,c),a=c.join("");0<this.b.length;)a=a.replace(this.g(this.b),this.b.pop());else a="";return a};
var Bv=function(a,c,b,d,e){for(var f=0;f<c.length;f++)switch(c[f].type){case 4:e.push(c[f].value);break;case 3:var g=c[f].value,k=a,m=e,p=b[g];Ia(p)?(k.b.push(p),m.push(k.g(k.b))):m.push("Undefined parameter - "+g);break;case 2:g=c[f].value;k=e;m=g.th;Ia(b[m])?(m=g[b[m]],Ia(m)||(m=g.other),Bv(a,m,b,d,k)):k.push("Undefined parameter - "+m);break;case 0:g=c[f].value;Cv(a,g,b,vv,d,e);break;case 1:g=c[f].value;Cv(a,g,b,tv,d,e);break;default:Hb("Unrecognized block type: "+c[f].type)}},Cv=function(a,c,
b,d,e,f){var g=c.th,k=c.ol,m=+b[g];isNaN(m)?f.push("Undefined or invalid parameter - "+g):(k=m-k,g=c[b[g]],Ia(g)||(d=d(k),g=c[d],Ia(g)||(g=c.other)),c=[],Bv(a,g,b,e,c),b=c.join(""),e?f.push(b):(a=a.w.format(k),f.push(b.replace(/#/g,a))))},fba=function(a,c){var b=a.j,d=t(a.g,a);c=c.replace(eba,function(){b.push("'");return d(b)});return c=c.replace(dba,function(e,f){b.push(f);return d(b)})},Dv=function(a){var c=0,b=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(b.pop(),
0==b.length&&(f={type:1},f.value=a.substring(c,g),d.push(f),c=g+1)):(0==b.length&&(c=a.substring(c,g),""!=c&&d.push({type:0,value:c}),c=g+1),b.push("{"))}c=a.substring(c);""!=c&&d.push({type:0,value:c});return d},Ev=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Fv=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Gv=/^\s*(\w+)\s*,\s*select\s*,/,Av=function(a,c){var b=[];c=Dv(c);for(var d=0;d<c.length;d++){var e={};if(0==c[d].type)e.type=4,e.value=c[d].value;else if(1==c[d].type){var f=c[d].value;switch(Ev.test(f)?
0:Fv.test(f)?1:Gv.test(f)?2:/^\s*\w+\s*/.test(f)?3:5){case 2:e.type=2;e.value=gba(a,c[d].value);break;case 0:e.type=0;e.value=hba(a,c[d].value);break;case 1:e.type=1;e.value=iba(a,c[d].value);break;case 3:e.type=3;e.value=c[d].value;break;default:Hb("Unknown block type for pattern: "+c[d].value)}}else Hb("Unknown part of the pattern.");b.push(e)}return b},gba=function(a,c){var b="";c=c.replace(Gv,function(k,m){b=m;return""});var d={};d.th=b;c=Dv(c);for(var e=0;e<c.length;){var f=c[e].value;e++;if(1==
c[e].type)var g=Av(a,c[e].value);else Hb("Expected block type.");d[f.replace(/\s/g,"")]=g;e++}return d},hba=function(a,c){var b="",d=0;c=c.replace(Ev,function(m,p,v){b=p;v&&(d=parseInt(v,10));return""});var e={};e.th=b;e.ol=d;c=Dv(c);for(var f=0;f<c.length;){var g=c[f].value;f++;if(1==c[f].type)var k=Av(a,c[f].value);else Hb("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e},iba=function(a,c){var b="";c=c.replace(Fv,function(k,m){b=m;return""});var d={};d.th=b;d.ol=0;c=
Dv(c);for(var e=0;e<c.length;){var f=c[e].value;e++;if(1==c[e].type)var g=Av(a,c[e].value);else Hb("Expected block type.");d[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return d};zv.prototype.g=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var Hv=chrome.i18n.getMessage("1522140683318860351"),Iv=chrome.i18n.getMessage("4246483347873264186"),Jv=chrome.i18n.getMessage("5991427458288444010"),ii=chrome.i18n.getMessage("6063910461797960050"),jba=chrome.i18n.getMessage("7735695102441495789"),kba=chrome.i18n.getMessage("4575332923598659024"),cba=chrome.i18n.getMessage("2297080986956220930"),Kv=new zv;var lba=function(a){this.b=a;this.m=hb("mr.cloud.mesi.MesiService")},paa=function(a){var c=Ws(Qs.b,["hangouts","search"]);a.m.info("Retrieving Hangouts from MESI: "+c);return Xs(a.b,c,"POST",mba).then(function(b){var d=[];b.result&&(d=b.result.map(function(e){var f=e.hangout,g=f.meeting_room_name,k;f.meeting_domain?k=f.meeting_domain:"BUSINESS"==f.type&&f.company_title&&(k=f.company_title.toLowerCase());var m=Kv.format({ORGANIZER:"",PARTICIPANTS:0});if((e=e.participant)&&0<e.length){var p=e[0].display_name;
m=e.reduce(function(v,A){v.add(A.user_id);"ORGANIZER"==A.role&&(p=A.display_name);return v},new Set);m=Kv.format({ORGANIZER:p,PARTICIPANTS:m.size})}return g&&k?new Ss(!1,g+"@"+k,k,g,m,f.hangout_id):new Ss(!1,f.hangout_id,k,g,m,f.hangout_id)}));return d})},mba={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var nba=function(a,c){this.f=a;this.b=c},oba=function(a,c,b,d){switch(c.type){case "REFRESH_AUTH":var e=d.Jd,f=d.deviceId,g=d.fh;return taa(a.f).then(function(){Lv(a.b,new wj("AUTH_READY",{Jd:e,eb:f,fh:g}),b.id)});case "STATUS_REQUEST":return Lv(a.b,c,b.id),Promise.resolve();case "STATUS_RESPONSE":return Lv(a.b,c,b.id,!0),c.data.routeDescription||Lv(a.b,c,b.id),Promise.resolve();case "HANGOUT_INACTIVE":return Mv(a.b,b,4,mi(new hi(jba,"warning"),b.sinkId));case "HANGOUT_INVALID":return Mv(a.b,b,3,
mi(new hi(kba,"warning"),b.sinkId));default:return Promise.reject(Error("Unknown type: "+c.type))}};var Nv=new Map([["status","status"],["results","result"],["expirationTime","expiration_time"]]),Ov=function(a,c){Su.call(this,a,c);this.m=Lf("mr.cloud.slarti.CommandsService")};q(Ov,Su);Ov.prototype.get=function(a){a=new wt({method:"GET",baseUrl:this.b,Kc:["commands",a],ib:this.ib});return this.f.execute(a).then(function(c){return c})};
Ov.prototype.list=function(a){a=new wt({method:"GET",baseUrl:this.b,Kc:["commands"],Ym:{deviceId:a},ib:this.ib});return this.f.execute(a).then(function(c){return c.command||[]})};Ov.prototype.send=function(a,c){var b=this;a=new wt({method:"POST",baseUrl:this.b,Kc:["commands:send"],ib:this.ib,body:{command:c,deviceId:a}});return this.f.execute(a).then(function(d){b.m.info("Sent Slarti command with ID "+d.id);return d})};
Ov.prototype.update=function(a,c){for(var b=[],d={},e=l(Nv.keys()),f=e.next();!f.done;f=e.next())f=f.value,c[f]&&(d[f]=c[f],b.push(Nv.get(f)));d.id=a;a=new wt({method:"PUT",baseUrl:this.b,Kc:["commands",a],ib:this.ib,body:{command:d,updateMask:b}});return this.f.execute(a).then(function(g){return g})};var pba=Ha.JSON.parse;var Pv=function(){};Pv.prototype.b=null;Pv.prototype.getOptions=function(){var a;(a=this.b)||(a={},Qv(this)&&(a[0]=!0,a[1]=!0),a=this.b=a);return a};var Rv,Sv=function(){};x(Sv,Pv);var Tv=function(a){return(a=Qv(a))?new ActiveXObject(a):new XMLHttpRequest},Qv=function(a){if(!a.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var c=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],b=0;b<c.length;b++){var d=c[b];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.f};Rv=new Sv;var Uv=function(a){Y.call(this);this.headers=new Lm;this.V=a||null;this.g=!1;this.T=this.f=null;this.fa=this.J="";this.o=0;this.h="";this.j=this.ha=this.H=this.Z=!1;this.l=0;this.C=null;this.s="";this.O=this.F=!1};x(Uv,Y);Uv.prototype.m=Lf("goog.net.XhrIo");var qba=/^https?$/i,rba=["POST","PUT"],Vv=[],Wv=function(a,c,b,d,e,f,g){var k=new Uv;Vv.push(k);c&&k.listen("complete",c);Ut(k,"ready",k.qa);f&&(k.l=Math.max(0,f));g&&(k.F=g);k.send(a,b,d,e);return k};
Uv.prototype.qa=function(){this.ab();ac(Vv,this)};
Uv.prototype.send=function(a,c,b,d){if(this.f)throw Error("[goog.net.XhrIo] Object is active with another request="+this.J+"; newUri="+a);c=c?c.toUpperCase():"GET";this.J=a;this.h="";this.o=0;this.fa=c;this.Z=!1;this.g=!0;this.f=this.V?Tv(this.V):Tv(Rv);this.T=this.V?this.V.getOptions():Rv.getOptions();this.f.onreadystatechange=t(this.pa,this);try{Of(this.m,Xv(this,"Opening Xhr")),this.ha=!0,this.f.open(c,String(a),!0),this.ha=!1}catch(f){Of(this.m,Xv(this,"Error opening Xhr: "+f.message));Yv(this,
f);return}a=b||"";var e=this.headers.clone();d&&Dn(d,function(f,g){e.set(g,f)});d=Sb(e.Ab(),sba);b=Ha.FormData&&a instanceof Ha.FormData;!Ub(rba,c)||d||b||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(f,g){this.f.setRequestHeader(g,f)},this);this.s&&(this.f.responseType=this.s);"withCredentials"in this.f&&this.f.withCredentials!==this.F&&(this.f.withCredentials=this.F);try{Zv(this),0<this.l&&(this.O=tba(this.f),Of(this.m,Xv(this,"Will abort after "+this.l+
"ms if incomplete, xhr2 "+this.O)),this.O?(this.f.timeout=this.l,this.f.ontimeout=t(this.ua,this)):this.C=Ou(this.ua,this.l,this)),Of(this.m,Xv(this,"Sending request")),this.H=!0,this.f.send(a),this.H=!1}catch(f){Of(this.m,Xv(this,"Send error: "+f.message)),Yv(this,f)}};var tba=function(a){return Be&&Ve(9)&&r(a.timeout)&&Ia(a.ontimeout)},sba=function(a){return jd("Content-Type",a)};
Uv.prototype.ua=function(){"undefined"!=typeof Fa&&this.f&&(this.h="Timed out after "+this.l+"ms, aborting",this.o=8,Of(this.m,Xv(this,this.h)),this.N("timeout"),this.abort(8))};var Yv=function(a,c){a.g=!1;a.f&&(a.j=!0,a.f.abort(),a.j=!1);a.h=c;a.o=5;$v(a);aw(a)},$v=function(a){a.Z||(a.Z=!0,a.N("complete"),a.N("error"))};Uv.prototype.abort=function(a){this.f&&this.g&&(Of(this.m,Xv(this,"Aborting")),this.g=!1,this.j=!0,this.f.abort(),this.j=!1,this.o=a||7,this.N("complete"),this.N("abort"),aw(this))};
Uv.prototype.ia=function(){this.f&&(this.g&&(this.g=!1,this.j=!0,this.f.abort(),this.j=!1),aw(this,!0));Uv.Ra.ia.call(this)};Uv.prototype.pa=function(){this.w()||(this.ha||this.H||this.j?bw(this):this.Aa())};Uv.prototype.Aa=function(){bw(this)};
var bw=function(a){if(a.g&&"undefined"!=typeof Fa)if(a.T[1]&&4==cw(a)&&2==a.Wa())Of(a.m,Xv(a,"Local request error detected and ignored"));else if(a.H&&4==cw(a))Ou(a.pa,0,a);else if(a.N("readystatechange"),4==cw(a)){Of(a.m,Xv(a,"Request complete"));a.g=!1;try{if(dw(a))a.N("complete"),a.N("success");else{a.o=6;try{var c=2<cw(a)?a.f.statusText:""}catch(b){Of(a.m,"Can not get status: "+b.message),c=""}a.h=c+" ["+a.Wa()+"]";$v(a)}}finally{aw(a)}}},aw=function(a,c){if(a.f){Zv(a);var b=a.f,d=a.T[0]?Qa:null;
a.f=null;a.T=null;c||a.N("ready");try{b.onreadystatechange=d}catch(e){Nf(a.m,"Problem encountered resetting onreadystatechange: "+e.message)}}},Zv=function(a){a.f&&a.O&&(a.f.ontimeout=null);a.C&&(Pu(a.C),a.C=null)},dw=function(a){var c=a.Wa();a:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1}if(!b){if(c=0===c)a=String(a.J).match(Pr)[1]||null,!a&&Ha.self&&Ha.self.location&&(a=Ha.self.location.protocol,a=a.substr(0,a.length-1)),c=!qba.test(a?a.toLowerCase():
"");b=c}return b},cw=function(a){return a.f?a.f.readyState:0};Uv.prototype.Wa=function(){try{return 2<cw(this)?this.f.status:-1}catch(a){return-1}};
var ew=function(a){try{return a.f?a.f.responseText:""}catch(c){return Of(a.m,"Can not get responseText: "+c.message),""}},uba=function(a){if(a.f)return pba(a.f.responseText)},vba=function(a){try{if(!a.f)return null;if("response"in a.f)return a.f.response;switch(a.s){case "":case "text":return a.f.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.f)return a.f.mozResponseArrayBuffer}Nf(a.m,"Response type "+a.s+" is not supported on this browser");return null}catch(c){return Of(a.m,"Can not get response: "+
c.message),null}};Uv.prototype.getResponseHeader=function(a){if(this.f&&4==cw(this))return a=this.f.getResponseHeader(a),null===a?void 0:a};var wba=function(a){var c={};a=(a.f&&4==cw(a)?a.f.getAllResponseHeaders()||"":"").split("\r\n");for(var b=0;b<a.length;b++)if(!kd(a[b])){var d=se(a[b],":",1),e=d[0];d=d[1];if(Ja(d)){d=d.trim();var f=c[e]||[];c[e]=f;f.push(d)}}return zc(c,function(g){return g.join(", ")})},Xv=function(a,c){return c+" ["+a.fa+" "+a.J+" "+a.Wa()+"]"};var xba=function(){this.m=hb("mr.cloud.CredentialService")},fw=function(a){var c=new Db,b=Rs.b+"/iceconfig?key="+Rs.f;a.m.info("Requesting TURN credentials from "+b);var d=Wv(b,function(){dw(d)?(a.m.info("Got TURN credentials: "+ew(d)),c.resolve(yba(a,uba(d)))):c.resolve(zba(a))},"POST",void 0,{"Content-Type":"application/json"});return c.b},yba=function(a,c){try{var b=[];c.iceServers.forEach(function(d){d.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:d.credential,username:d.username})})});
return b}catch(d){return a.m.error("Error parsing TURN credentials.",d),[]}},zba=function(a){a.m.error("XHR failed fetching TURN credentials.",null);return[]};var Aba=function(a,c,b){this.m=hb("mr.cloud.slarti.MessageHandler");this.g=a;this.h=c;this.b=b;this.f=new Map},Bba=function(a){if(aj(a.mediaSource))return Promise.resolve({title:"screen"});var c=a.pb&&a.pb.tabId;return null==c?Promise.resolve({title:"",url:""}):new Promise(function(b){chrome.tabs.get(c,function(d){b({title:d&&d.title||"",url:d&&d.url||""})})})},Cba=function(a,c,b,d){var e=d.deviceId,f=c.data;return Bba(b).then(function(g){g={id:null,issuer:null,name:"stream",status:null,results:null,
expirationTime:null,parameters:JSON.stringify({info:g,sessionDescription:f.description,mediaConstraints:f.mediaConstraints,settings:f.settings})};return a.g.send(e,g).then(function(k){return new Promise(function(m,p){a.f.set(k.id,{routeId:b.id,sinkId:d.id,resolve:m,reject:p,Mq:"PENDING_APPROVAL"==k.status})})},function(){Mv(a.b,b.id,7,mi(li(ki(new hi(Hv,"warning")),b.id),d.id))})})},Dba=function(a,c){return fw(a.h).then(function(b){Lv(a.b,new wj("TURN_CREDENTIALS",{credentials:b}),c.id)})};var Eba=function(a,c,b,d){this.f=a;this.g=c;this.h=b;this.b=d},Hba=function(a,c,b,d,e){return new Promise(function(f){switch(c){case "slarti":case "weave":case "mesi":break;default:throw Error("Unrecognized channel type: "+c);}if(!b.type)throw Error("Message has no type");switch(b.type){case "STOP":f(Mv(a.b,d,1,null));return;case "SESSION_START_SUCCESS":Js(0);break;case "SESSION_END":break;case "SESSION_FAILURE":Js(1);f(Mv(a.b,d,2,mi(new hi(Hv,"warning"),d?d.sinkId:"")));return;case "__webrtc_stats__":break;
case "PRESENTATION_CONNECTION_MESSAGE":Lv(a.b,b.data,d.id,!0);break;case "OFFER":switch(c){case "slarti":f(Cba(a.f,b,d,e));return;case "weave":f(Fba(a.g,b,d,e));return;default:throw Error("Unexpected channel type: "+c);}case "GET_TURN_CREDENTIALS":switch(c){case "slarti":f(Dba(a.f,d));return;case "weave":f(Gba(a.g,d));return;default:throw Error("Unexpected channel type: "+c);}case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":f(oba(a.h,
b,d,e));return;case "new_session":Lv(a.b,b,d.id,!0);break;case "remove_session":Lv(a.b,b,d.id,!0);a.b.terminateRoute(d.id);break;default:throw Error("Unknown type: "+b.type);}f()})};var gw=function(a,c,b){this.state=a;this.type=null!=c?c:null;this.results=null!=b?b:null},hw=function(a){this.b=a},Iba=function(a,c,b,d){return iw(a,faa,c,b,d,35E3).then(function(e){return jw(a,e)})},Jba=function(a,c,b,d){return iw(a,gaa,c,b,d,23E3).then(function(e){var f=e.state;return"done"==f?(e=kw(e),new gw(f,e.type,new at(e.sessionDescription))):new gw(f)})},iw=function(a,c,b,d,e,f){var g={_webrtcMessage:JSON.stringify(d.presentationUrl?new at(d.description,null,d.presentationUrl,d.presentationId):
new at(d.description))};d.settings&&(g._settings=tj(d.settings));d.mediaConstraints&&(g._optMediaConstraints=JSON.stringify(d.mediaConstraints));e&&(g._user=JSON.stringify(e));return lw(a,b,c,g,f)},jw=function(a,c){var b=c.state;switch(b){case "done":return Promise.resolve(Kba(c));case "queued":case "inProgress":return Lba(a,c).then(function(d){return jw(a,d)});default:return Promise.resolve(new gw(b))}},Lba=function(a,c){return new Promise(function(b){var d=setInterval(function(){Mba(a,c.id).then(function(e){"queued"!=
e.state&&"inProgress"!=e.state&&(clearInterval(d),b(e))})},2E3)})},Kba=function(a){a=kw(a);return"__cloud_webrtc_session_message__"==a.type?new gw("done","knocking_cloud_webrtc_session_message",new at(a.sessionDescription)):new gw("done",a.type)},lw=function(a,c,b,d,e){c={deviceId:c,name:"_cloudCast."+b.name,parameters:d,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=Ws(Ns.b,["commands"],b);return Xs(a.b,e,"POST",c)},kw=function(a){return a.results&&a.results.results?
JSON.parse(a.results.results):null},Mba=function(a,c){c=Ws(Ns.b,["commands",c]);return Xs(a.b,c,"GET")};hw.$inject=["gapiService"];var Nba=function(a,c,b,d){this.f=a;this.g=c;this.h=b;this.b=d},Fba=function(a,c,b,d){return Oba(a,c,d).then(function(e){a:{var f=b.id;if("done"!=e.state)f=Promise.reject(Error("Offer not executed by receiver. State: "+e.state));else{switch(e.type){case "__cloud_webrtc_session_message__":e=new wj("ANSWER",e.results.sessionDescription);Lv(a.b,e,f);break;case "knocking_cloud_webrtc_session_message":Is(0);e=new wj("KNOCK_ANSWER",e.results.sessionDescription);Lv(a.b,e,f);break;case "knock_denied":Is(1);
mw(a,Iv,f);break;case "knock_timeout":Is(2);mw(a,Jv,f);break;default:f=Promise.reject(Error("Invalid message type: "+e.type));break a}f=Promise.resolve()}}return f})},Gba=function(a,c){return fw(a.h).then(function(b){Lv(a.b,new wj("TURN_CREDENTIALS",{credentials:b}),c.id)})},Oba=function(a,c,b){var d=b.deviceId,e=a.g.b;e=e?new daa(e):void 0;c=c.data;switch(b.pi){case "owner":Ls(0);break;case "manager":Ls(1);break;case "user":Ls(2);break;case "viewer":Ls(3)}return"viewer"==b.pi?Iba(a.f,d,c,e):Jba(a.f,
d,c,e)},mw=function(a,c,b){c=new hi(c,"warning");ki(c);a.b.b.cf(c);Lv(a.b,new wj("STOP"),b)};var Pba=function(){var a=this;this.m=hb("mr.cloud.settings.SettingsService");this.b=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(c){Zi(13);if(a.b){c=l(c);for(var b=c.next();!b.done;b=c.next())if(b=b.value,"media_router.cloudservices.enabled"==b.key){a.b.call(null,b.value);break}}})},Qba=function(a,c){a.b=c},Rba=function(a){var c=a.m;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&c.G("Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})},
Sba=function(a){return nw().catch(function(){return nw().catch(function(c){a.m.G("Error retrieving cloud on setting.",c);return!1})})},nw=function(){return ow("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})},ow=function(a){return new Promise(function(c,b){chrome.storage.sync.get(a,function(d){chrome.runtime.lastError?b(chrome.runtime.lastError):c(d)})})},Tba=function(a){return pw().catch(function(){return pw().catch(function(c){a.m.G("Error retrieving cloud enabled setting.",
c);return!1})})},pw=function(){return Uba().then(function(a){return!!a.value})},Uba=function(){return new Promise(function(a,c){chrome.settingsPrivate.getPref("media_router.cloudservices.enabled",function(b){chrome.runtime.lastError?c(chrome.runtime.lastError):a(b)})})},Vba=function(a){var c=a.m;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&c.G("Error setting notified Hangout privacy.",chrome.runtime.lastError)})},Wba=function(a){return qw().catch(function(){return qw().catch(function(c){a.m.G("Error retrieving hangouts notified setting.",
c);return!1})})},qw=function(){return ow("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var rw=new Map([["displayName","display_name"],["description","description"],["type","type"],["status","status"],["state","state"],["commandDefs","command_defs"]]),sw=function(a,c){Su.call(this,a,c)};q(sw,Su);h=sw.prototype;h.act=function(a,c){a=new wt({method:"POST",baseUrl:this.b,Kc:["devices:act"],ib:this.ib,body:{gcmId:c,id:a}});return this.f.execute(a).then(function(b){return b})};h.create=function(a){a=new wt({method:"POST",baseUrl:this.b,Kc:["devices"],ib:this.ib,body:a});return this.f.execute(a).then(function(c){return c})};
h.delete=function(a){a=new wt({method:"DELETE",baseUrl:this.b,Kc:["devices",a],ib:this.ib});return this.f.execute(a)};h.get=function(a){a=new wt({method:"GET",baseUrl:this.b,Kc:["devices",a],ib:this.ib});return this.f.execute(a).then(function(c){return c})};
h.list=function(a){var c=a.type,b=a.status;a=a.permission;var d={};c&&(d.type=c);b&&(d.status=b);a&&(d.permission=a);c=new wt({method:"GET",baseUrl:this.b,Kc:["devices"],Ym:d,ib:this.ib});return this.f.execute(c).then(function(e){return e.device||[]})};h.update=function(a,c){for(var b=[],d={},e=l(rw.keys()),f=e.next();!f.done;f=e.next())f=f.value,c[f]&&(d[f]=c[f],b.push(rw.get(f)));d.id=a;a=new wt({method:"PUT",baseUrl:this.b,Kc:["devices",a],ib:this.ib,body:{device:d,updateMask:b}});return this.f.execute(a).then(function(g){return g})};var tw=function(a,c,b,d,e,f){f=void 0===f?null:f;this.m=hb("mr.cloud.slarti.SinkDiscoveryService");this.w=a;this.g=c;this.f=b;this.j=d;this.h=e;this.b=f||new jt(this.l.bind(this),b,36E5);Xu().addListener();cm(this);Wi("mr.cloud.slarti.SinkDiscoveryService",this)};q(tw,Mi);tw.prototype.he=function(){Oaa(this.h).catch(function(){});return this.b.he().filter(function(a){return a.isAvailable})};tw.prototype.ra=function(a){return this.b.ra(a)};
tw.prototype.handleEvent=function(a,c){if(a!=chrome.gcm.onMessage)throw Error("Unhandled event: expected chrome.gcm.onMessage");Xba(this,c)};
var Xba=function(a,c){var b=JSON.parse(c.data.data);a.m.info("Received Slarti GCM notification: "+b.type);ob(a.m,function(){return"Got notification: "+JSON.stringify(b)});switch(b.type){case "DEVICE_ADDED":uw(a,b).then(function(d){"cast-receiver"==d.type&&(d=new it(d.id,d.displayName,"ONLINE"==d.status),a.b.b.set(d.id,d),kt(a.f,[d.nb]))});break;case "DEVICE_CHANGED":uw(a,b).then(function(d){if("cast-receiver"==d.type){var e=xm(wm(),d.id);if(e=a.b.ra(e))e.displayName=d.displayName,e.isAvailable="ONLINE"==
d.status,lt(a.f,[e.nb])}});break;case "DEVICE_REMOVED":Yba(a,Zba(b));Promise.resolve();break;case "COMMAND_CHANGED":$ba(a,b).then(function(d){var e=a.j,f=d.id,g=e.f.get(f);if(g){var k=g.routeId,m=g.sinkId,p=g.resolve,v=g.reject,A=g.Mq;g=!0;try{var G=JSON.parse(d.results||"{}"),F=G.sessionDescription,P=G.errorCode,fa=G.errorText;switch(d.status){case "SUCCESS":p(Lv(e.b,new wj("ANSWER",F),k));A&&Is(0);break;case "ERROR":case "TIMEOUT":var Wa="TIMEOUT"==d.status;p=Hv;"KNOCK_DENIED"==P&&(Is(Wa?2:1),p=
Wa?Jv:Iv);Mv(e.b,k,7,mi(li(ki(new hi(p,"warning")),k),m));throw Error("Slarti command "+f+" failed with status: "+(d.status+", errorCode: "+P+", ")+("errorText: "+fa));default:g=!1}}catch(Fc){v(Fc)}finally{g&&e.f.delete(f)}}else e.m.G("Received update to unknown command with "+("name = "+d.name+" and id = "+f))});break;default:Promise.resolve()}};
tw.prototype.l=function(){return this.g.list({type:"cast-receiver"}).then(function(a){return a.map(function(c){return new it(c.id,c.displayName,"ONLINE"==c.status)})})};tw.prototype.Ea=function(){return"SlartiSinkDiscoveryService"};tw.prototype.kb=function(){return[{cache:nt(this.b)}]};tw.prototype.jb=function(){var a=$l(this);a&&ot(this.b,a.cache)};
var Yba=function(a,c){c=xm(wm(),c);var b=a.b.ra(c);b&&(a.b.b.delete(c),mt(a.f,[b.nb]))},Zba=function(a){a=a.deviceInfo;return a.device?a.device.id:a.deviceId},uw=function(a,c){c=c.deviceInfo;return c.device?Promise.resolve(c.device):a.g.get(c.deviceId)},$ba=function(a,c){c=c.commandInfo;return c.command?Promise.resolve(c.command):a.w.get(c.commandId)};var vw=function(){this.b=null},ww=function(a,c){if(!a.b||O(a.b,2)<O(c,2))a.b=Al(c)},xw=function(a){return a.b?O(a.b,2)+";"+O(a.b,1):null};var yw=function(){this.D=this.w=this.J=this.L=this.F=this.C=this.g=this.s=this.h=this.f=this.j=this.fa=this.ha=this.V=this.H=this.Va=this.Z=this.T=this.O=this.l=this.o=this.b=null},zw=function(){var a=yw.Ia();null==a.w&&(a.w=new vw);return a.w},Aw=function(a){null==a.b&&(a.b=new tt);return a.b},Bw=function(a){null==a.o&&(a.o=new Waa(Aw(a)));return a.o},Cw=function(a){null==a.l&&(a.l=new Ru);return a.l},Dw=function(a){null==a.O&&(a.O=new Ov(Aw(a),Cw(a)));return a.O},Fw=function(a,c){null==a.H&&(a.H=
new Aba(Dw(a),Ew(a),c));return a.H},Gw=function(a){null==a.s&&(a.s=new hw(Bw(a)));return a.s},Ew=function(a){null==a.J&&(a.J=new xba(Bw(a)));return a.J},Hw=function(a){null==a.D&&(a.D=new $s);return a.D};Ra(yw);var Jw=function(a,c){this.g=a;this.w=c;this.j=new Db;this.ja=this.j.b;this.b=Iw(a.id);this.f=new Db;this.h=!1;aca(this);bca(this);this.b.sendMessage(new wj("GET_TURN_CREDENTIALS"))};Jw.prototype.start=function(){var a=this;return this.ja.then(function(c){if(c.b)return Promise.reject(Error("Presentation already started"));c.start();return a.f.b})};Jw.prototype.stop=function(){var a=this;this.h=!1;return this.ja.then(function(c){c.stop();a.ja=Promise.reject(Error("Peer connection has already been stopped"))})};
var aca=function(a){a.b.onMessage=function(c){if(c.type)switch(c.type){case "TURN_CREDENTIALS":a.j.resolve(new Bj(a.g.id,c.data.credentials));break;case "ANSWER":a.ja.then(function(b){Jj(b,c.data)});break;case "STOP":a.f.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+c.type);}else a.ja.then(function(b){var d={type:"PRESENTATION_CONNECTION_MESSAGE",data:c};"string"==typeof d?b.h.send(d):b.h.send(JSON.stringify(d))})}},bca=function(a){a.ja.then(function(c){Fj(c,
function(b){a.b.sendMessage(new wj("OFFER",new yj(b,null,null,a.w,a.g.id)))});Gj(c,function(b){b=xj(b);"STOP"==b.type&&a.stop();a.b.sendMessage(b)});Cj(c,function(){a.h=!0;a.b.sendMessage(new wj("SESSION_START_SUCCESS"));a.f.resolve(a.g)});Ej(c,function(){a.b.sendMessage(new wj("SESSION_END"))});Dj(c,function(b){a.h||a.f.reject(b);a.b.sendMessage(new wj("SESSION_FAILURE"))})})};var Kw=function(a){this.b=a;this.f=new Map;this.F=new Map;this.L=new Map;this.o=[];this.j=this.J=this.D=this.H=this.w=null;this.l=this.h=this.g=!1;this.C=new Map;this.s=new Map;cm(this)};Kw.prototype.getName=function(){return"cloud"};
Kw.prototype.initialize=function(){var a=this;this.m.info("Initializing Cloud MRP");var c=yw.Ia();null==c.fa&&(null==c.ha&&(c.ha=new dt(Bw(c),Hw(c))),c.fa=new cv(c.ha,this));this.o.push(c.fa);if(null==c.Va){var b=Dw(c);null==c.T&&(c.T=new sw(Aw(c),Cw(c)));var d=c.T,e=Fw(c,this);null==c.V&&(null==c.Z&&(c.Z=new Tu(Aw(c),Cw(c))),c.V=new Naa(c.Z,window.localStorage,Hw(c)));c.Va=new tw(b,d,this,e,c.V)}this.o.push(c.Va);null==c.h&&(null==c.f&&(c.f=new Ts(Bw(c),Aw(c))),b=c.f,null==c.j&&(c.j=new lba(Bw(c))),
c.h=new qt(b,c.j,this));this.w=c.h;this.o.push(this.w);this.H=Gw(c);Fw(c,this);this.D=Aw(c);null==c.F&&(b=Fw(c,this),null==c.g&&(c.g=new Nba(Gw(c),Aw(c),Ew(c),this)),d=c.g,null==c.C&&(c.C=new nba(Aw(c),this)),c.F=new Eba(b,d,c.C,this));this.J=c.F;null==c.L&&(c.L=new Pba);this.j=c.L;Tba(this.j).then(function(f){a.g=f;a.m.info("Cloud enabled setting: "+a.g)});Sba(this.j).then(function(f){a.h=f;a.m.info("Cloud on setting: "+a.h)});Qba(this.j,function(f){a.g=f;a.m.info("Cloud enabled setting: "+a.g);
a.g&&Lw(a)});Wba(this.j).then(function(f){a.l=f;a.m.info("Privacy notified setting: "+a.l)})};Kw.prototype.Dd=function(){return Array.from(this.f.values())};
Kw.prototype.Dg=function(a){if(!Mw(this,a))return uq;ob(this.m,"GetAvailableSinks for "+a);var c=[];if(this.h||cca())c=Lw(this);this.s.clear();for(var b={},d=l(this.C.values()),e=d.next();!e.done;b={tf:b.tf,kh:b.kh},e=d.next())b.tf=e.value,b.kh=!1,c.forEach(function(f){return function(g){g.id==f.tf.id&&(f.kh=!0,g.nb.friendlyName=f.tf.nb.friendlyName)}}(b)),b.kh||this.s.set(b.tf.id,b.tf);c=c.concat.apply(c,n(this.s.values()));ob(this.m,function(){return"Available sinks are..."+JSON.stringify(c)});
b=c.map(function(f){return f.nb});this.w&&(b=b.concat(dca));return new tq(b,-1!=a.indexOf("0F5096E8")?dj:null)};var Lw=function(a){var c=[];a.m.info("Checking cloud discovery services");wm().g=u();a.o.forEach(function(b){b=b.he();c=c.concat(b)});return c};h=Kw.prototype;h.startObservingMediaSinks=function(){};h.stopObservingMediaSinks=function(){};h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.ra=function(a){return(a=Nw(this,a))?a.nb:null};
h.createRoute=function(a,c,b,d,e,f,g){var k=this;this.m.info("createRoute called");ob(this.m,"urn: "+a+" sinkId:"+c);if(e=this.F.get(c))return oi(this.b.qm(this,e,a,b,g,function(m){m.mediaSource=a;m.pb.tabId=g;return pi(m)}),function(m){k.b.bf(m);return m});e=Nw(this,c);return eca(this,a,e,c,b,d,g)};
var Ow=function(a,c,b,d,e){c instanceof sq&&2==c.errorCode?Mv(a,b,6,null):(a.m.error("Error on start session",c instanceof Error?c:Error("Expected an Error value, got "+c)),a.f.has(b.id)&&Mv(a,b,e,mi(new hi(Hv,"warning"),b.sinkId)));if(c=a.w)c=a.w,c.f.delete(d.deviceId)?(c.b.b.delete(d.id),c=!0):c=!1;c&&mt(a,[d.nb])},eca=function(a,c,b,d,e,f,g){if(f)return qi(Error("not supported"));f=!1;switch(b.b){case "slarti":case "weave":Ks(1);break;case "mesi":f=!0;if(!a.l){a.l=!0;Vba(a.j);var k=mi(ji(),d);
a.b.cf(k)}Ks(0)}wm().f=new tm(b.model,null);var m=Kp(e,a.getName(),d,c,!0,"");f&&(m.customControllerPath="cloud_route_details/view.html?routeId="+m.id,m.controllerType=mojo.RouteControllerType&&mojo.RouteControllerType.kHangouts);a.f.set(m.id,m);a.F.set(d,m);a.C.set(m.id,b);a.L.set(m.id,b.b);a.b.Yf(a,m);a.b.ag(a.Ea(),!0);if(cj(c)&&!f)return a.m.info("starting presentation on route: "+m.id),fca(m,c).catch(function(p){Ow(a,p,m,b,7);throw p;});a.m.info("starting mirroring on route: "+m.id);m.pb={tabId:g,
sessionId:"",eg:"",me:b.model};cj(c)&&(m.isOffscreenPresentation=!0);return a.b.sj(a,m,e).catch(function(p){Ow(a,p,m,b,5);throw p;})};Kw.prototype.terminateRoute=function(a){return Mv(this,a,0,null)};
var Mv=function(a,c,b,d){var e="string"==typeof c?a.f.get(c):c;if(!e)return Promise.reject(new sq(3,"Route in cloud provider not found for routeId "+c));a.m.info("terminating route: "+e.id);a.f.delete(e.id);a.F.delete(e.sinkId);c=a.C.get(e.id);a.C.delete(e.id);d&&a.b.cf(d);Cb("MediaRouter.Cloud.Session.End",b,Fs);switch(b){case 1:break;default:switch(c.b){case "weave":lw(a.H,c.deviceId,haa,{})}}a.b.Kg(e);0==a.f.size&&a.b.ag(a.Ea(),!1);a.b.onPresentationConnectionStateChanged(e.id,"terminated");a.s.has(e.sinkId)&&
(b=a.s.get(e.sinkId),mt(a,[b.nb]),a.s.delete(e.sinkId));return Promise.resolve()};h=Kw.prototype;h.sendRouteMessage=function(a,c){var b=this.L.get(a);if(b){var d=(a=this.f.get(a)||void 0)?Nw(this,a.sinkId):void 0;return Hba(this.J,b,c,a,d)}return Ja(c)?(Lv(this,c,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
h.Kf=function(a){var c=new uj;5>c.minFrameRate&&(c.minFrameRate=5);var b=this.Ye(a);"hangouts"==b||"meetings"==b?(c.maxWidth=Math.min(window.screen&&window.screen.width||Infinity,2880),c.maxHeight=Math.min(window.screen&&window.screen.height||Infinity,1800)):c.senderSideLetterboxing=!0;vj(c);Object.freeze(c);this.m.info("Settings for "+a+": "+tj(c));if(!c.shouldCaptureAudio&&!c.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture.");return c};
h.Ye=function(a){var c=null;a=Nw(this,a);switch(a.b){case "slarti":case "weave":c="webrtc";break;case "mesi":c=a.Jd?"meetings":"hangouts"}return c};h.Th=function(){};h.wg=function(a,c){ob(this.m,"Checking canRoute: "+a+" for sinkId: "+c);return Mw(this,a)&&!!this.ra(c)};h.Df=function(a,c){return("https://hangouts.google.com/cloudmrp-mirroring"==a||cj(a))&&this.f.has(c)};h.joinRoute=function(a,c){return(a=this.f.get(c))?(this.m.info("joining route: "+a.id),pi(a)):qi(Error("not supported"))};
h.connectRouteByRouteId=function(){return qi(Error("not supported"))};h.detachRoute=function(){};
var kt=function(a,c){a.m.info(c.length+" sinks added");0<c.length&&!a.h&&(Rba(a.j),a.h=!0);c=Nw(a,c[0].id);wm().b=new tm(c.model,null);a.b.ed();a.b.onSinkAvailabilityUpdated(a,2);a.m.info("sinkAvailability changed to AVAILABLE")},mt=function(a,c){a.m.info(c.length+" sinks removed");a.o.some(function(b){return 0<b.he().length})||(a.b.onSinkAvailabilityUpdated(a,0),a.m.info("sinkAvailability changed to UNAVAILABLE"));a.b.ed()},lt=function(a,c){a.m.info(c.length+" sinks updated");a.b.ed()},Lv=function(a,
c,b,d){(void 0===d?0:d)?a.b.ge(b,c):a.b.Sh(b,c)},Nw=function(a,c){var b=gca(a,c);b||(b=null,(c=a.F.get(c))&&(b=a.C.get(c.id)));return b},gca=function(a,c){var b=null;a.o.some(function(d){b=d.ra(c);return!!b});return b},cca=function(){var a=wm().g;return 3E5<=Date.now()-a},Mw=function(a,c){var b=bj(c);c=cj(c);if(a.D.g&&!a.D.f&&b)return a.b.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.g&&a.D.f&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=a.D,e=!(a.g||a.f&&a.b&&(-1!=vt.indexOf(a.b)||-1!=vt.indexOf(ut(a))))&&
c;return e?!1:d&&(b||c)};Kw.prototype.searchSinks=function(a,c){var b=this;if(!Mw(this,a))return Promise.reject(Error("err"));a=qaa(this.w,c);a.then(function(d){kt(b,[d])});return a};var hca=function(a,c){c=a.f.get(c);if(!c)return Promise.reject(Error("Route not found"));a=a.Ye(c.sinkId);return"hangouts"!=a&&"meetings"!=a?Promise.reject(Error("Unsupported sink channel type")):Cs(Ni.get("mr.ProviderManager")||null,a)};h=Kw.prototype;
h.createMediaRouteController=function(a,c,b){return hca(this,a).then(function(d){return d.createMediaRouteController(a,c,b)})};h.provideSinks=function(){};h.Ea=function(){return"CloudProvider"};h.kb=function(){return[void 0,{cloudEnabled:this.g,cloudOn:this.h,notifiedHangoutsPrivacy:this.l}]};h.jb=function(){var a=am(this);a&&(a.cloudEnabled&&(this.g=a.cloudEnabled),a.cloudOn&&(this.h=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.l=a.notifiedHangoutsPrivacy))};var fca=function(a,c){a=new Jw(a,c);return ri(a.start())};
Kw.prototype.m=hb("mr.CloudProvider");var dca=new Wl("pseudo:cloud","","meeting","","default");var Pw=function(){Dp.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};q(Pw,Dp);Pw.prototype.ih=function(a,c){return c.id&&-1!=ica.indexOf(c.id)?"start"==a.type||"stop"==a.type||"subscribe_log_data"==a.type:!1};Pw.prototype.Ai=function(){return!0};var Rw=function(){Qw||(Qw=new Pw);return Qw},Qw=null,ica=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var Sw=function(){Dp.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};q(Sw,Dp);Sw.prototype.ih=function(a,c){return"retrieve_log_data"==a.type&&c.id==chrome.runtime.id&&c.url=="chrome-extension://"+c.id+"/feedback.html"};Sw.prototype.Ai=function(){return!0};var Uw=function(){Tw||(Tw=new Sw);return Tw},Tw=null;function jca(){var a=Vw;var c=new vq(a);var b=new Ir(a);c=[c,b];c.push(new Kw(a));return c};var Ww=function(a,c){this.routeId=a;this.message=c},Xw=function(a){return"string"!=typeof a.message};var Yw=function(a){this.D=a;this.h=this.j=null},Zw=function(a){if(null==a.h)if(null==a.j||Date.now()-a.j>=a.D)a.w();else{var c=Math.max(a.j+a.D-Date.now(),5);a.h=setTimeout(a.w.bind(a),c)}};Yw.prototype.w=function(){null!=this.h&&(clearTimeout(this.h),this.h=null);this.s();this.j=Date.now()};Yw.prototype.s=function(){};var $w=function(a,c){Yw.call(this,20);this.b=new Map;this.f=new Set;this.o=null;this.l=this.g=0;this.C=!1;this.L=a;this.F=c;this.m=hb("mr.RouteMessageSender")};q($w,Yw);$w.prototype.init=function(a){this.o=a;cm(this)};$w.prototype.stopListeningForRouteMessages=function(a){this.f.delete(a)};
$w.prototype.send=function(a,c){var b=this.b.get(a);b||(b=[],this.b.set(a,b));c=new Ww(a,c);b.push(c);50<b.length&&1==b.length%50&&this.m.G(function(){return"Message queue length is excessively large "+("("+b.length+") for route "+a)});this.g+=Xw(c)?0:c.message.length;Xw(c)&&this.l++;ax(this);this.f.has(a)&&Zw(this)};
var bx=function(a,c){if(0!=c.length){c=l(c);for(var b=c.next();!b.done;b=c.next())b=b.value,a.g-=Xw(b)?0:b.message.length,Xw(b)&&a.l--}},ax=function(a){var c=0<a.l||a.g>a.F;c!=a.C&&(a.C=c,a.L.ag(a.Ea(),c))};$w.prototype.s=function(){if(this.o){for(var a=l(this.f),c=a.next();!c.done;c=a.next()){c=c.value;var b=this.b.get(c);b&&0!=b.length&&(this.o(c,b),bx(this,b),this.b.set(c,[]))}ax(this)}else this.m.error("sendMessagesCallback not set. Messages not delivered.")};$w.prototype.Ea=function(){return"mr.RouteMessageSender"};
$w.prototype.kb=function(){var a=[].concat(n(this.b.entries())).map(function(c){return[c[0],c[1].map(function(b){return b.message})]});return[new kca(a,Array.from(this.f),this.g)]};$w.prototype.jb=function(){var a=$l(this);if(a){this.b=new Map;for(var c={},b=l(a.f),d=b.next();!d.done;c={nh:c.nh},d=b.next())d=d.value,c.nh=d[0],d=d[1].map(function(e){return function(f){return new Ww(e.nh,f)}}(c)),this.b.set(c.nh,d);this.f=new Set(a.b);this.g=a.g}};var kca=function(a,c,b){this.f=a;this.b=c;this.g=b};var lca=function(a,c){this.type="internal_message";this.routeId=a;this.message=c};var cx=function(a,c,b){this.b=a;this.h=c;this.g=b;this.onMessage=function(){};b.listen("internal_message",this.f,this)};cx.prototype.sendMessage=function(a,c){return this.h(this.b,a,c)};cx.prototype.f=function(a){if(a.routeId==this.b)this.onMessage(a.message)};cx.prototype.ab=function(){this.onMessage=function(){};Kq(this.g,this.f,this)};
var mca=new cx("",function(){return Promise.resolve()},new Jq),nca=function(a){this.b=a},Iw=function(a){var c=fi,b=c.b.Li(a);return b?new cx(a,b.sendRouteMessage.bind(b),c.b.Ni()):mca};var dx=function(a,c){this.w=null!=c?a.bind(c):a;this.j=this.l.bind(this);this.h=[];this.b=!1;this.f=null};dx.prototype.g=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];this.h=[].concat(n(c));null==this.f?ex(this):this.b=!0};var ex=function(a){a.f=setTimeout(a.j,500);a.w.apply(a,n(a.h))};dx.prototype.l=function(){this.f=null;this.b&&(this.b=!1,ex(this))};var fx=function(){this.m=hb("mr.ProviderManager");this.g=[];this.f=new Map;this.l=new Map;this.j=new Set;this.h=new Set;this.D=new Map;this.b=this.s=null;this.O=new Jq;this.T=new dx(this.pn,this);this.Z=new dx(this.L,this);this.w=new $w(this,524288);this.F=0;this.o=new Map;this.C=[];var a=new xs(this);this.Va=a.onMessage.bind(a);a=new os(this);this.V=a.onMessage.bind(a);this.H="";this.J=!1;this.onBeforeInvokeHandler=this.onBeforeInvokeHandler;this.createRoute=this.createRoute;this.joinRoute=this.joinRoute;
this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;this.startObservingMediaRoutes=this.startObservingMediaRoutes;
this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.detachRoute=this.detachRoute;this.searchSinks=this.searchSinks;this.provideSinks=this.provideSinks;this.updateMediaSinks=this.updateMediaSinks;this.createMediaRouteController=this.createMediaRouteController};q(fx,Mi);
fx.prototype.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(a==chrome.runtime.onMessage)this.Va.apply(this,n(b));else if(a==chrome.runtime.onMessageExternal)this.V.apply(this,n(b));else throw Error("Unhandled event");};
var Cs=function(a,c){c=a.D.get(c);return Qi(c).then(function(b){b.initialize(a,a.J);return b})},oca=function(a,c,b){c.forEach(function(d){if(Bs(a,d.getName()))a.m.G("Provider "+d.getName()+" already registered.");else try{d.initialize(b),a.g.push(d),a.o.set(d.getName(),0)}catch(e){a.m.G("Provider "+d.getName()+" failed to initialize.",e)}})};
fx.prototype.initialize=function(a,c,b){this.D.set("webrtc","mr.mirror.webrtc.WebRtcService");this.D.set("cast_streaming","mr.mirror.cast.Service");this.D.set("hangouts","mr.mirror.hangouts.HangoutsService");this.D.set("meetings","mr.mirror.hangouts.MeetingsService");var d=new nca(this);fi||(fi=d);this.b=a;this.w.init(this.b.onRouteMessagesReceived.bind(this.b));oca(this,c,b);b&&void 0!==b.use_views_dialog&&(this.H=b.use_views_dialog?"Views":"WebUI");b&&void 0!==b.use_mirroring_service&&(this.J=b.use_mirroring_service);
cm(this);Wi("mr.ProviderManager",this)};var hx=function(a,c,b){return new Promise(function(d,e){var f=null;a.F++;gx(a);f=window.setTimeout(function(){f=null;c.cancel(new sq(2,"timeout after "+b+" ms."))},b);c.b.then(function(g){a.F--;gx(a);null!=f&&window.clearTimeout(f);d(g)},function(g){a.F--;gx(a);null!=f&&window.clearTimeout(f);e(g instanceof sq?g:g instanceof Error?new sq(0,g.message,g.stack):new sq(0))})})};fx.prototype.onBeforeInvokeHandler=function(){Zi(0)};
var ix=function(a){return"string"==typeof a?a:a.unique?"":a.scheme+"://"+a.host+"\n       "+(a.port?":"+a.port:"")+"/"};h=fx.prototype;
h.createRoute=function(a,c,b,d,e,f,g){var k=this;g=void 0===g?!1:g;var m=pca(this,a,c);if(!m)return Promise.reject(new sq(7,"No provider supports createRoute with source: "+a+" and sink: "+c));var p=void 0;void 0!==d&&(p=ix(d));f=f&&0<f?f:6E4;a=m.createRoute(a,c,b,g,f,p,e);return hx(this,a,f).then(function(v){return v},function(v){k.m.error("Error creating route.",v);throw v;})};
h.connectRouteByRouteId=function(a,c,b,d,e,f){var g=this.f.get(c);if(!g)return Promise.reject(new sq(7,"No provider supports join "+c));a=g.connectRouteByRouteId(a,c,b,ix(d),e);return hx(this,a,f&&0<f?f:3E4)};h.joinRoute=function(a,c,b,d,e,f){f=void 0===f?!1:f;var g=qca(this,a,c);if(!g)return Promise.reject(new sq(7,"No provider supports join "+c));e=e&&0<e?e:3E4;a=g.joinRoute(a,c,f,e,ix(b),d);return hx(this,a,e)};
h.terminateRoute=function(a){var c=this.f.get(a);return c?jx(this,a).then(function(){return c.terminateRoute(a)}):Promise.reject(new sq(3,"Route not found for routeId "+a))};h.startObservingMediaSinks=function(a){this.j.has(a)||(this.j.add(a),this.g.forEach(function(c){c.startObservingMediaSinks(a)}));kx(this,a)};h.stopObservingMediaSinks=function(a){this.j.delete(a)?lx(this,a):this.m.info("No existing query "+a)};
var lx=function(a,c){a.g.forEach(function(b){b.stopObservingMediaSinks(c)})},kx=function(a,c){if("urn:x-org.chromium.media:source:tab:-1"==c)a.m.G("No sinks for sourceUrn: "+c);else{var b=new Map,d=[];a.g.forEach(function(e){var f=e.Dg(c);0<f.sinks.length&&(d=f.origins);f.sinks.forEach(function(g){b.has(g.id)?a.m.G("Detected duplicate sink "+g.id+" from provider: "+e.getName()):b.set(g.id,g)})});rca(a,c,Array.from(b.values()),d||[])}},rca=function(a,c,b,d){a.m.info("Sending "+b.length+" sinks to MR for "+
c);a.b.onSinksReceived(c,b,d.map(Eo))};h=fx.prototype;h.sendRouteMessage=function(a,c,b){var d=this.f.get(a);d?(a=d.sendRouteMessage(a,c,b),a=hx(this,ri(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};h.sendRouteBinaryMessage=function(a,c){var b=this.f.get(a);b?(a=b.sendRouteBinaryMessage(a,c),a=hx(this,ri(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};
h.startListeningForRouteMessages=function(a){var c=this.w;c.f.has(a)||(c.f.add(a),(a=c.b.get(a))&&0<a.length&&Zw(c))};h.stopListeningForRouteMessages=function(a){this.w.stopListeningForRouteMessages(a)};h.detachRoute=function(a){var c=this.f.get(a);c?c.detachRoute(a):this.m.info("Route "+a+" does not exist.")};h.enableMdnsDiscovery=function(){};var pca=function(a,c,b){return a.g.find(function(d){return d.wg(c,b)})||null},qca=function(a,c,b){return a.g.find(function(d){return d.Df(c,b)})||null};
fx.prototype.L=function(){var a=this;this.j.forEach(function(c){kx(a,c)})};var gx=function(a){a.b.setKeepAlive(0<a.F||0<a.C.length)};h=fx.prototype;h.startObservingMediaRoutes=function(a){this.h.has(a)||(this.h.add(a),this.g.forEach(function(c){c.startObservingMediaRoutes(a)}));this.T.g()};h.stopObservingMediaRoutes=function(a){this.h.delete(a)?this.g.forEach(function(c){c.stopObservingMediaRoutes(a)}):this.m.info("No existing route query "+a)};
h.pn=function(){var a=this;if(0!=this.h.size){var c=[];this.g.forEach(function(b){c=c.concat(b.Dd())});this.h.forEach(function(b){var d=[];a.g.forEach(function(e){e.Dd().forEach(function(f){!f.Gf&&e.Df(b,void 0,f)&&d.push(f.id)})});a.b.onRoutesUpdated(c,b,d)})}};h.Ea=function(){return"ProviderManager"};
h.kb=function(){return[new sca(this.g.map(function(a){return a.getName()}),Array.from(this.j),Array.from(this.h),Array.from(this.f,function(a){var c=l(a);a=c.next().value;c=c.next().value;return[a,c.getName()]}),Array.from(this.o),this.s)]};h.jb=function(){var a=$l(this);if(a){this.j=new Set(a.j);this.h=new Set(a.g);for(var c=l(a.f),b=c.next();!b.done;b=c.next()){var d=l(b.value);b=d.next().value;d=d.next().value;d=Bs(this,d);this.f.set(b,d)}this.o=new Map(a.h);this.s=a.b||null}};h.Li=function(a){return this.f.get(a)};
h.Yf=function(a,c){this.f.set(c.id,a);this.bf(c)};h.Kg=function(a){jx(this,a.id);this.f.delete(a.id);var c=this.w,b=a.id;c.f.delete(b);var d=c.b.get(b);d&&(c.b.delete(b),bx(c,d),ax(c));this.bf(a)};h.bf=function(){0<this.h.size&&this.T.g()};h.Si=function(a){var c=this.f.get(a.id);c&&(c.Th(a.id),0<this.h.size&&this.pn())};h.ge=function(a,c){this.f.has(a)?("string"===typeof c||c instanceof Uint8Array||(c=JSON.stringify(c)),this.w.send(a,c)):this.m.G("Got route message for closed route "+a)};
h.onPresentationConnectionStateChanged=function(a,c){"terminated"==c&&this.w.w();this.b.onPresentationConnectionStateChanged(a,c)};h.onPresentationConnectionClosed=function(a,c,b){this.w.w();this.b.onPresentationConnectionClosed(a,c,b)};h.Uh=function(a){this.l.delete(a);var c=this.f.get(a);c&&c.terminateRoute(a)};h.Sh=function(a,c){Lq(this.O,new lca(a,c))};h.ed=function(){this.Z.g()};
h.onSinkAvailabilityUpdated=function(a,c){var b=this;if(this.o.get(a.getName())!=c){var d=mx(this);this.o.set(a.getName(),c);a=mx(this);d!=a&&(0==a&&this.L(),this.b.onSinkAvailabilityUpdated(a),0==a&&(this.j.forEach(function(e){lx(b,e)}),this.j.clear()))}};var mx=function(a){return Array.from(a.o.values()).reduce(function(c,b){return Math.max(c,b)},0)};fx.prototype.Ni=function(){return this.O};fx.prototype.cf=function(a){this.b.onIssue(a)};
var jx=function(a,c){return a.l.has(c)?Cs(a,a.l.get(c)).then(function(b){a.l.delete(c);return b.l()}):Promise.resolve(!1)};fx.prototype.sj=function(a,c,b,d){var e=this,f=a.Ye(c.sinkId);this.m.info("Starting mirroring using service: "+f);this.l.set(c.id,f);return si(Cs(this,f),function(g){e.s=f;return g.Hj(c,c.mediaSource,a.Kf(c.sinkId),b,d).catch(function(k){if(k instanceof ui&&3==k.reason)throw new sq(8);throw k;})})};
fx.prototype.qm=function(a,c,b,d,e,f){var g=this,k=this.l.get(c.id);return k?si(Cs(this,k),function(m){g.s=k;return m.Ij(c,b,a.Kf(c.sinkId),d,e,f)}):qi(Error("Route "+c.id+" is not mirroring"))};fx.prototype.ag=function(a,c){var b=this.C.indexOf(a),d=0<=b;c&&!d?this.C.push(a):!c&&d&&this.C.splice(b,1);gx(this)};var Bs=function(a,c){return a.g.find(function(b){return b.getName()==c})||null};h=fx.prototype;
h.searchSinks=function(a,c,b){var d=a.startsWith("pseudo:")?a.substring(7):null;return(d=d?Bs(this,d):null)?d.searchSinks(c,b).then(function(e){return e.id}):Promise.reject(Error("No provider supports "+a))};h.provideSinks=function(a,c){var b=Bs(this,a);b?b.provideSinks(c):this.m.error("provideSinks: Provider not found for providerName "+a)};h.updateMediaSinks=function(a){this.j.has(a)||kx(this,a)};
h.createMediaRouteController=function(a,c,b){var d=this,e=this.f.get(a);return e?e.createMediaRouteController(a,c,b).catch(function(f){d.m.error("createMediaRouteController failed: "+f.message);c.close();b.ptr.reset();throw f;}):(a="createMediaRouteController: Provider not found for "+a,this.m.error(a),c.close(),b.ptr.reset(),Promise.reject(Error(a)))};h.onMediaRemoterCreated=function(a,c,b){this.b.onMediaRemoterCreated(a,c,b)};
h.getMediaSinkServiceStatus=function(){return"function"!=typeof this.b.getMediaSinkServiceStatus?Promise.resolve({status:""}):this.b.getMediaSinkServiceStatus()};h.getMirroringServiceHostForTab=function(a,c){this.b.getMirroringServiceHostForTab(a,c)};h.getMirroringServiceHostForDesktop=function(a,c,b){this.b.getMirroringServiceHostForDesktop(a,c,b)};h.getMirroringServiceHostForOffscreenTab=function(a,c,b){this.b.getMirroringServiceHostForOffscreenTab(a,c,b)};
var sca=function(a,c,b,d,e,f){this.j=c;this.g=b;this.f=d;this.h=e;this.b=f};
