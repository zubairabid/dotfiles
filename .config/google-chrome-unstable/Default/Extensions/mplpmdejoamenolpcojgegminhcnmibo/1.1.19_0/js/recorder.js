!function(t){var e=function(t,e){var n=e||{},o=n.bufferLen||4096,a=n.numChannels||2;this.context=t.context,this.node=(this.context.createScriptProcessor||this.context.createJavaScriptNode).call(this.context,o,a,a);var c=new Worker(n.workerPath||"recorderWorker.js");c.postMessage({command:"init",config:{sampleRate:this.context.sampleRate,numChannels:a}});var r,s=!1;this.node.onaudioprocess=function(t){if(s){for(var e=[],n=0;n<a;n++)e.push(t.inputBuffer.getChannelData(n));c.postMessage({command:"record",buffer:e})}},this.configure=function(t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])},this.record=function(){s=!0},this.stop=function(){s=!1},this.clear=function(){c.postMessage({command:"clear"})},this.getBuffer=function(t){r=t||n.callback,c.postMessage({command:"getBuffer"})},this.exportWAV=function(t,e){if(r=t||n.callback,e=e||n.type||"audio/wav",!r)throw new Error("Callback not set");c.postMessage({command:"exportWAV",type:e})},c.onmessage=function(t){r(t.data)},t.connect(this.node),this.node.connect(this.context.destination)};e.forceDownload=function(e,n){var o=(t.URL||t.webkitURL).createObjectURL(e),a=t.document.createElement("a");a.href=o,a.download=n||"output.wav";var c=document.createEvent("Event");c.initEvent("click",!0,!0),a.dispatchEvent(c)},t.Recorder=e}(window);