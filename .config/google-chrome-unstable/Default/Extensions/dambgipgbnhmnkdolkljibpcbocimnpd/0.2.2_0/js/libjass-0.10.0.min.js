/**
 * libjass
 *
 * https://github.com/Arnavion/libjass
 *
 * Copyright 2013 Arnav Singh
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(e,t){var r=this;"object"==typeof exports&&"object"==typeof module?module.exports=t(r):"function"==typeof define&&define.amd?define(function(){return t(r)}):"object"==typeof exports?exports.libjass=t(r):e.libjass=t(r)}(this,function(e){"use strict";return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:Object.create(null),id:n,loaded:!1};return e[n](i.exports,t),i.loaded=!0,i.exports}var r=Object.create(null);return t(0)}([function(e,t){var r=t(22),n=t(22);e.debugMode=n.debugMode,e.verboseMode=n.verboseMode;var i=t(32),o=t(32);e.Set=o.Set;var a=t(29),l=t(29);e.Map=l.Map;var s=t(31),u=t(31);e.Promise=u.Promise,e.DeferredPromise=u.DeferredPromise;var p=t(35);e.webworker=p;var c=t(7);e.parts=c;var h=t(1);e.parser=h;var f=t(13);e.renderers=f;var d=t(23);e.ASS=d.ASS;var _=t(24);e.Dialogue=_.Dialogue;var g=t(26);e.ScriptProperties=g.ScriptProperties;var y=t(27);e.Style=y.Style;var v=t(25);e.BorderStyle=v.BorderStyle,e.Format=v.Format,e.WrappingStyle=v.WrappingStyle,Object.defineProperties(e,{debugMode:{get:function(){return r.debugMode},set:r.setDebugMode},verboseMode:{get:function(){return r.verboseMode},set:r.setVerboseMode},Set:{get:function(){return i.Set},set:i.setImplementation},Map:{get:function(){return a.Map},set:a.setImplementation},Promise:{get:function(){return s.Promise},set:s.setImplementation}})},function(e,t){var r=t(3);e.parse=r.parse;var n=t(5);e.BrowserReadableStream=n.BrowserReadableStream,e.StringStream=n.StringStream,e.XhrStream=n.XhrStream;var i=t(4);e.StreamParser=i.StreamParser,e.SrtStreamParser=i.SrtStreamParser},function(e,t){function r(e){var t=e.indexOf(":");if(-1===t)return null;var r=e.substr(0,t),n=e.substr(t+1).replace(/^\s+/,"");return{name:r,value:n}}function n(e,t){var n=r(e);if(null===n)return null;var o=n.value.split(",");o.length>t.length&&(o[t.length-1]=o.slice(t.length-1).join(","));var a=new i.Map;return t.forEach(function(e,t){a.set(e,o[t])}),{type:n.name,template:a}}var i=t(29);e.parseLineIntoProperty=r,e.parseLineIntoTypedTemplate=n},function(e,t){function r(e,t){var r=new l(e,t);if(null===r.result||r.result.end!==e.length)throw o.debugMode&&console.error("Parse failed. %s %s %o",t,e,r.result),new Error("Parse failed.");return r.result.value}function n(e,t,r,n){l.prototype["parse_tag_"+e]=function(i){var o=this,a=new h(i);if(null===o.read(a,e))return i.pop(),null;var l=r.call(o,a);if(null!==l)a.value=new t(l.value);else{if(n)return i.pop(),null;a.value=new t(null)}return a}}var i=t(7),o=t(22),a=t(29);e.parse=r;var l=function(){function e(e,t){this._av=e,this._ah=new h(null),this._b6=s.get(t).call(this,this._ah)}return Object.defineProperty(e.prototype,"result",{get:function(){return this._b6},enumerable:!0,configurable:!0}),e.prototype.parse_dialogueParts=function(e){var t=new h(e);for(t.value=[];this._r();){var n=this.parse_enclosedTags(t);if(null!==n)t.value.push.apply(t.value,n.value);else{var o=this.parse_newline(t)||this.parse_hardspace(t)||this.parse_text(t);if(null===o)return e.pop(),null;if(o.value instanceof i.Text&&t.value[t.value.length-1]instanceof i.Text){var a=t.value[t.value.length-1];t.value[t.value.length-1]=new i.Text(a.value+o.value.value)}else t.value.push(o.value)}}var l=!1;return t.value.forEach(function(e,n){e instanceof i.DrawingMode?l=0!==e.scale:e instanceof i.Text&&l&&(t.value[n]=new i.DrawingInstructions(r(e.value,"drawingInstructions")))}),t},e.prototype.parse_enclosedTags=function(e){var t=new h(e);if(t.value=[],null===this.read(t,"{"))return e.pop(),null;for(var r=this._b();this._r()&&"}"!==r;r=this._b()){var n=null;if(null!==this.read(t,"\\")&&(n=this.parse_tag_alpha(t)||this.parse_tag_iclip(t)||this.parse_tag_xbord(t)||this.parse_tag_ybord(t)||this.parse_tag_xshad(t)||this.parse_tag_yshad(t)||this.parse_tag_blur(t)||this.parse_tag_bord(t)||this.parse_tag_clip(t)||this.parse_tag_fade(t)||this.parse_tag_fscx(t)||this.parse_tag_fscy(t)||this.parse_tag_move(t)||this.parse_tag_shad(t)||this.parse_tag_fad(t)||this.parse_tag_fax(t)||this.parse_tag_fay(t)||this.parse_tag_frx(t)||this.parse_tag_fry(t)||this.parse_tag_frz(t)||this.parse_tag_fsp(t)||this.parse_tag_fsplus(t)||this.parse_tag_fsminus(t)||this.parse_tag_org(t)||this.parse_tag_pbo(t)||this.parse_tag_pos(t)||this.parse_tag_an(t)||this.parse_tag_be(t)||this.parse_tag_fn(t)||this.parse_tag_fr(t)||this.parse_tag_fs(t)||this.parse_tag_kf(t)||this.parse_tag_ko(t)||this.parse_tag_1a(t)||this.parse_tag_1c(t)||this.parse_tag_2a(t)||this.parse_tag_2c(t)||this.parse_tag_3a(t)||this.parse_tag_3c(t)||this.parse_tag_4a(t)||this.parse_tag_4c(t)||this.parse_tag_a(t)||this.parse_tag_b(t)||this.parse_tag_c(t)||this.parse_tag_i(t)||this.parse_tag_k(t)||this.parse_tag_K(t)||this.parse_tag_p(t)||this.parse_tag_q(t)||this.parse_tag_r(t)||this.parse_tag_s(t)||this.parse_tag_t(t)||this.parse_tag_u(t),null===n&&t.pop()),null===n&&(n=this.parse_comment(t)),null===n)return e.pop(),null;n.value instanceof i.Comment&&t.value[t.value.length-1]instanceof i.Comment?t.value[t.value.length-1]=new i.Comment(t.value[t.value.length-1].value+n.value.value):t.value.push(n.value)}return null===this.read(t,"}")?(e.pop(),null):t},e.prototype.parse_newline=function(e){var t=new h(e);return null===this.read(t,"\\N")?(e.pop(),null):(t.value=new i.NewLine,t)},e.prototype.parse_hardspace=function(e){var t=new h(e);return null===this.read(t,"\\h")?(e.pop(),null):(t.value=new i.Text("Â "),t)},e.prototype.parse_text=function(e){var t=this._b(),r=new h(e),n=new h(r,t);return r.value=new i.Text(n.value),r},e.prototype.parse_comment=function(e){var t=this._b(),r=new h(e),n=new h(r,t);return r.value=new i.Comment(n.value),r},e.prototype.parse_tag_a=function(e){var t=new h(e);if(null===this.read(t,"a"))return e.pop(),null;var r=this._b();switch(r){case"1":var n=this._b(2);switch(n){case"10":case"11":r=n}break;case"2":case"3":case"5":case"6":case"7":case"9":break;default:return e.pop(),null}var o=new h(t,r),a=null;switch(o.value){case"1":a=1;break;case"2":a=2;break;case"3":a=3;break;case"5":a=7;break;case"6":a=8;break;case"7":a=9;break;case"9":a=4;break;case"10":a=5;break;case"11":a=6}return t.value=new i.Alignment(a),t},e.prototype.parse_tag_alpha=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_an=function(e){var t=new h(e);if(null===this.read(t,"an"))return e.pop(),null;var r=this._b();if("1">r||r>"9")return e.pop(),null;var n=new h(t,r);return t.value=new i.Alignment(parseInt(n.value)),t},e.prototype.parse_tag_b=function(e){var t=new h(e);if(null===this.read(t,"b"))return e.pop(),null;var r=null,n=this._b();return n>="1"&&"9">=n&&(n=this._b(3),"00"===n.substr(1)&&(r=new h(t,n),r.value=parseInt(r.value))),null===r&&(r=this.parse_enableDisable(t)),null!==r?t.value=new i.Bold(r.value):t.value=new i.Bold(null),t},e.prototype.parse_tag_be=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_blur=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_bord=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_c=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_clip=function(e){return this._be("clip",e)},e.prototype.parse_tag_fad=function(e){var t=new h(e);if(null===this.read(t,"fad"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var r=this.parse_decimal(t);if(null===r)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):null===this.read(t,")")?(e.pop(),null):(t.value=new i.Fade(r.value/1e3,n.value/1e3),t)},e.prototype.parse_tag_fade=function(e){var t=new h(e);if(null===this.read(t,"fade"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var r=this.parse_decimal(t);if(null===r)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var n=this.parse_decimal(t);if(null===n)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var o=this.parse_decimal(t);if(null===o)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var a=this.parse_decimal(t);if(null===a)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var l=this.parse_decimal(t);if(null===l)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var s=this.parse_decimal(t);if(null===s)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var u=this.parse_decimal(t);return null===u?(e.pop(),null):null===this.read(t,")")?(e.pop(),null):(t.value=new i.ComplexFade(1-r.value/255,1-n.value/255,1-o.value/255,a.value/1e3,l.value/1e3,s.value/1e3,u.value/1e3),t)},e.prototype.parse_tag_fax=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fay=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fn=function(e){var t=new h(e);if(null===this.read(t,"fn"))return e.pop(),null;for(var r=new h(t,""),n=this._b();this._r()&&"\\"!==n&&"}"!==n;n=this._b())r.value+=n;return r.value.length>0?t.value=new i.FontName(r.value):t.value=new i.FontName(null),t},e.prototype.parse_tag_fr=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_frx=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fry=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_frz=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fs=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_fsplus=function(e){var t=new h(e);if(null===this.read(t,"fs+"))return e.pop(),null;var r=this.parse_decimal(t);return null===r?(e.pop(),null):(t.value=new i.FontSizePlus(r.value),t)},e.prototype.parse_tag_fsminus=function(e){var t=new h(e);if(null===this.read(t,"fs-"))return e.pop(),null;var r=this.parse_decimal(t);return null===r?(e.pop(),null):(t.value=new i.FontSizeMinus(r.value),t)},e.prototype.parse_tag_fscx=function(e){var t=new h(e);if(null===this.read(t,"fscx"))return e.pop(),null;var r=this.parse_decimal(t);return null===r?(e.pop(),null):(t.value=new i.FontScaleX(r.value/100),t)},e.prototype.parse_tag_fscy=function(e){var t=new h(e);if(null===this.read(t,"fscy"))return e.pop(),null;var r=this.parse_decimal(t);return null===r?(e.pop(),null):(t.value=new i.FontScaleY(r.value/100),t)},e.prototype.parse_tag_fsp=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_i=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_iclip=function(e){return this._be("iclip",e)},e.prototype.parse_tag_k=function(e){var t=new h(e);if(null===this.read(t,"k"))return e.pop(),null;var r=this.parse_decimal(t);return null===r?(e.pop(),null):(t.value=new i.ColorKaraoke(r.value/100),t)},e.prototype.parse_tag_K=function(e){var t=new h(e);if(null===this.read(t,"K"))return e.pop(),null;var r=this.parse_decimal(t);return null===r?(e.pop(),null):(t.value=new i.SweepingColorKaraoke(r.value/100),t)},e.prototype.parse_tag_kf=function(e){var t=new h(e);if(null===this.read(t,"kf"))return e.pop(),null;var r=this.parse_decimal(t);return null===r?(e.pop(),null):(t.value=new i.SweepingColorKaraoke(r.value/100),t)},e.prototype.parse_tag_ko=function(e){var t=new h(e);if(null===this.read(t,"ko"))return e.pop(),null;var r=this.parse_decimal(t);return null===r?(e.pop(),null):(t.value=new i.OutlineKaraoke(r.value/100),t)},e.prototype.parse_tag_move=function(e){var t=new h(e);if(null===this.read(t,"move"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var r=this.parse_decimal(t);if(null===r)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var n=this.parse_decimal(t);if(null===n)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var o=this.parse_decimal(t);if(null===o)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var a=this.parse_decimal(t);if(null===a)return e.pop(),null;var l=null,s=null;if(null!==this.read(t,",")){if(l=this.parse_decimal(t),null===l)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;if(s=this.parse_decimal(t),null===s)return e.pop(),null}return null===this.read(t,")")?(e.pop(),null):(t.value=new i.Move(r.value,n.value,o.value,a.value,null!==l?l.value/1e3:null,null!==s?s.value/1e3:null),t)},e.prototype.parse_tag_org=function(e){var t=new h(e);if(null===this.read(t,"org"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var r=this.parse_decimal(t);if(null===r)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):null===this.read(t,")")?(e.pop(),null):(t.value=new i.RotationOrigin(r.value,n.value),t)},e.prototype.parse_tag_p=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_pbo=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_pos=function(e){var t=new h(e);if(null===this.read(t,"pos"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var r=this.parse_decimal(t);if(null===r)return e.pop(),null;if(null===this.read(t,","))return e.pop(),null;var n=this.parse_decimal(t);return null===n?(e.pop(),null):null===this.read(t,")")?(e.pop(),null):(t.value=new i.Position(r.value,n.value),t)},e.prototype.parse_tag_q=function(e){var t=new h(e);if(null===this.read(t,"q"))return e.pop(),null;var r=this._b();if("0">r||r>"3")return e.pop(),null;var n=new h(t,r);return t.value=new i.WrappingStyle(parseInt(n.value)),t},e.prototype.parse_tag_r=function(e){var t=new h(e);if(null===this.read(t,"r"))return e.pop(),null;for(var r=new h(t,""),n=this._b();this._r()&&"\\"!==n&&"}"!==n;n=this._b())r.value+=n;return r.value.length>0?t.value=new i.Reset(r.value):t.value=new i.Reset(null),t},e.prototype.parse_tag_s=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_shad=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_t=function(e){var t=new h(e);if(null===this.read(t,"t"))return e.pop(),null;if(null===this.read(t,"("))return e.pop(),null;var r=null,n=null,o=null,a=this.parse_decimal(t);if(null!==a){if(null===this.read(t,","))return e.pop(),null;var l=this.parse_decimal(t);if(null!==l){if(r=a,n=l,null===this.read(t,","))return e.pop(),null;var s=this.parse_decimal(t);if(null!==s&&(o=s,null===this.read(t,",")))return e.pop(),null}else if(o=a,null===this.read(t,","))return e.pop(),null}for(var u=[],p=this._b();this._r()&&")"!==p&&"}"!==p;p=this._b()){var c=null;if(null!==this.read(t,"\\")&&(c=this.parse_tag_alpha(t)||this.parse_tag_iclip(t)||this.parse_tag_xbord(t)||this.parse_tag_ybord(t)||this.parse_tag_xshad(t)||this.parse_tag_yshad(t)||this.parse_tag_blur(t)||this.parse_tag_bord(t)||this.parse_tag_clip(t)||this.parse_tag_fscx(t)||this.parse_tag_fscy(t)||this.parse_tag_shad(t)||this.parse_tag_fax(t)||this.parse_tag_fay(t)||this.parse_tag_frx(t)||this.parse_tag_fry(t)||this.parse_tag_frz(t)||this.parse_tag_fsp(t)||this.parse_tag_fsplus(t)||this.parse_tag_fsminus(t)||this.parse_tag_be(t)||this.parse_tag_fr(t)||this.parse_tag_fs(t)||this.parse_tag_1a(t)||this.parse_tag_1c(t)||this.parse_tag_2a(t)||this.parse_tag_2c(t)||this.parse_tag_3a(t)||this.parse_tag_3c(t)||this.parse_tag_4a(t)||this.parse_tag_4c(t)||this.parse_tag_c(t),null===c&&t.pop()),null===c&&(c=this.parse_comment(t)),null===c)return e.pop(),null;c.value instanceof i.Comment&&u[u.length-1]instanceof i.Comment?u[u.length-1]=new i.Comment(u[u.length-1].value+c.value.value):u.push(c.value)}return this.read(t,")"),t.value=new i.Transform(null!==r?r.value/1e3:null,null!==n?n.value/1e3:null,null!==o?o.value/1e3:null,u),t},e.prototype.parse_tag_u=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_xbord=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_xshad=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_ybord=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_yshad=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_1a=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_1c=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_2a=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_2c=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_3a=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_3c=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_4a=function(){throw new Error("Method not implemented.")},e.prototype.parse_tag_4c=function(){throw new Error("Method not implemented.")},e.prototype.parse_drawingInstructions=function(e){var t=new h(e),r=null;for(t.value=[];this._r();){for(;null!==this.read(t," "););if(!this._r())break;var n=null,i=this.parse_text(t);if(null===i)return e.pop(),null;switch(n=i.value.value){case"m":case"l":case"b":r=n;break;default:if(null===r)return e.pop(),null;n=r,t.pop()}switch(n){case"m":var o=this.parse_drawingInstructionMove(t);if(null===o)return e.pop(),null;t.value.push(o.value);break;case"l":var a=this.parse_drawingInstructionLine(t);if(null===a)return e.pop(),null;t.value.push(a.value);break;case"b":var l=this.parse_drawingInstructionCubicBezierCurve(t);if(null===l)return e.pop(),null;t.value.push(l.value)}}for(;null!==this.read(t," "););return t},e.prototype.parse_drawingInstructionMove=function(e){for(var t=new h(e);null!==this.read(t," "););var r=this.parse_decimal(t);if(null===r)return e.pop(),null;for(;null!==this.read(t," "););var n=this.parse_decimal(t);return null===n?(e.pop(),null):(t.value=new i.drawing.MoveInstruction(r.value,n.value),t)},e.prototype.parse_drawingInstructionLine=function(e){for(var t=new h(e);null!==this.read(t," "););var r=this.parse_decimal(t);if(null===r)return e.pop(),null;for(;null!==this.read(t," "););var n=this.parse_decimal(t);return null===n?(e.pop(),null):(t.value=new i.drawing.LineInstruction(r.value,n.value),t)},e.prototype.parse_drawingInstructionCubicBezierCurve=function(e){for(var t=new h(e);null!==this.read(t," "););var r=this.parse_decimal(t);if(null===r)return e.pop(),null;for(;null!==this.read(t," "););var n=this.parse_decimal(t);if(null===n)return e.pop(),null;for(;null!==this.read(t," "););var o=this.parse_decimal(t);if(null===o)return e.pop(),null;for(;null!==this.read(t," "););var a=this.parse_decimal(t);if(null===a)return e.pop(),null;for(;null!==this.read(t," "););var l=this.parse_decimal(t);if(null===l)return e.pop(),null;for(;null!==this.read(t," "););var s=this.parse_decimal(t);return null===s?(e.pop(),null):(t.value=new i.drawing.CubicBezierCurveInstruction(r.value,n.value,o.value,a.value,l.value,s.value),t)},e.prototype.parse_decimalInt32=function(e){for(var t=new h(e),r=null!==this.read(t,"-"),n=new h(t,""),i=this._b();this._r()&&i>="0"&&"9">=i;i=this._b())n.value+=i;if(0===n.value.length)return e.pop(),null;var o=parseInt(n.value);return o>=4294967295?o=4294967295:r&&(o=-o),t.value=o,t},e.prototype.parse_hexInt32=function(e){for(var t=new h(e),r=null!==this.read(t,"-"),n=new h(t,""),i=this._b();this._r()&&(i>="0"&&"9">=i||i>="a"&&"f">=i||i>="A"&&"F">=i);i=this._b())n.value+=i;if(0===n.value.length)return e.pop(),null;var o=parseInt(n.value,16);return o>=4294967295?o=4294967295:r&&(o=-o),t.value=o,t},e.prototype.parse_decimalOrHexInt32=function(e){var t=new h(e),r=null;return r=null!==this.read(t,"&H")||null!==this.read(t,"&h")?this.parse_hexInt32(t):this.parse_decimalInt32(t),null===r?(e.pop(),null):(t.value=r.value,t)},e.prototype.parse_decimal=function(e){var t=new h(e),r=null!==this.read(t,"-"),n=this.parse_unsignedDecimal(t);return null===n?(e.pop(),null):(t.value=n.value,r&&(t.value=-t.value),t)},e.prototype.parse_unsignedDecimal=function(e){var t,r=new h(e),n=new h(r,""),i=null;for(t=this._b();this._r()&&t>="0"&&"9">=t;t=this._b())n.value+=t;if(0===n.value.length)return e.pop(),null;if(null!==this.read(r,".")){for(i=new h(r,""),t=this._b();this._r()&&t>="0"&&"9">=t;t=this._b())i.value+=t;if(0===i.value.length)return e.pop(),null}return r.value=parseFloat(n.value+(null!==i?"."+i.value:"")),r},e.prototype.parse_enableDisable=function(e){var t=this._b();if("0"===t||"1"===t){var r=new h(e,t);return r.value="1"===r.value,r}return null},e.prototype.parse_color=function(e){for(var t=new h(e);null!==this.read(t,"&")||null!==this.read(t,"H"););var r=this.parse_hexInt32(t);if(null===r)return e.pop(),null;var n=r.value;for(t.value=new i.Color(255&n,n>>8&255,n>>16&255);null!==this.read(t,"&")||null!==this.read(t,"H"););return t},e.prototype.parse_alpha=function(e){for(var t=new h(e);null!==this.read(t,"&")||null!==this.read(t,"H"););var r=this.parse_hexInt32(t);if(null===r)return e.pop(),null;var n=r.value;for(t.value=1-(255&n)/255;null!==this.read(t,"&")||null!==this.read(t,"H"););return t},e.prototype.parse_colorWithAlpha=function(e){var t=new h(e),r=this.parse_decimalOrHexInt32(t);if(null===r)return e.pop(),null;var n=r.value;return t.value=new i.Color(255&n,n>>8&255,n>>16&255,1-(n>>24&255)/255),t},e.prototype.read=function(e,t){return this._b(t.length)!==t?null:new h(e,t)},e.prototype._b=function(e){return void 0===e&&(e=1),1===e?this._av[this._ah.end]:this._av.substr(this._ah.end,e)},e.prototype._r=function(){return this._ah.end<this._av.length},e.prototype._be=function(e,t){var n=new h(t);if(null===this.read(n,e))return t.pop(),null;if(null===this.read(n,"("))return t.pop(),null;var o=null,a=null,l=null,s=null,u=null,p=null,c=this.parse_decimal(n);if(null!==c){if(null===this.read(n,","))return t.pop(),null;var f=this.parse_decimal(n);null!==f?(o=c,l=f):u=c}if(null!==o&&null!==l){if(null===this.read(n,","))return t.pop(),null;if(a=this.parse_decimal(n),null===this.read(n,","))return t.pop(),null;s=this.parse_decimal(n),n.value=new i.RectangularClip(o.value,l.value,a.value,s.value,"clip"===e)}else{p=new h(n,"");for(var d=this._b();this._r()&&")"!==d&&"}"!==d;d=this._b())p.value+=d;n.value=new i.VectorClip(null!==u?u.value:1,r(p.value,"drawingInstructions"),"clip"===e)}return null===this.read(n,")")?(t.pop(),null):n},e}();n("alpha",i.Alpha,l.prototype.parse_alpha,!1),n("be",i.Blur,l.prototype.parse_decimal,!1),n("blur",i.GaussianBlur,l.prototype.parse_decimal,!1),n("bord",i.Border,l.prototype.parse_decimal,!1),n("c",i.PrimaryColor,l.prototype.parse_color,!1),n("fax",i.SkewX,l.prototype.parse_decimal,!1),n("fay",i.SkewY,l.prototype.parse_decimal,!1),n("fr",i.RotateZ,l.prototype.parse_decimal,!1),n("frx",i.RotateX,l.prototype.parse_decimal,!1),n("fry",i.RotateY,l.prototype.parse_decimal,!1),n("frz",i.RotateZ,l.prototype.parse_decimal,!1),n("fs",i.FontSize,l.prototype.parse_decimal,!1),n("fsp",i.LetterSpacing,l.prototype.parse_decimal,!1),n("i",i.Italic,l.prototype.parse_enableDisable,!1),n("p",i.DrawingMode,l.prototype.parse_decimal,!0),n("pbo",i.DrawingBaselineOffset,l.prototype.parse_decimal,!0),n("s",i.StrikeThrough,l.prototype.parse_enableDisable,!1),n("shad",i.Shadow,l.prototype.parse_decimal,!1),n("u",i.Underline,l.prototype.parse_enableDisable,!1),n("xbord",i.BorderX,l.prototype.parse_decimal,!1),n("xshad",i.ShadowX,l.prototype.parse_decimal,!1),n("ybord",i.BorderY,l.prototype.parse_decimal,!1),n("yshad",i.ShadowY,l.prototype.parse_decimal,!1),n("1a",i.PrimaryAlpha,l.prototype.parse_alpha,!1),n("1c",i.PrimaryColor,l.prototype.parse_color,!1),n("2a",i.SecondaryAlpha,l.prototype.parse_alpha,!1),n("2c",i.SecondaryColor,l.prototype.parse_color,!1),n("3a",i.OutlineAlpha,l.prototype.parse_alpha,!1),n("3c",i.OutlineColor,l.prototype.parse_color,!1),n("4a",i.ShadowAlpha,l.prototype.parse_alpha,!1),n("4c",i.ShadowColor,l.prototype.parse_color,!1);for(var s=new a.Map,u=0,p=Object.keys(l.prototype);u<p.length;u++){var c=p[u];0===c.indexOf("parse_")&&"function"==typeof l.prototype[c]&&s.set(c.substr("parse_".length),l.prototype[c])}var h=function(){function e(e,t){void 0===t&&(t=null),this._at=e,this._D=[],null!==e&&e.children.push(this),this._n=null!==e?e.end:0,this._l=this._n,this.value=t}return Object.defineProperty(e.prototype,"start",{get:function(){return this._n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._l},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._at},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._a},set:function(e){this._a=e,null!==this._a&&this._a.constructor===String&&0===this._D.length&&this._aO(this._n+this._a.length)},enumerable:!0,configurable:!0}),e.prototype.pop=function(){this._D.splice(this._D.length-1,1),this._aO(this._D.length>0?this._D[this._D.length-1].end:this.start)},e.prototype._aO=function(e){this._l=e,null!==this._at&&this._at.end!==this._l&&this._at._aO(this._l)},e}(),f=t(31),d=t(34),_=t(36);_.registerWorkerCommand(d.WorkerCommands.Parse,function(e){return new f.Promise(function(t){t(r(e.input,e.rule))})})},function(e,t){var r=t(23),n=t(27),i=t(24),o=t(29),a=t(31),l=t(2),s=function(){function e(e){var t=this;this._Z=e,this._c=new r.ASS,this._a_=new a.DeferredPromise,this._3=new a.DeferredPromise,this._a6=!0,this._ax=null,this._Z.nextLine().then(function(e){return t._ac(e)})}return Object.defineProperty(e.prototype,"minimalASS",{get:function(){return this._a_.promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ass",{get:function(){return this._3.promise},enumerable:!0,configurable:!0}),e.prototype._ac=function(e){var t=this;if(null===e)return this._a_.resolve(this._c),void this._3.resolve(this._c);if("\r"===e[e.length-1]&&(e=e.substr(0,e.length-1)),65279===e.charCodeAt(0)&&this._a6&&(e=e.substr(1)),this._a6=!1,""===e||";"===e[0]);else if("["===e[0]&&"]"===e[e.length-1])"Script Info"===this._ax&&this._a_.resolve(this._c),this._ax=e.substring(1,e.length-1);else switch(this._ax){case"Script Info":var r=l.parseLineIntoProperty(e);if(null!==r)switch(r.name){case"PlayResX":this._c.properties.resolutionX=parseInt(r.value);break;case"PlayResY":this._c.properties.resolutionY=parseInt(r.value);break;case"WrapStyle":this._c.properties.wrappingStyle=parseInt(r.value);break;case"ScaledBorderAndShadow":this._c.properties.scaleBorderAndShadow="yes"===r.value}break;case"V4+ Styles":if(null===this._c.stylesFormatSpecifier){var r=l.parseLineIntoProperty(e);null!==r&&"Format"===r.name&&(this._c.stylesFormatSpecifier=r.value.split(",").map(function(e){return e.trim()}))}else this._c.addStyle(e);break;case"Events":if(null===this._c.dialoguesFormatSpecifier){var r=l.parseLineIntoProperty(e);null!==r&&"Format"===r.name&&(this._c.dialoguesFormatSpecifier=r.value.split(",").map(function(e){return e.trim()}))}else this._c.addEvent(e)}this._Z.nextLine().then(function(e){return t._ac(e)})},e}();e.StreamParser=s;var u=function(){function e(e){var t=this;this._Z=e,this._c=new r.ASS,this._3=new a.DeferredPromise,this._ae=null,this._G=null,this._K=null,this._x=null,this._Z.nextLine().then(function(e){return t._ac(e)}),this._c.properties.resolutionX=1280,this._c.properties.resolutionY=720,this._c.properties.wrappingStyle=1,this._c.properties.scaleBorderAndShadow=!0;var i=new n.Style(new o.Map([["Name","Default"]]));this._c.styles.set(i.name,i)}return Object.defineProperty(e.prototype,"ass",{get:function(){return this._3.promise},enumerable:!0,configurable:!0}),e.prototype._ac=function(e){var t=this;if(null===e)return null!==this._ae&&null!==this._G&&null!==this._K&&null!==this._x&&this._c.dialogues.push(new i.Dialogue(new o.Map([["Style","Default"],["Start",this._G],["End",this._K],["Text",this._x]]),this._c)),void this._3.resolve(this._c);if("\r"===e[e.length-1]&&(e=e.substr(0,e.length-1)),""===e)null!==this._ae&&null!==this._G&&null!==this._K&&null!==this._x&&this._c.dialogues.push(new i.Dialogue(new o.Map([["Style","Default"],["Start",this._G],["End",this._K],["Text",this._x]]),this._c)),this._ae=this._G=this._K=this._x=null;else if(null===this._ae)/^\d+$/.test(e)&&(this._ae=e);else if(null===this._G&&null===this._K){var r=/^(\d\d:\d\d:\d\d,\d\d\d) --> (\d\d:\d\d:\d\d,\d\d\d)/.exec(e);null!==r&&(this._G=r[1].replace(",","."),this._K=r[2].replace(",","."))}else e=e.replace(/<b>/g,"{\\b1}").replace(/\{b\}/g,"{\\b1}").replace(/<\/b>/g,"{\\b0}").replace(/\{\/b\}/g,"{\\b0}").replace(/<i>/g,"{\\i1}").replace(/\{i\}/g,"{\\i1}").replace(/<\/i>/g,"{\\i0}").replace(/\{\/i\}/g,"{\\i0}").replace(/<u>/g,"{\\u1}").replace(/\{u\}/g,"{\\u1}").replace(/<\/u>/g,"{\\u0}").replace(/\{\/u\}/g,"{\\u0}").replace(/<font color="#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})">/g,function(e,t,r,n){return"{c&H"+n+r+t+"&}"}).replace(/<\/font>/g,"{\\c}"),null!==this._x?this._x+="\\N"+e:this._x=e;this._Z.nextLine().then(function(e){return t._ac(e)})},e}();e.SrtStreamParser=u},function(t,r){var n=r(31),i=function(){function e(e){this._4=e,this._m=0}return e.prototype.nextLine=function(){var e=null;if(this._m<this._4.length){var t=this._4.indexOf("\n",this._m);-1!==t?(e=n.Promise.resolve(this._4.substring(this._m,t)),this._m=t+1):(e=n.Promise.resolve(this._4.substr(this._m)),this._m=this._4.length)}else e=n.Promise.resolve(null);return e},e}();t.StringStream=i;var o=function(){function e(e){var t=this;this._a2=e,this._m=0,this._g=null,e.addEventListener("progress",function(e){return t._b5(e)},!1),e.addEventListener("loadend",function(e){return t._b4(e)},!1)}return e.prototype.nextLine=function(){if(null!==this._g)throw new Error("XhrStream only supports one pending unfulfilled read at a time.");var e=this._g=new n.DeferredPromise;return this._U(),e.promise},e.prototype._b5=function(){null!==this._g&&this._U()},e.prototype._b4=function(){null!==this._g&&this._U()},e.prototype._U=function(){var e=this._a2.responseText,t=e.indexOf("\n",this._m);-1!==t?(this._g.resolve(e.substring(this._m,t)),this._m=t+1,this._g=null):this._a2.readyState===XMLHttpRequest.DONE&&(this._m<e.length?(this._g.resolve(e.substr(this._m)),this._m=e.length):this._g.resolve(null),this._g=null)},e}();t.XhrStream=o;var a=function(){function t(t,r){this._w="",this._g=null,this._b3=t.getReader(),this._b$=new e.TextDecoder(r,{ignoreBOM:!0})}return t.prototype.nextLine=function(){if(null!==this._g)throw new Error("BrowserReadableStream only supports one pending unfulfilled read at a time.");var e=this._g=new n.DeferredPromise;return this._U(),e.promise},t.prototype._U=function(){var e=this,t=this._w.indexOf("\n");-1!==t?(this._g.resolve(this._w.substr(0,t)),this._w=this._w.substr(t+1),this._g=null):this._b3.read().then(function(t){var r=t.value,n=t.done;n?(0===e._w.length?e._g.resolve(null):(e._g.resolve(e._w),e._w=""),e._g=null):(e._w+=e._b$.decode(r,{stream:!0}),e._U())})},t}();t.BrowserReadableStream=a},function(e){var t=function(){function e(e,t){this._J=e,this._I=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._J},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._I},enumerable:!0,configurable:!0}),e}();e.MoveInstruction=t;var r=function(){function e(e,t){this._J=e,this._I=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._J},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._I},enumerable:!0,configurable:!0}),e}();e.LineInstruction=r;var n=function(){function e(e,t,r,n,i,o){this._5=e,this._6=t,this._aa=r,this._ab=n,this._bZ=i,this._bY=o}return Object.defineProperty(e.prototype,"x1",{get:function(){return this._5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._6},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this._aa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this._ab},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x3",{get:function(){return this._bZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y3",{get:function(){return this._bY},enumerable:!0,configurable:!0
}),e}();e.CubicBezierCurveInstruction=n},function(e,t){var r=t(6);e.drawing=r;var n=function(){function e(e,t,r,n){void 0===n&&(n=1),this._aD=e,this._aE=t,this._aH=r,this._bf=n}return Object.defineProperty(e.prototype,"red",{get:function(){return this._aD},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"green",{get:function(){return this._aE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blue",{get:function(){return this._aH},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._bf},enumerable:!0,configurable:!0}),e.prototype.withAlpha=function(t){return null!==t?new e(this._aD,this._aE,this._aH,t):this},e.prototype.toString=function(){return"rgba("+this._aD+", "+this._aE+", "+this._aH+", "+this._bf.toFixed(3)+")"},e}();e.Color=n;var i=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Comment=i;var o=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return"Text { value: "+this._a.replace(/\u00A0/g,"\\h")+" }"},e}();e.Text=o;var a=function(){function e(){}return e}();e.NewLine=a;var l=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Italic=l;var s=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Bold=s;var u=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Underline=u;var p=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.StrikeThrough=p;var c=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Border=c;var h=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.BorderX=h;var f=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.BorderY=f;var d=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Shadow=d;var _=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.ShadowX=_;var g=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.ShadowY=g;var y=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Blur=y;var v=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.GaussianBlur=v;var m=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.FontName=m;var b=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.FontSize=b;var w=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.FontSizePlus=w;var S=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.FontSizeMinus=S;var P=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.FontScaleX=P;var k=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.FontScaleY=k;var O=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.LetterSpacing=O;var x=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.RotateX=x;var C=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.RotateY=C;var j=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.RotateZ=j;var E=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.SkewX=E;var D=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.SkewY=D;var T=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.PrimaryColor=T;var M=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.SecondaryColor=M;var F=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.OutlineColor=F;var A=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.ShadowColor=A;var R=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Alpha=R;var N=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.PrimaryAlpha=N;var L=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.SecondaryAlpha=L;var W=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.OutlineAlpha=W;var I=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.ShadowAlpha=I;var X=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Alignment=X;var Y=function(){function e(e){this._V=e}return Object.defineProperty(e.prototype,"duration",{get:function(){return this._V},enumerable:!0,configurable:!0}),e}();e.ColorKaraoke=Y;var z=function(){function e(e){this._V=e}return Object.defineProperty(e.prototype,"duration",{get:function(){return this._V},enumerable:!0,configurable:!0}),e}();e.SweepingColorKaraoke=z;var B=function(){function e(e){this._V=e}return Object.defineProperty(e.prototype,"duration",{get:function(){return this._V},enumerable:!0,configurable:!0}),e}();e.OutlineKaraoke=B;var q=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.WrappingStyle=q;var K=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.Reset=K;var H=function(){function e(e,t){this._J=e,this._I=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._J},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._I},enumerable:!0,configurable:!0}),e}();e.Position=H;var V=function(){function e(e,t,r,n,i,o){this._5=e,this._6=t,this._aa=r,this._ab=n,this._aP=i,this._aQ=o}return Object.defineProperty(e.prototype,"x1",{get:function(){return this._5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._6},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this._aa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this._ab},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t1",{get:function(){return this._aP},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t2",{get:function(){return this._aQ},enumerable:!0,configurable:!0}),e}();e.Move=V;var U=function(){function e(e,t){this._J=e,this._I=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._J},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._I},enumerable:!0,configurable:!0}),e}();e.RotationOrigin=U;var G=function(){function e(e,t){this._n=e,this._l=t}return Object.defineProperty(e.prototype,"start",{get:function(){return this._n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._l},enumerable:!0,configurable:!0}),e}();e.Fade=G;var Z=function(){function e(e,t,r,n,i,o,a){this._bX=e,this._bW=t,this._bV=r,this._aP=n,this._aQ=i,this._bU=o,this._bT=a}return Object.defineProperty(e.prototype,"a1",{get:function(){return this._bX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a2",{get:function(){return this._bW},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a3",{get:function(){return this._bV},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t1",{get:function(){return this._aP},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t2",{get:function(){return this._aQ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t3",{get:function(){return this._bU},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"t4",{get:function(){return this._bT},enumerable:!0,configurable:!0}),e}();e.ComplexFade=Z;var J=function(){function e(e,t,r,n){this._n=e,this._l=t,this._bS=r,this._bR=n}return Object.defineProperty(e.prototype,"start",{get:function(){return this._n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._l},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accel",{get:function(){return this._bS},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tags",{get:function(){return this._bR},enumerable:!0,configurable:!0}),e}();e.Transform=J;var Q=function(){function e(e,t,r,n,i){this._5=e,this._6=t,this._aa=r,this._ab=n,this._ay=i}return Object.defineProperty(e.prototype,"x1",{get:function(){return this._5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._6},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x2",{get:function(){return this._aa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2",{get:function(){return this._ab},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inside",{get:function(){return this._ay},enumerable:!0,configurable:!0}),e}();e.RectangularClip=Q;var $=function(){function e(e,t,r){this._T=e,this._aC=t,this._ay=r}return Object.defineProperty(e.prototype,"scale",{get:function(){return this._T},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instructions",{get:function(){return this._aC},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inside",{get:function(){return this._ay},enumerable:!0,configurable:!0}),e}();e.VectorClip=$;var ee=function(){function e(e){this._T=e}return Object.defineProperty(e.prototype,"scale",{get:function(){return this._T},enumerable:!0,configurable:!0}),e}();e.DrawingMode=ee;var te=function(){function e(e){this._a=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),e}();e.DrawingBaselineOffset=te;var re=function(){function e(e){this._aC=e}return Object.defineProperty(e.prototype,"instructions",{get:function(){return this._aC},enumerable:!0,configurable:!0}),e}();e.DrawingInstructions=re;for(var ne=function(e,t){if(!e.prototype.hasOwnProperty("toString")){var r=Object.getOwnPropertyNames(e.prototype).filter(function(e){return"constructor"!==e});e.prototype.toString=function(){var e=this;return t+" { "+r.map(function(t){return t+": "+e[t]}).join(", ")+(r.length>0?" ":"")+"}"}}},ie=t(36),oe=0,ae=Object.keys(e);oe<ae.length;oe++){var le=ae[oe],se=e[le];se instanceof Function&&(ne(se,le),ie.registerClassPrototype(se.prototype))}for(var ue=0,pe=Object.keys(r);ue<pe.length;ue++){var le=pe[ue],se=r[le];se instanceof Function&&(ne(se,"Drawing"+le),ie.registerClassPrototype(se.prototype))}},function(e,t){var r=t(22),n=t(10),i=function(){function e(e,t){this._a5=e,this._bQ=t,this._d=new n.ManualClock,this._B=null,this._8=null,this._9=null}return e.prototype.play=function(){this._d.enabled&&(this._bg(),this._d.play())},e.prototype.pause=function(){if(this._d.enabled){if(null===this._B)return void(r.debugMode&&console.warn("AutoClock.pause: Abnormal state detected. AutoClock._nextAnimationFrameRequestId should not have been null."));this._bh(),this._d.pause()}},e.prototype.seeking=function(){this._d.seek(this._a5())},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._d.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._d.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._d.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rate",{get:function(){return this._d.rate},enumerable:!0,configurable:!0}),e.prototype.setRate=function(e){this._d.setRate(e)},e.prototype.enable=function(){return this._d.enable()?(this._bg(),!0):!1},e.prototype.disable=function(){return this._d.disable()?(this._bh(),!0):!1},e.prototype.toggle=function(){this._d.toggle()},e.prototype.setEnabled=function(e){return this._d.setEnabled(e)},e.prototype.addEventListener=function(e,t){this._d.addEventListener(e,t)},e.prototype._bi=function(e){var t=this;if(!this._d.enabled)return void(r.debugMode&&console.warn("AutoClock._onTimerTick: Called when disabled."));var n=this._d.currentTime,i=this._a5();this._d.paused?n!==i&&(this._8=i,this._9=e,this._d.tick(i)):null!==this._8&&i===this._8?e-this._9>this._bQ?(this._9=null,this._d.pause()):this._d.tick((e-this._9)/1e3*this._d.rate+this._8):(this._8=i,this._9=e,this._d.tick(i)),this._B=requestAnimationFrame(function(e){return t._bi(e)})},e.prototype._bg=function(){var e=this;null===this._B&&(this._B=requestAnimationFrame(function(t){return e._bi(t)}))},e.prototype._bh=function(){null!==this._B&&(cancelAnimationFrame(this._B),this._B=null)},e}();e.AutoClock=i},function(e){var t=function(){function e(){}return e.prototype.addEventListener=function(e,t){var r=this._ap.get(e);void 0===r&&this._ap.set(e,r=[]),r.push(t)},e.prototype._y=function(e,t){var r=this._ap.get(e);if(void 0!==r)for(var n=0;n<r.length;n++){var i=r[n];i.apply(this,t)}},e}();e.EventSource=t,function(e){e[e.Play=0]="Play",e[e.Tick=1]="Tick",e[e.Pause=2]="Pause",e[e.Stop=3]="Stop",e[e.RateChange=4]="RateChange"}(e.ClockEvent||(e.ClockEvent={}))},function(e,t){var r=t(30),n=t(29),i=t(9),o=function(){function e(){this._ao=-1,this._2=1,this._t=!0,this._af=!0,this._ap=new n.Map}return e.prototype.play=function(){this._t&&this._af&&(this._af=!1,this._y(i.ClockEvent.Play,[]))},e.prototype.tick=function(e){this._t&&(this._ao!==e&&this.play(),this._ao=e,this._y(i.ClockEvent.Tick,[]))},e.prototype.seek=function(e){this._t&&(this.pause(),this._ao!==e&&(this.stop(),this.tick(e),this.pause()))},e.prototype.pause=function(){this._t&&(this._af||(this._af=!0,this._y(i.ClockEvent.Pause,[])))},e.prototype.stop=function(){this._y(i.ClockEvent.Stop,[])},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._ao},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._af},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rate",{get:function(){return this._2},enumerable:!0,configurable:!0}),e.prototype.setRate=function(e){this._2!==e&&(this._2=e,this._y(i.ClockEvent.RateChange,[]))},e.prototype.enable=function(){return this._t?!1:(this._t=!0,!0)},e.prototype.disable=function(){return this._t?(this._t=!1,this.pause(),this.stop(),!0):!1},e.prototype.toggle=function(){this._t?this.disable():this.enable()},e.prototype.setEnabled=function(e){return e?this.enable():this.disable()},e}();e.ManualClock=o,r.mixin(o,[i.EventSource])},function(e,t){var r=t(8),n=function(){function e(e){var t=this;this._k=new r.AutoClock(function(){return e.currentTime},100),e.addEventListener("playing",function(){return t._k.play()},!1),e.addEventListener("pause",function(){return t._k.pause()},!1),e.addEventListener("seeking",function(){return t._k.seeking()},!1),e.addEventListener("ratechange",function(){return t._k.setRate(e.playbackRate)},!1)}return Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._k.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._k.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._k.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rate",{get:function(){return this._k.rate},enumerable:!0,configurable:!0}),e.prototype.enable=function(){return this._k.enable()},e.prototype.disable=function(){return this._k.disable()},e.prototype.toggle=function(){this._k.toggle()},e.prototype.setEnabled=function(e){return this._k.setEnabled(e)},e.prototype.addEventListener=function(e,t){this._k.addEventListener(e,t)},e}();e.VideoClock=n},function(e,t){var r=t(28).__extends,n=t(11),i=t(20),o=function(e){function t(t,r,i){e.call(this,r,new n.VideoClock(t),document.createElement("div"),i),this._S=t,this._X=!1,this._S.parentElement.replaceChild(this.libjassSubsWrapper,this._S),this.libjassSubsWrapper.insertBefore(this._S,this.libjassSubsWrapper.firstElementChild)}return r(t,e),t.prototype.resizeVideo=function(e,t){console.warn("`DefaultRenderer.resizeVideo(width, height)` has been deprecated. Use `DefaultRenderer.resize(width, height)` instead."),this.resize(e,t)},t.prototype._az=function(){var t=this;document.addEventListener("mozfullscreenchange",function(){return t._aA(document.mozFullScreenElement)},!1),document.addEventListener("webkitfullscreenchange",function(){return t._aA(document.webkitFullscreenElement)},!1),document.addEventListener("fullscreenchange",function(){return t._aA(document.fullscreenElement)},!1),this.resize(this._S.offsetWidth,this._S.offsetHeight),e.prototype._az.call(this)},t.prototype._aA=function(e){void 0===e&&(e=document.msFullscreenElement),e===this._S?(this.libjassSubsWrapper.classList.add("libjass-full-screen"),this.resize(screen.width,screen.height),this._X=!0,this._y("fullScreenChange",[this._X])):null===e&&this._X&&(this.libjassSubsWrapper.classList.remove("libjass-full-screen"),this._X=!1,this._y("fullScreenChange",[this._X]))},t}(i.WebRenderer);e.DefaultRenderer=o},function(e,t){var r=t(9);e.ClockEvent=r.ClockEvent,e.EventSource=r.EventSource;var n=t(8);e.AutoClock=n.AutoClock;var i=t(10);e.ManualClock=i.ManualClock;var o=t(11);e.VideoClock=o.VideoClock;var a=t(12);e.DefaultRenderer=a.DefaultRenderer;var l=t(14);e.NullRenderer=l.NullRenderer;var s=t(20);e.WebRenderer=s.WebRenderer;var u=t(15);e.RendererSettings=u.RendererSettings},function(e,t){var r=t(9),n=t(15),i=t(22),o=function(){function e(t,i,o){var a=this;this._c=t,this._p=i,this._z=++e._bP,this.__=n.RendererSettings.from(o),this._p.addEventListener(r.ClockEvent.Play,function(){return a._aG()}),this._p.addEventListener(r.ClockEvent.Tick,function(){return a._am()}),this._p.addEventListener(r.ClockEvent.Pause,function(){return a._aI()}),this._p.addEventListener(r.ClockEvent.Stop,function(){return a._aJ()}),this._p.addEventListener(r.ClockEvent.RateChange,function(){return a._aN()})}return Object.defineProperty(e.prototype,"id",{get:function(){return this._z},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ass",{get:function(){return this._c},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clock",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"settings",{get:function(){return this.__},enumerable:!0,configurable:!0}),e.prototype.preRender=function(){},e.prototype.draw=function(){},e.prototype.enable=function(){return this._p.enable()},e.prototype.disable=function(){return this._p.disable()},e.prototype.toggle=function(){this._p.toggle()},e.prototype.setEnabled=function(e){return this._p.setEnabled(e)},Object.defineProperty(e.prototype,"enabled",{get:function(){return this._p.enabled},enumerable:!0,configurable:!0}),e.prototype._aG=function(){i.verboseMode&&console.log("NullRenderer._onClockPlay")},e.prototype._am=function(){var e=this._p.currentTime;i.verboseMode&&console.log("NullRenderer._onClockTick: currentTime = "+e);for(var t=0,r=this._c.dialogues;t<r.length;t++){var n=r[t];n.end>e&&(n.start<=e?this.draw(n):n.start<=e+this.__.preRenderTime&&this.preRender(n))}},e.prototype._aI=function(){i.verboseMode&&console.log("NullRenderer._onClockPause")},e.prototype._aJ=function(){i.verboseMode&&console.log("NullRenderer._onClockStop")},e.prototype._aN=function(){i.verboseMode&&console.log("NullRenderer._onClockRateChange")},e._bP=-1,e}();e.NullRenderer=o},function(e,t){var r=t(29),n=function(){function e(){}return e.makeFontMapFromStyleElement=function(t){for(var n=new r.Map,i=t.sheet,o=Array.prototype.filter.call(i.cssRules,function(e){return e.type===CSSRule.FONT_FACE_RULE}),a=0;a<o.length;a++){var l=o[a],s=l.style.getPropertyValue("src");s||(s=l.cssText.split("\n").map(function(e){return e.match(/src: ([^;]+);/)}).filter(function(e){return null!==e}).map(function(e){return e[1]})[0]);var u=s.split(/,\s*/).map(function(t){return e._bm(t.match(/^url\((.+)\)$/)[1])});if(u.length>0){var p=e._bm(l.style.getPropertyValue("font-family")),c=n.get(p);void 0===c&&(c=[],n.set(p,c)),c.unshift.apply(c,u)}}return n},e.from=function(t){(void 0===t||null===t)&&(t={});var r=t,n=r.fontMap,i=void 0===n?null:n,o=r.preRenderTime,a=void 0===o?5:o,l=r.preciseOutlines,s=void 0===l?!1:l,u=r.enableSvg,p=void 0===u?!0:u,c=new e;return c.fontMap=i,c.preRenderTime=a,c.preciseOutlines=s,c.enableSvg=p,c},e._bm=function(e){return e.match(/^["']?(.*?)["']?$/)[1]},e}();e.RendererSettings=n},function(e,t){var r=t(29),n=function(){function e(t){this._bo="",this._al="",this._a4=new r.Map,this._bI=0,this._z=t.id+"-"+e._bD++,this._2=t.clock.rate}return Object.defineProperty(e.prototype,"cssText",{get:function(){return this._bo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationStyle",{get:function(){return this._al},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationDelays",{get:function(){return this._a4},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){for(var r=null,n=null,i=0;i<t.length;i++){var o=t[i];null===r&&(r=o.time),n=o.time}for(var a="",l=0;l<t.length;l++){var o=t[l];a+="	"+(100*(n-r===0?1:(o.time-r)/(n-r))).toFixed(3)+"% {\n",o.properties.forEach(function(e,t){a+="		"+t+": "+e+";\n"}),a+="	}\n"}var s="animation-"+this._z+"-"+this._bI++;this._bo+="@-webkit-keyframes "+s+" {\n"+a+"\n}\n\n@keyframes "+s+" {\n"+a+"\n}\n\n",""!==this._al&&(this._al+=","),this._al+=s+" "+((n-r)/this._2).toFixed(3)+"s "+e,this._a4.set(s,r)},e._bD=0,e}();e.AnimationCollection=n},function(e){e.domParser=null,"undefined"!=typeof DOMParser&&(e.domParser=new DOMParser)},function(e,t){var r=t(17),n=t(7),i=function(){function e(e,t){this._bC=e,this._bB=t,this._T=1,this._s=0}return Object.defineProperty(e.prototype,"scale",{set:function(e){this._T=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineOffset",{set:function(e){this._s=e},enumerable:!0,configurable:!0}),e.prototype.toSVG=function(e,t){for(var i=Math.pow(2,this._T-1),o=this._bC/i,a=this._bB/i,l="",s=0,u=0,p=0,c=e.instructions;p<c.length;p++){var h=c[p];h instanceof n.drawing.MoveInstruction?(l+=" M "+h.x+" "+(h.y+this._s),s=Math.max(s,h.x),u=Math.max(u,h.y+this._s)):h instanceof n.drawing.LineInstruction?(l+=" L "+h.x+" "+(h.y+this._s),s=Math.max(s,h.x),u=Math.max(u,h.y+this._s)):h instanceof n.drawing.CubicBezierCurveInstruction&&(l+=" C "+h.x1+" "+(h.y1+this._s)+", "+h.x2+" "+(h.y2+this._s)+", "+h.x3+" "+(h.y3+this._s),s=Math.max(s,h.x1,h.x2,h.x3),u=Math.max(u,h.y1+this._s,h.y2+this._s,h.y3+this._s))}var f='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+(s*o).toFixed(3)+'px" height="'+(u*a).toFixed(3)+'px">\n<g transform="scale('+o.toFixed(3)+" "+a.toFixed(3)+')">\n	<path d="'+l+'" fill="'+t.toString()+'" />\n</g>\n</svg>';return r.domParser.parseFromString(f,"image/svg+xml").childNodes[0]},e}();e.DrawingStyles=i},function(e){var t=function(){function e(e,t){this._b8=e,this._aY=t}return Object.defineProperty(e.prototype,"time",{get:function(){return this._b8},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._aY},enumerable:!0,configurable:!0}),e}();e.Keyframe=t},function(e,t){var r=t(28).__extends,n=t(16),i=t(18),o=t(19),a=t(21),l=t(9),s=t(14),u=t(7),p=t(22),c=t(25),h=t(30),f=t(29),d=t(32),_=t(31),g=function(e){function t(t,r,n,i){var o=this;e.call(this,t,r,function(){if(!(n instanceof HTMLDivElement)){var e=i;i=n,n=e,console.warn("WebRenderer's constructor now takes libjassSubsWrapper as the third parameter and settings as the fourth parameter. Please update the caller.")}return i}()),this._7=n,this._N=[],this._H=[],this._P=new f.Map,this._Q=new f.Map,this._ap=new f.Map,this._7.classList.add("libjass-wrapper"),this._q=document.createElement("div"),this._7.appendChild(this._q),this._q.className="libjass-subs",this._F=document.createElement("div"),this._7.appendChild(this._F),this._F.className="libjass-font-measure",this._F.appendChild(document.createTextNode("M")),this._j=document.createElement("style"),this._j.id="libjass-animation-styles-"+this.id,this._j.type="text/css",document.querySelector("head").appendChild(this._j);var a=document.createElementNS("http://www.w3.org/2000/svg","svg");this._7.appendChild(a),a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("version","1.1"),a.setAttribute("class","libjass-filters"),a.setAttribute("width","0"),a.setAttribute("height","0"),this._v=document.createElementNS("http://www.w3.org/2000/svg","defs"),a.appendChild(this._v);var l=new d.Set;null!==this.settings.fontMap&&this.settings.fontMap.forEach(function(e){for(var t=0;t<e.length;t++){var r=e[t];l.add(r)}}),p.debugMode&&console.log("Preloading "+l.size+" fonts...");var s=[];l.forEach(function(e){s.push(new _.Promise(function(t){var r=new XMLHttpRequest;r.addEventListener("load",function(){p.debugMode&&console.log("Preloaded "+e+"."),t(null)}),r.open("GET",e,!0),r.send()}))}),_.Promise.all(s).then(function(){p.debugMode&&console.log("All fonts have been preloaded."),o._az()})}return r(t,e),Object.defineProperty(t.prototype,"libjassSubsWrapper",{get:function(){return this._7},enumerable:!0,configurable:!0}),t.prototype.resize=function(e,t){this._a7();var r=Math.min(e/this.ass.properties.resolutionX,t/this.ass.properties.resolutionY),n=this.ass.properties.resolutionX*r,i=this.ass.properties.resolutionY*r;if(this._q.style.width=n.toFixed(3)+"px",this._q.style.height=i.toFixed(3)+"px",this._q.style.left=((e-n)/2).toFixed(3)+"px",this._q.style.top=((t-i)/2).toFixed(3)+"px",this._i=n/this.ass.properties.resolutionX,this._h=i/this.ass.properties.resolutionY,this._Q.clear(),null!==this._j)for(;null!==this._j.firstChild;)this._j.removeChild(this._j.firstChild);for(;null!==this._v.firstChild;)this._v.removeChild(this._v.firstChild);-1!==this.clock.currentTime&&this._am()},t.prototype.preRender=function(e){var r=this;if(!this._Q.has(e.id)){var l=document.createElement("div");l.style.marginLeft=(this._i*e.style.marginLeft).toFixed(3)+"px",l.style.marginRight=(this._i*e.style.marginRight).toFixed(3)+"px",l.style.marginTop=l.style.marginBottom=(this._h*e.style.marginVertical).toFixed(3)+"px",l.style.minWidth=(this._q.offsetWidth-this._i*(e.style.marginLeft+e.style.marginRight)).toFixed(3)+"px";var s=new n.AnimationCollection(this),h=null,d=new a.SpanStyles(this,e,this._i,this._h,this.settings,this._F,this._v),_=null,g=!1,y=function(e){null!==h&&""!==h.textContent&&l.appendChild(d.setStylesOnSpan(h,_,r._j)),null!==_&&_.animationDelays.forEach(function(e,t){return s.animationDelays.set(t,e)}),e&&l.appendChild(g?d.makeNewLine():document.createElement("br")),h=document.createElement("span"),_=new n.AnimationCollection(r),g=e};y(!1);for(var v=new i.DrawingStyles(this._i,this._h),m=this.ass.properties.wrappingStyle,b=0,w=0,S=e.parts;w<S.length;w++){var P=S[w];P instanceof u.Italic?d.italic=P.value:P instanceof u.Bold?d.bold=P.value:P instanceof u.Underline?d.underline=P.value:P instanceof u.StrikeThrough?d.strikeThrough=P.value:P instanceof u.Border?(d.outlineWidth=P.value,d.outlineHeight=P.value):P instanceof u.BorderX?d.outlineWidth=P.value:P instanceof u.BorderY?d.outlineHeight=P.value:P instanceof u.Shadow?(d.shadowDepthX=P.value,d.shadowDepthY=P.value):P instanceof u.ShadowX?d.shadowDepthX=P.value:P instanceof u.ShadowY?d.shadowDepthY=P.value:P instanceof u.Blur?d.blur=P.value:P instanceof u.GaussianBlur?d.gaussianBlur=P.value:P instanceof u.FontName?d.fontName=P.value:P instanceof u.FontSize?d.fontSize=P.value:P instanceof u.FontSizePlus?d.fontSize+=P.value:P instanceof u.FontSizeMinus?d.fontSize-=P.value:P instanceof u.FontScaleX?d.fontScaleX=P.value:P instanceof u.FontScaleY?d.fontScaleY=P.value:P instanceof u.LetterSpacing?d.letterSpacing=P.value:P instanceof u.RotateX?d.rotationX=P.value:P instanceof u.RotateY?d.rotationY=P.value:P instanceof u.RotateZ?d.rotationZ=P.value:P instanceof u.SkewX?d.skewX=P.value:P instanceof u.SkewY?d.skewY=P.value:P instanceof u.PrimaryColor?d.primaryColor=P.value:P instanceof u.SecondaryColor?d.secondaryColor=P.value:P instanceof u.OutlineColor?d.outlineColor=P.value:P instanceof u.ShadowColor?d.shadowColor=P.value:P instanceof u.Alpha?(d.primaryAlpha=P.value,d.secondaryAlpha=P.value,d.outlineAlpha=P.value,d.shadowAlpha=P.value):P instanceof u.PrimaryAlpha?d.primaryAlpha=P.value:P instanceof u.SecondaryAlpha?d.secondaryAlpha=P.value:P instanceof u.OutlineAlpha?d.outlineAlpha=P.value:P instanceof u.ShadowAlpha?d.shadowAlpha=P.value:P instanceof u.Alignment||(P instanceof u.ColorKaraoke?(y(!1),_.add("step-end",[new o.Keyframe(0,new f.Map([["color",d.secondaryColor.withAlpha(d.secondaryAlpha).toString()]])),new o.Keyframe(b,new f.Map([["color",d.primaryColor.withAlpha(d.primaryAlpha).toString()]]))]),b+=P.duration):P instanceof u.WrappingStyle?m=P.value:P instanceof u.Reset?d.reset(this.ass.styles.get(P.value)):P instanceof u.Position?(l.style.position="absolute",l.style.left=(this._i*P.x).toFixed(3)+"px",l.style.top=(this._h*P.y).toFixed(3)+"px"):P instanceof u.Move?(l.style.position="absolute",s.add("linear",[new o.Keyframe(0,new f.Map([["left",(this._i*P.x1).toFixed(3)+"px"],["top",(this._h*P.y1).toFixed(3)+"px"]])),new o.Keyframe(P.t1,new f.Map([["left",(this._i*P.x1).toFixed(3)+"px"],["top",(this._h*P.y1).toFixed(3)+"px"]])),new o.Keyframe(P.t2,new f.Map([["left",(this._i*P.x2).toFixed(3)+"px"],["top",(this._h*P.y2).toFixed(3)+"px"]])),new o.Keyframe(e.end-e.start,new f.Map([["left",(this._i*P.x2).toFixed(3)+"px"],["top",(this._h*P.y2).toFixed(3)+"px"]]))])):P instanceof u.Fade?s.add("linear",[new o.Keyframe(0,new f.Map([["opacity","0"]])),new o.Keyframe(P.start,new f.Map([["opacity","1"]])),new o.Keyframe(e.end-e.start-P.end,new f.Map([["opacity","1"]])),new o.Keyframe(e.end-e.start,new f.Map([["opacity","0"]]))]):P instanceof u.ComplexFade?s.add("linear",[new o.Keyframe(0,new f.Map([["opacity",P.a1.toFixed(3)]])),new o.Keyframe(P.t1,new f.Map([["opacity",P.a1.toFixed(3)]])),new o.Keyframe(P.t2,new f.Map([["opacity",P.a2.toFixed(3)]])),new o.Keyframe(P.t3,new f.Map([["opacity",P.a2.toFixed(3)]])),new o.Keyframe(P.t4,new f.Map([["opacity",P.a3.toFixed(3)]])),new o.Keyframe(e.end-e.start,new f.Map([["opacity",P.a3.toFixed(3)]]))]):P instanceof u.DrawingMode?0!==P.scale&&(v.scale=P.scale):P instanceof u.DrawingBaselineOffset?v.baselineOffset=P.value:P instanceof u.DrawingInstructions?(h.appendChild(v.toSVG(P,d.primaryColor.withAlpha(d.primaryAlpha))),
y(!1)):P instanceof u.Text?(h.appendChild(document.createTextNode(P.value)),y(!1)):p.debugMode&&P instanceof u.Comment?(h.appendChild(document.createTextNode(P.value)),y(!1)):P instanceof u.NewLine&&y(!0))}for(var k=0,O=e.parts;k<O.length;k++){var P=O[k];if(P instanceof u.Position||P instanceof u.Move){var x=t._bz[e.alignment],C="translate("+-x[0]+"%, "+-x[1]+"%) translate(-"+l.style.marginLeft+", -"+l.style.marginTop+")",j=x[0]+"% "+x[1]+"%";l.style.webkitTransform=C,l.style.webkitTransformOrigin=j,l.style.transform=C,l.style.transformOrigin=j;break}}switch(m){case c.WrappingStyle.EndOfLineWrapping:l.style.whiteSpace="pre-wrap";break;case c.WrappingStyle.NoLineWrapping:l.style.whiteSpace="pre";break;case c.WrappingStyle.SmartWrappingWithWiderTopLine:case c.WrappingStyle.SmartWrappingWithWiderBottomLine:l.style.whiteSpace="pre-wrap"}if(""!==l.style.position)switch(e.alignment){case 1:case 4:case 7:l.style.textAlign="left";break;case 2:case 5:case 8:l.style.textAlign="center";break;case 3:case 6:case 9:l.style.textAlign="right"}this._j.appendChild(document.createTextNode(s.cssText)),l.style.webkitAnimation=s.animationStyle,l.style.animation=s.animationStyle,l.setAttribute("data-dialogue-id",this.id+"-"+e.id),this._Q.set(e.id,{sub:l,animationDelays:s.animationDelays})}},t.prototype.draw=function(e){var t=this;if(!this._P.has(e)){p.debugMode&&console.log(e.toString());var r=this._Q.get(e.id);void 0===r&&(p.debugMode&&console.warn("This dialogue was not pre-rendered. Call preRender() before calling draw() so that draw() is faster."),this.preRender(e),r=this._Q.get(e.id),p.debugMode&&console.log(e.toString()));var n=r.sub.cloneNode(!0),i=function(n){var i=n.style.animationName||n.style.webkitAnimationName;if(void 0!==i&&""!==i){var o=i.split(",").map(function(n){n=n.trim();var i=r.animationDelays.get(n);return((i+e.start-t.clock.currentTime)/t.clock.rate).toFixed(3)+"s"}).join(", ");n.style.webkitAnimationDelay=o,n.style.animationDelay=o}};i(n);for(var o=n.querySelectorAll('[style*="animation:"]'),a=0;a<o.length;a++)i(o[a]);var l=e.layer,s="absolute"===n.style.position?0:e.alignment;if(void 0===this._N[l]){var u=document.createElement("div");u.className="layer layer"+l;for(var c=null,h=l+1;h<this._N.length&&null===c;h++)void 0!==this._N[h]&&(c=this._N[h]);this._q.insertBefore(u,c),this._N[l]=u,this._H[l]=[]}if(void 0===this._H[l][s]){var f=document.createElement("div");f.className="an an"+s;for(var u=this._N[l],c=null,d=s+1;d<this._H[l].length&&null===c;d++)void 0!==this._H[l][d]&&(c=this._H[l][d]);u.insertBefore(f,c),this._H[l][s]=f}this._H[l][s].appendChild(n),this._P.set(e,n)}},t.prototype._aG=function(){e.prototype._aG.call(this),this._a7(),this._q.style.display="",this._q.classList.remove("paused")},t.prototype._am=function(){var t=this,r=this.clock.currentTime;this._P.forEach(function(e,n){(n.start>r||n.end<r)&&(t._P.delete(n),t._bb(e))}),e.prototype._am.call(this)},t.prototype._aI=function(){e.prototype._aI.call(this),this._q.classList.add("paused")},t.prototype._aJ=function(){e.prototype._aJ.call(this),this._q.style.display="none"},t.prototype._aN=function(){if(e.prototype._aN.call(this),this._Q.clear(),null!==this._j)for(;null!==this._j.firstChild;)this._j.removeChild(this._j.firstChild);for(;null!==this._v.firstChild;)this._v.removeChild(this._v.firstChild)},t.prototype._az=function(){this._y("ready",[])},t.prototype._bb=function(e){e.parentNode.removeChild(e)},t.prototype._a7=function(){var e=this;this._P.forEach(function(t){return e._bb(t)}),this._P.clear()},t._bz=[null,[0,100],[50,100],[100,100],[0,50],[50,50],[100,50],[0,0],[50,0],[100,0]],t}(s.NullRenderer);e.WebRenderer=g,h.mixin(g,[l.EventSource])},function(e,t){var r=t(17),n=t(29),i=function(){function e(e,t,r,n,i,o,a){this._i=r,this._h=n,this.__=i,this._F=o,this._v=a,this._by=0,this._z=e.id+"-"+t.id,this._f=t.style,this.reset(null)}return e.prototype.reset=function(e){(void 0===e||null===e)&&(e=this._f),this.italic=e.italic,this.bold=e.bold,this.underline=e.underline,this.strikeThrough=e.strikeThrough,this.outlineWidth=e.outlineThickness,this.outlineHeight=e.outlineThickness,this.shadowDepthX=e.shadowDepth,this.shadowDepthY=e.shadowDepth,this.fontName=e.fontName,this.fontSize=e.fontSize,this.fontScaleX=e.fontScaleX,this.fontScaleY=e.fontScaleY,this.letterSpacing=e.letterSpacing,this._aj=null,this._ak=null,this._1=e.rotationZ,this._aK=null,this._aL=null,this.primaryColor=e.primaryColor,this.secondaryColor=e.secondaryColor,this.outlineColor=e.outlineColor,this.shadowColor=e.shadowColor,this.primaryAlpha=null,this.secondaryAlpha=null,this.outlineAlpha=null,this.shadowAlpha=null,this.blur=null,this.gaussianBlur=null},e.prototype.setStylesOnSpan=function(t,n,i){var o=this,a=t.childNodes[0]instanceof Text,l="";this._aM&&(l+="italic "),this._0===!0?l+="bold ":this._0!==!1&&(l+=this._0+" ");var s;s=a?(this._h*e._a3(this._$,this._L*this._A,this._F)).toFixed(3):(this._h*e._a3(this._$,this._L,this._F)).toFixed(3);var u=(this._h*this._L).toFixed(3);t.style.font=""+l+s+"px/"+u+'px "'+this._$+'"';var p="";this._aR&&(p="underline"),this._aS&&(p+=" line-through"),t.style.textDecoration=p.trim();var c="";if(a?this._A!==this._C&&(c+="scaleY("+(this._A/this._C).toFixed(3)+") "):(1!==this._C&&(c+="scaleX("+this._C+") "),1!==this._A&&(c+="scaleY("+this._A+") ")),null!==this._ak&&(c+="rotateY("+this._ak+"deg) "),null!==this._aj&&(c+="rotateX("+this._aj+"deg) "),0!==this._1&&(c+="rotateZ("+-1*this._1+"deg) "),null!==this._aK||null!==this._aL){var h=e._e(this._aK,0),f=e._e(this._aL,0);c+="matrix(1, "+f+", "+h+", 1, 0, 0) "}""!==c&&(t.style.webkitTransform=c,t.style.webkitTransformOrigin="50% 50%",t.style.transform=c,t.style.transformOrigin="50% 50%",t.style.display="inline-block"),t.style.letterSpacing=(this._i*this._aV).toFixed(3)+"px";var d=this._as.withAlpha(this._bd);t.style.color=d.toString();var _=this._aX.withAlpha(this._bv),g=this._i*this._bu,y=this._h*this._bt,v="",m="";if(this.__.enableSvg){var b="svg-filter-"+this._z+"-"+this._by++;if(g>0||y>0){var w="",S=0,P=!this.__.preciseOutlines&&this._ag>0?this._ag:1;!function(e){if(y>=g)if(g>0){for(var t=0;g>=t;t+=P)e(t,y/g*Math.sqrt(g*g-t*t));t!==g+P&&e(g,0)}else e(0,y);else if(y>0){for(var r=0;y>=r;r+=P)e(g/y*Math.sqrt(y*y-r*r),r);r!==y+P&&e(0,y)}else e(g,0)}(function(e,t){v+='	<feMorphology in="SourceAlpha" operator="dilate" radius="'+e.toFixed(3)+" "+t.toFixed(3)+'" result="outline'+S+'" />\n',w+='		<feMergeNode in="outline'+S+'" />\n',S++}),v+='	<feMerge result="outline">\n'+w+'\n	</feMerge>\n	<feFlood flood-color="'+_.toString()+'" />\n	<feComposite operator="in" in2="outline" />\n'}this._ag>0&&(m+='	<feGaussianBlur stdDeviation="'+this._ag+'" />\n');for(var k=0;k<this._br;k++)m+='	<feConvolveMatrix kernelMatrix="1 2 1 2 4 2 1 2 1" edgeMode="none" />\n'}else if(g>0||y>0){var O="";!function(e){for(var t=0;g>=t;t++)for(var r=0===g?y:y*Math.sqrt(1-t*t/(g*g)),n=0;r>=n;n++)e(t,n),0!==t&&e(-t,n),0!==n&&e(t,-n),0!==t&&0!==n&&e(-t,-n)}(function(e,t){O+=", "+_.toString()+" "+e+"px "+t+"px "+o._ag.toFixed(3)+"px"}),t.style.textShadow=O.substr(", ".length)}var x=document.createElement("span");if(x.appendChild(t),""!==v||""!==m){var C='<filter xmlns="http://www.w3.org/2000/svg" id="'+b+'" x="-50%" width="200%" y="-50%" height="200%">\n'+v+"\n"+m+'\n	<feMerge>\n		<feMergeNode />\n		<feMergeNode in="SourceGraphic" />\n	</feMerge>\n</filter>\n',j=r.domParser.parseFromString(C,"image/svg+xml").childNodes[0];this._v.appendChild(j),x.style.webkitFilter='url("#'+b+'")',x.style.filter='url("#'+b+'")'}if(0!==this._bk||0!==this._bl){var E=this._a0.withAlpha(this._bN),D=E.toString()+" "+(this._bk*this._i/this._C).toFixed(3)+"px "+(this._bl*this._h/this._A).toFixed(3)+"px 0px";""===t.style.textShadow?t.style.textShadow=D:t.style.textShadow+=", "+D}return(0!==this._aj||0!==this._ak)&&(x.style.display="inline-block"),i.appendChild(document.createTextNode(n.cssText)),t.style.webkitAnimation=n.animationStyle,t.style.animation=n.animationStyle,x},e.prototype.makeNewLine=function(){var e=document.createElement("br");return e.style.lineHeight=(this._h*this._L).toFixed(3)+"px",e},Object.defineProperty(e.prototype,"italic",{set:function(t){this._aM=e._e(t,this._f.italic)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{set:function(t){this._0=e._e(t,this._f.bold)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{set:function(t){this._aR=e._e(t,this._f.underline)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikeThrough",{set:function(t){this._aS=e._e(t,this._f.strikeThrough)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineWidth",{set:function(t){this._bu=e._e(t,this._f.outlineThickness)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineHeight",{set:function(t){this._bt=e._e(t,this._f.outlineThickness)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowDepthX",{set:function(t){this._bk=e._e(t,this._f.shadowDepth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowDepthY",{set:function(t){this._bl=e._e(t,this._f.shadowDepth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blur",{set:function(t){this._br=e._e(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gaussianBlur",{set:function(t){this._ag=e._e(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{set:function(t){this._$=e._e(t,this._f.fontName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{set:function(t){this._L=e._e(t,this._f.fontSize)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleX",{set:function(t){this._C=e._e(t,this._f.fontScaleX)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleY",{set:function(t){this._A=e._e(t,this._f.fontScaleY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{set:function(t){this._aV=e._e(t,this._f.letterSpacing)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationX",{set:function(e){this._aj=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationY",{set:function(e){this._ak=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{set:function(t){this._1=e._e(t,this._f.rotationZ)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skewX",{set:function(e){this._aK=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skewY",{set:function(e){this._aL=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryColor",{get:function(){return this._as},set:function(t){this._as=e._e(t,this._f.primaryColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryColor",{get:function(){return this._a1},set:function(t){this._a1=e._e(t,this._f.secondaryColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineColor",{set:function(t){this._aX=e._e(t,this._f.outlineColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{set:function(t){this._a0=e._e(t,this._f.shadowColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryAlpha",{get:function(){return this._bd},set:function(e){this._bd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryAlpha",{get:function(){return this._bq},set:function(e){this._bq=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineAlpha",{set:function(e){this._bv=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowAlpha",{set:function(e){this._bN=e},enumerable:!0,configurable:!0}),e._a3=function(t,r,i){var o=e._bn.get(t);void 0===o&&e._bn.set(t,o=new n.Map);var a=o.get(r);return void 0===a&&(i.style.fontFamily=t,i.style.fontSize=r+"px",o.set(r,a=r*r/i.offsetHeight)),a},e._bn=new n.Map,e._e=function(e,t){return null!==e?e:t},e}();e.SpanStyles=i},function(e){function t(t){e.debugMode=t}function r(t){e.verboseMode=t}e.debugMode=!1,e.verboseMode=!1,e.setDebugMode=t,e.setVerboseMode=r},function(t,r){var n=r(24),i=r(27),o=r(26),a=r(25),l=r(22),s=r(1),u=r(2),p=r(29),c=function(){function t(){if(this._aY=new o.ScriptProperties,this._bj=new p.Map,this._bs=[],this._a$=null,this._aZ=null,1===arguments.length)throw new Error("Constructor `new ASS(rawASS)` has been deprecated. Use `ASS.fromString(rawASS)` instead.")}return Object.defineProperty(t.prototype,"properties",{get:function(){return this._aY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return this._bj},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogues",{get:function(){return this._bs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stylesFormatSpecifier",{get:function(){return this._a$},set:function(e){this._a$=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialoguesFormatSpecifier",{get:function(){return this._aZ},set:function(e){this._aZ=e},enumerable:!0,configurable:!0}),t.prototype.addStyle=function(e){var t=u.parseLineIntoTypedTemplate(e,this._a$);if(null!==t&&"Style"===t.type){var r=t.template;if(l.verboseMode){var n="";r.forEach(function(e,t){return n+=t+" = "+e+", "}),console.log("Read style: "+n)}var o=new i.Style(r);this._bj.set(o.name,o)}},t.prototype.addEvent=function(e){var t=u.parseLineIntoTypedTemplate(e,this._aZ);if(null!==t&&"Dialogue"===t.type){var r=t.template;if(l.verboseMode){var i="";r.forEach(function(e,t){return i+=t+" = "+e+", "}),console.log("Read dialogue: "+i)}this.dialogues.push(new n.Dialogue(r,this))}},t.fromString=function(e,r){return void 0===r&&(r=a.Format.ASS),t.fromStream(new s.StringStream(e),r)},t.fromStream=function(e,t){switch(void 0===t&&(t=a.Format.ASS),t){case a.Format.ASS:return new s.StreamParser(e).ass;case a.Format.SRT:return new s.SrtStreamParser(e).ass;default:throw new Error("Illegal value of type: "+t)}},t.fromUrl=function(r,n){if(void 0===n&&(n=a.Format.ASS),"function"==typeof e.fetch&&"function"==typeof e.ReadableStream&&"function"==typeof e.ReadableStream.prototype.getReader&&"function"==typeof e.TextDecoder)return e.fetch(r).then(function(e){return t.fromReadableStream(e.body,"utf-8",n)});var i=new XMLHttpRequest,o=t.fromStream(new s.XhrStream(i),n);return i.open("GET",r,!0),i.send(),o},t.fromReadableStream=function(e,r,n){return void 0===r&&(r="utf-8"),void 0===n&&(n=a.Format.ASS),t.fromStream(new s.BrowserReadableStream(e,r),n)},t}();t.ASS=c},function(e,t){var r=t(25),n=t(3),i=t(7),o=t(22),a=function(){function e(t,n){this._u=null,this._b9=null,this._z=++e._bx;var i=t.get("Style");if(this._aF=n.styles.get(i),void 0===this._aF)throw new Error("Unrecognized style "+i);if(this._n=e._ba(t.get("Start")),this._l=e._ba(t.get("End")),this._bA=Math.max(r.valueOrDefault(t,"Layer",parseInt,function(e){return!isNaN(e)},"0"),0),this._M=t.get("Text"),void 0===this._M||null===this._M||this._M.constructor!==String)throw new Error("Dialogue doesn't have any text.")}return Object.defineProperty(e.prototype,"id",{get:function(){return this._z},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this._n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._l},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._aF},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignment",{get:function(){return null===this._u&&this._a8(),this._an},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layer",{get:function(){return this._bA},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parts",{get:function(){return null===this._u&&this._a8(),this._u},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return"#"+this._z+" ["+this._n.toFixed(3)+"-"+this._l.toFixed(3)+"] "+(null!==this._u?this._u.join(", "):this._M)},e.prototype._a8=function(){var e=this;if(this._u=n.parse(this._M,"dialogueParts"),this._an=this._aF.alignment,this._u.forEach(function(t,r){t instanceof i.Alignment?e._an=t.value:t instanceof i.Move?(null===t.t1||null===t.t2)&&(e._u[r]=new i.Move(t.x1,t.y1,t.x2,t.y2,0,e._l-e._n)):t instanceof i.Transform&&(null===t.start||null===t.end||null===t.accel)&&(e._u[r]=new i.Transform(null===t.start?0:t.start,null===t.end?e._l-e._n:t.end,null===t.accel?1:t.accel,t.tags))}),o.debugMode){var t=this._u.filter(function(e){return e instanceof i.Comment&&-1!==e.value.indexOf("\\")});t.length>0&&console.warn("Possible incorrect parse:\n"+this._M+"\nwas parsed as\n"+this.toString()+"\nThe possibly incorrect parses are:\n"+t.join("\n"))}},e._ba=function(e){return e.split(":").reduce(function(e,t){return 60*e+parseFloat(t)},0)},e._bx=-1,e}();e.Dialogue=a},function(e){function t(e,t,r,n,i){var o=e.get(t);if(void 0===o)return r(i);try{var a=r(o);if(null!==n&&!n(a))throw new Error("Validation failed.");return a}catch(e){throw new Error("Property "+t+" has invalid value "+o+" - "+e.stack)}}!function(e){e[e.ASS=0]="ASS",e[e.SRT=1]="SRT"}(e.Format||(e.Format={})),function(e){e[e.SmartWrappingWithWiderTopLine=0]="SmartWrappingWithWiderTopLine",e[e.SmartWrappingWithWiderBottomLine=3]="SmartWrappingWithWiderBottomLine",e[e.EndOfLineWrapping=1]="EndOfLineWrapping",e[e.NoLineWrapping=2]="NoLineWrapping"}(e.WrappingStyle||(e.WrappingStyle={})),function(e){e[e.Outline=1]="Outline",e[e.OpaqueBox=3]="OpaqueBox"}(e.BorderStyle||(e.BorderStyle={})),e.valueOrDefault=t},function(e){var t=function(){function e(){}return Object.defineProperty(e.prototype,"resolutionX",{get:function(){return this._bE},set:function(e){this._bE=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resolutionY",{get:function(){return this._bF},set:function(e){this._bF=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrappingStyle",{get:function(){return this._bG},set:function(e){this._bG=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleBorderAndShadow",{get:function(){return this._bH},set:function(e){this._bH=e},enumerable:!0,configurable:!0}),e}();e.ScriptProperties=t},function(e,t){var r=t(25),n=t(3),i=function(){function e(e){if(this._ai=e.get("Name"),void 0===this._ai||null===this._ai||this._ai.constructor!==String)throw new Error("Style doesn't have a name.");this._aM="-1"===e.get("Italic"),this._0="-1"===e.get("Bold"),this._aR="-1"===e.get("Underline"),this._aS="-1"===e.get("StrikeOut"),this._$=e.get("Fontname"),this._L=r.valueOrDefault(e,"Fontsize",parseFloat,function(e){return!isNaN(e)},"50"),this._C=r.valueOrDefault(e,"ScaleX",parseFloat,function(e){return!isNaN(e)},"100")/100,this._A=r.valueOrDefault(e,"ScaleY",parseFloat,function(e){return!isNaN(e)},"100")/100,this._aV=r.valueOrDefault(e,"Spacing",parseFloat,function(e){return!isNaN(e)},"0"),this._1=r.valueOrDefault(e,"Angle",parseFloat,function(e){return!isNaN(e)},"0"),this._as=r.valueOrDefault(e,"PrimaryColour",function(e){return n.parse(e,"colorWithAlpha")},null,"&H0000FFFF"),this._a1=r.valueOrDefault(e,"SecondaryColour",function(e){return n.parse(e,"colorWithAlpha")},null,"&H00000000"),this._aX=r.valueOrDefault(e,"OutlineColour",function(e){return n.parse(e,"colorWithAlpha")},null,"&H00000000"),this._a0=r.valueOrDefault(e,"BackColour",function(e){return n.parse(e,"colorWithAlpha")},null,"&H00000000"),this._bJ=r.valueOrDefault(e,"Outline",parseFloat,function(e){return!isNaN(e)},"1"),this._bK=r.valueOrDefault(e,"BorderStyle",parseInt,function(e){return!isNaN(e)},"1"),this._bL=r.valueOrDefault(e,"Shadow",parseFloat,function(e){return!isNaN(e)},"1"),this._an=r.valueOrDefault(e,"Alignment",parseInt,function(e){return!isNaN(e)},"2"),this._bM=r.valueOrDefault(e,"MarginL",parseFloat,function(e){return!isNaN(e)},"80"),this._bp=r.valueOrDefault(e,"MarginR",parseFloat,function(e){return!isNaN(e)},"80"),this._bO=r.valueOrDefault(e,"MarginV",parseFloat,function(e){return!isNaN(e)},"35")}return Object.defineProperty(e.prototype,"name",{get:function(){return this._ai},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this._aM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this._0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this._aR},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikeThrough",{get:function(){return this._aS},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._$},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._L},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleX",{get:function(){return this._C},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleY",{get:function(){return this._A},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._aV},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this._1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryColor",{get:function(){return this._as},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"secondaryColor",{get:function(){return this._a1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineColor",{get:function(){return this._aX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowColor",{get:function(){return this._a0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineThickness",{get:function(){return this._bJ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderStyle",{get:function(){return this._bK},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowDepth",{get:function(){return this._bL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignment",{get:function(){return this._an},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marginLeft",{get:function(){return this._bM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marginRight",{get:function(){return this._bp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marginVertical",{get:function(){return this._bO},enumerable:!0,configurable:!0}),e}();e.Style=i},function(e){function t(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r}e.__extends=t},function(t){function r(e){null!==e?t.Map=e:t.Map=n}var n=function(){function e(e){if(this.clear(),void 0!==e){if(!Array.isArray(e))throw new Error("Non-array iterables are not supported by the SimpleMap constructor.");for(var t=0;t<e.length;t++){var r=e[t];this.set(r[0],r[1])}}}return e.prototype.get=function(e){var t=this._au(e);return null===t?void 0:this._aq[t]},e.prototype.has=function(e){var t=this._au(e);return null===t?!1:t in this._E},e.prototype.set=function(e,t){var r=this._au(e);if(null===r)throw new Error("This Map implementation only supports Number and String keys, or keys with an id property.");return r in this._E||this._R++,this._E[r]=e,this._aq[r]=t,this},e.prototype.delete=function(e){var t=this._au(e);if(null===t)return!1;var r=t in this._E;return r&&(delete this._E[t],delete this._aq[t],this._R--),r},e.prototype.clear=function(){this._E=Object.create(null),this._aq=Object.create(null),this._R=0},e.prototype.forEach=function(e,t){for(var r=0,n=Object.keys(this._E);r<n.length;r++){var i=n[r];e.call(t,this._aq[i],this._E[i],this)}},Object.defineProperty(e.prototype,"size",{get:function(){return this._R},enumerable:!0,configurable:!0}),e.prototype._au=function(e){return"number"==typeof e?"#"+e:"string"==typeof e?"'"+e:void 0!==e.id?"!"+e.id:null},e}();t.Map=e.Map,(void 0===t.Map||"function"!=typeof t.Map.prototype.forEach||function(){try{return 2!==new t.Map([[1,"foo"],[2,"bar"]]).size}catch(e){return!0}}())&&(t.Map=n),t.setImplementation=r},function(e){function t(e,t){for(var r=0;r<t.length;r++)for(var n=t[r],i=0,o=Object.getOwnPropertyNames(n.prototype);i<o.length;i++){var a=o[i];e.prototype[a]=n.prototype[a]}}e.mixin=t},function(t){function r(e){null!==e?t.Promise=e:t.Promise=i}var n,i=function(){function r(e){var t=this;this._o=n.PENDING,this._W=[],this._aW=!1,this._aU=null,this._aT=null;try{e(function(e){return t._ar(e)},function(e){return t._O(e)})}catch(e){this._O(e)}}return r.prototype.then=function(e,r){var n=this;if(e="function"==typeof e?e:null,r="function"==typeof r?r:null,null===e&&null===r)return this;null===e&&(e=function(e){return e}),null===r&&(r=function(e){throw e});var i=new t.Promise(function(t,i){n._W.push({propagateFulfilling:function(r){try{t(e(r))}catch(e){i(e)}},propagateRejection:function(e){try{t(r(e))}catch(e){i(e)}}})});return this._aw(),i},r.prototype.catch=function(e){return this.then(null,e)},r.prototype.isFulfilled=function(){return this._o===n.FULFILLED},r.prototype.isRejected=function(){return this._o===n.REJECTED},r.prototype.isPending=function(){return this._o===n.PENDING},r.prototype.value=function(){if(this._o!==n.FULFILLED)throw new Error("This promise is not in FULFILLED state.");return this._aU},r.prototype.reason=function(){if(this._o!==n.REJECTED)throw new Error("This promise is not in FULFILLED state.");return this._aT},r.resolve=function(e){return e instanceof r?e:new t.Promise(function(t){return t(e)})},r.all=function(e){return new t.Promise(function(r,n){var i=[],o=e.length;return 0===o?void r(i):void e.forEach(function(e,n){return t.Promise.resolve(e).then(function(e){i[n]=e,o--,0===o&&r(i)})},n)})},r.prototype._ar=function(e){var t=this,n=!1;try{if(e===this)throw new TypeError("2.3.1");var i=r._b_(e);if(null===i)return void this._b0(e);i.call(e,function(e){n||(n=!0,t._ar(e))},function(e){n||(n=!0,t._O(e))})}catch(e){if(n)return;this._O(e)}},r.prototype._b0=function(e){this._o===n.PENDING&&(this._o=n.FULFILLED,this._aU=e,this._aw())},r.prototype._O=function(e){this._o===n.PENDING&&(this._o=n.REJECTED,this._aT=e,this._aw())},r._b_=function(e){if("object"!=typeof e&&"function"!=typeof e)return null;if(null===e||void 0===e)return null;var t=e.then;return"function"!=typeof t?null:t},r.prototype._aw=function(){var e=this;this._o!==n.PENDING&&(this._aW||(this._aW=!0,r._b1(function(){if(e._aW=!1,e._o===n.FULFILLED)for(;e._W.length>0;){var t=e._W.shift();t.propagateFulfilling(e._aU)}else if(e._o===n.REJECTED)for(;e._W.length>0;){var t=e._W.shift();t.propagateRejection(e._aT)}})))},r._b1=function(){var t=e.MutationObserver||e.WebkitMutationObserver;if(void 0!==e.process&&"function"==typeof e.process.nextTick)return function(t){e.process.nextTick(t)};if(void 0!==t){var r=[],n=!1,i=document.createElement("div"),o=new t(function(){var e=r;r=[];for(var t=0;t<e.length;t++){var o=e[t];o()}n=!1,r.length>0&&(i.classList.toggle("foo"),n=!0)});return o.observe(i,{attributes:!0}),function(e){r.push(e),n||(i.classList.toggle("foo"),n=!0)}}return function(e){return setTimeout(e,0)}}(),r}();!function(e){e[e.PENDING=0]="PENDING",e[e.FULFILLED=1]="FULFILLED",e[e.REJECTED=2]="REJECTED"}(n||(n={})),t.Promise=e.Promise,void 0===t.Promise&&(t.Promise=i),t.setImplementation=r;var o=function(){function e(){var e=this;this._b2=new t.Promise(function(t,r){e._ar=t,e._O=r})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._b2},enumerable:!0,configurable:!0}),e.prototype.resolve=function(e){this._ar(e)},e.prototype.reject=function(e){this._O(e)},e}();t.DeferredPromise=o},function(t){function r(e){null!==e?t.Set=e:t.Set=n}var n=function(){function e(e){if(this.clear(),void 0!==e){if(!Array.isArray(e))throw new Error("Non-array iterables are not supported by the SimpleSet constructor.");for(var t=0;t<e.length;t++){var r=e[t];this.add(r)}}}return e.prototype.add=function(e){var t=this._a9(e);if(null===t)throw new Error("This Set implementation only supports Number and String values.");return t in this._Y||this._R++,this._Y[t]=e,this},e.prototype.clear=function(){this._Y=Object.create(null),this._R=0},e.prototype.has=function(e){var t=this._a9(e);return null===t?!1:t in this._Y},e.prototype.forEach=function(e,t){for(var r=0,n=Object.keys(this._Y);r<n.length;r++){var i=n[r],o=this._Y[i];e.call(t,o,o,this)}},Object.defineProperty(e.prototype,"size",{get:function(){return this._R},enumerable:!0,configurable:!0}),e.prototype._a9=function(e){return"number"==typeof e?"#"+e:"string"==typeof e?"'"+e:null},e}();t.Set=e.Set,(void 0===t.Set||"function"!=typeof t.Set.prototype.forEach||function(){try{return 2!==new t.Set([1,2]).size}catch(e){return!0}}())&&(t.Set=n),t.setImplementation=r},function(e,t){var r=t(29),n=t(31),i=t(34),o=t(36),a=function(){function e(e){var t=this;this._aB=e,this._ad=new r.Map,this._aB.addEventListener("message",function(e){return t._b7(e.data)},!1)}return e.prototype.request=function(t,r){var i=new n.DeferredPromise,a=++e._bw;this._ad.set(a,i);var l={requestId:a,command:t,parameters:r};return this._aB.postMessage(o.serialize(l)),i.promise},e.prototype.cancelRequest=function(e){var t=this._ad.get(e);void 0!==t&&(this._ad.delete(e),t.reject(new Error("Cancelled.")))},e.prototype._bc=function(e){var t=e.requestId,r=e.error,n=e.result;r instanceof Error&&(r={message:r.message,stack:r.stack}),this._aB.postMessage(o.serialize({command:i.WorkerCommands.Response,requestId:t,error:r,result:n}))},e.prototype._b7=function(e){var t=this,r=o.deserialize(e);if(r.command===i.WorkerCommands.Response){var n=r,a=this._ad.get(n.requestId);void 0!==a&&(this._ad.delete(n.requestId),null===n.error?a.resolve(n.result):a.reject(n.error))}else{var l=r,s=l.requestId,u=o.getWorkerCommandHandler(l.command);if(void 0===u)return void this._bc({requestId:s,error:new Error("No handler registered for command "+l.command),result:null});u(l.parameters).then(function(e){return{requestId:s,error:null,result:e}},function(e){return{requestId:s,error:e,result:null}}).then(function(e){return t._bc(e)})}},e._bw=-1,e}();e.WorkerChannelImpl=a,o.registerWorkerCommand(i.WorkerCommands.Ping,function(){return new n.Promise(function(e){return e()})})},function(e){!function(e){e[e.Response=0]="Response",e[e.Parse=1]="Parse",e[e.Ping=2]="Ping"}(e.WorkerCommands||(e.WorkerCommands={}))},function(t,r){function n(e){return void 0===e&&(e=a.src),new i.WorkerChannelImpl(new Worker(e))}var i=r(33),o=r(34);t.WorkerCommands=o.WorkerCommands,t.supported="undefined"!=typeof Worker,t.createWorker=n;var a=null;"undefined"!=typeof document&&void 0!==document.currentScript&&(a=document.currentScript),"undefined"!=typeof WorkerGlobalScope&&e instanceof WorkerGlobalScope&&new i.WorkerChannelImpl(e)},function(e,t){function r(e,t){s.set(e,t)}function n(e){return s.get(e)}function i(e){e._classTag=u.size,u.set(e._classTag,e)}function o(e){return JSON.stringify(e,function(e,t){return t&&void 0!==t._classTag&&(t._classTag=t._classTag),t})}function a(e){return JSON.parse(e,function(e,t){if(t&&void 0!==t._classTag){for(var r=Object.create(u.get(t._classTag)),n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];"_classTag"!==o&&(r[o]=t[o])}t=r}return t})}var l=t(29),s=new l.Map,u=new l.Map;e.registerWorkerCommand=r,e.getWorkerCommandHandler=n,e.registerClassPrototype=i,e.serialize=o,e.deserialize=a}])});
//# sourceMappingURL=libjass.min.js.map